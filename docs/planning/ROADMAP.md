# 人生充実ゲーム 実装ロードマップ - 現実感強化版対応

> **最終更新**: 2025/1/27  
> **文書種別**: GAME_RULES_REALISTIC_FINAL対応実装計画  
> **更新頻度**: 実装進捗に応じて随時更新

## 🎯 プロジェクトゴール
GAME_RULES_REALISTIC_FINALで定義された現実感強化版ルールの完全実装  
生命保険教育効果と現実的な年齢変化を体験できるゲームの完成

## 📊 現在の実装状況（2025/1/27時点）

### ✅ 実装済み
- 基本的なカードシステム（Card, Deck エンティティ）
- 基本的なゲームフロー（ターン管理、フェーズ管理）
- Phaser.jsベースのUI（カード表示、ドラッグ&ドロップ）
- チャレンジシステム（基本的な挑戦メカニクス）
- カード選択システム（チャレンジ成功時の報酬）
- CI/CDパイプライン（テスト、デプロイ自動化）

### ❌ 未実装（現実感強化版で必要）
- 年齢別活力システム（青年期35→中年期30→充実期27）
- 終身・定期保険システム（期限管理、効果変化）
- 保険料負担システム（3枚ごとに-1パワー）
- 保険見直しシステム（ステージ移行時）
- 年齢別夢実現システム（体力系+3、知識系-2）
- 経験学習システム（同種失敗で効率化）
- 現実的UI（判断支援、ガイド表示）

---

## 🚀 実装フェーズ

### Phase 1: コア現実感システム（優先度：最高）
**期間**: 1-2週間  
**目標**: 年齢変化と保険システムの基盤実装

#### Week 1: 年齢別活力システム
- **Day 1-2: 活力システム拡張**
  - [ ] `GameStage`ごとの活力上限定義
  - [ ] ステージ進行時の活力上限変更実装
  - [ ] 現実的な活力変化ロジック（青年期35→中年期30→充実期27）
  - [ ] UI: 活力上限の段階的表示

- **Day 3-4: 年齢システム統合**
  - [ ] `Game.ts`に年齢効果計算メソッド追加
  - [ ] ステージ移行時の年齢効果適用
  - [ ] テスト: 年齢別活力変化の検証
  - [ ] UI: 年齢表示と変化アニメーション

#### Week 2: 保険システム基盤
- **Day 5-7: 保険カードタイプ拡張**
  - [ ] `InsuranceCard`クラス拡張（終身/定期区別）
  - [ ] 期限管理システム（定期保険10ターン）
  - [ ] 年齢効果システム（中年期+0.5、充実期+1）
  - [ ] カードファクトリーで保険種別生成

### Phase 2: 保険選択・管理システム（優先度：高）
**期間**: 2-3週間  
**目標**: 現実的な保険選択体験の実装

#### Week 3: 保険選択システム
- **Day 8-10: 終身・定期選択UI**
  - [ ] チャレンジ成功時の保険種別選択画面
  - [ ] 年齢・状況に応じた推奨表示
  - [ ] 保険選択ガイド（「20代推奨：定期」等）
  - [ ] 選択結果のデッキ統合

- **Day 11-14: 保険料負担システム**
  - [ ] 保険枚数カウント機能
  - [ ] 3枚ごとに-1パワー計算
  - [ ] 実質効果表示（「基本+8、保険+10、負担-2、実質+16」）
  - [ ] UI: 自動計算結果の明確表示

#### Week 4: 保険見直しシステム
- **Day 15-17: ステージ移行見直し**
  - [ ] 中年期移行時の保険見直し機会
  - [ ] 充実期移行時の総合見直し
  - [ ] 定期保険期限切れ通知システム
  - [ ] 更新判断支援（推奨表示）

- **Day 18-21: 見直しUI実装**
  - [ ] 保険一覧管理画面
  - [ ] 定期保険期限表示（「残りXターン」）
  - [ ] 更新・失効選択UI
  - [ ] コスト詳細表示

### Phase 3: 夢実現・学習システム（優先度：高）
**期間**: 1-2週間  
**目標**: 年齢に応じた現実的な目標設定体験

#### Week 5: 年齢別夢システム
- **Day 22-24: 夢カード年齢調整**
  - [ ] 体力系夢の年齢+3パワー実装
  - [ ] 知識系夢の年齢-2パワー実装
  - [ ] 複合系夢の変化なし設定
  - [ ] 夢カード分類システム

- **Day 25-28: 経験学習システム**
  - [ ] 同種チャレンジ失敗記録
  - [ ] 2回目以降失敗時の-1パワー効果
  - [ ] 学習済みチャレンジのマーク表示
  - [ ] 経験値システムの統合

### Phase 4: 現実的UI・教育効果（優先度：中）
**期間**: 1-2週間  
**目標**: 直感的で教育的なユーザー体験

#### Week 6: 判断支援システム
- **Day 29-31: ガイドシステム**
  - [ ] 年齢別保険推奨システム
  - [ ] 夢選択ガイド（年齢適性表示）
  - [ ] 「あなたの状況なら」判断支援
  - [ ] コンテキスト感知型ヒント

- **Day 32-35: 教育的フィードバック**
  - [ ] 保険料負担の説明システム
  - [ ] 年齢変化の実感促進UI
  - [ ] 現実的選択の解説システム
  - [ ] 保険リテラシー向上メッセージ

### Phase 5: ポリッシュ・最適化（優先度：中）
**期間**: 1週間  
**目標**: 完成度とパフォーマンスの向上

#### Week 7: 最終調整
- **Day 36-38: バランス調整**
  - [ ] 年齢効果の微調整
  - [ ] 保険料負担バランス
  - [ ] 夢実現難易度調整
  - [ ] テストプレイ反映

- **Day 39-42: 最終ポリッシュ**
  - [ ] アニメーション強化
  - [ ] エラーハンドリング
  - [ ] パフォーマンス最適化
  - [ ] 最終テスト・デバッグ

---

## 📋 技術的実装詳細

### 新規追加が必要なクラス・インターフェース

#### 1. 拡張型定義
```typescript
// 保険種別
export type InsuranceDurationType = 'term' | 'whole_life'

// 夢カテゴリー
export type DreamCategory = 'physical' | 'intellectual' | 'mixed'

// 学習記録
export interface LearningRecord {
  challengeType: string
  failureCount: number
  isLearned: boolean
}
```

#### 2. 拡張エンティティ
```typescript
// 保険カード拡張
export interface InsuranceCardData extends ICard {
  durationType: InsuranceDurationType
  remainingTurns?: number // 定期保険用
  ageMultiplier: number // 年齢効果倍率
}

// 夢カード
export interface DreamCard extends ICard {
  category: DreamCategory
  baseRequiredPower: number
  ageAdjustment: number // 年齢調整値
}
```

#### 3. 拡張ゲームシステム
```typescript
// ゲーム状態拡張
export interface IEnhancedGameState extends IGameState {
  insuranceCards: InsuranceCardData[]
  insuranceBurden: number // 保険料負担
  learningRecords: Map<string, LearningRecord>
  currentMaxVitality: number // 年齢別活力上限
}
```

### データ構造

#### 年齢別パラメータ
```typescript
export const AGE_PARAMETERS = {
  youth: { maxVitality: 35, ageMultiplier: 0 },
  middle: { maxVitality: 30, ageMultiplier: 0.5 },
  fulfillment: { maxVitality: 27, ageMultiplier: 1.0 }
}
```

#### 夢カード年齢調整
```typescript
export const DREAM_AGE_ADJUSTMENTS = {
  physical: 3,    // 体力系: +3
  intellectual: -2, // 知識系: -2
  mixed: 0        // 複合系: 変化なし
}
```

---

## 🎯 マイルストーン

### Milestone 1: 基本現実感システム（Week 2完了）
- ✅ 年齢別活力システム動作
- ✅ 基本的な保険種別区別
- ✅ ステージ移行時の変化確認

### Milestone 2: 保険選択体験（Week 4完了）
- ✅ 終身・定期選択UI完成
- ✅ 保険料負担計算正常動作
- ✅ 保険見直しシステム動作

### Milestone 3: 完全な現実感体験（Week 6完了）
- ✅ 年齢別夢システム完成
- ✅ 経験学習システム動作
- ✅ 教育的フィードバック実装

### Milestone 4: 商品レベル完成（Week 7完了）
- ✅ GAME_RULES_REALISTIC_FINAL完全実装
- ✅ バグ修正・パフォーマンス最適化
- ✅ 教育効果検証完了

---

## 🔧 開発プロセス

### 開発原則
1. **段階的実装**: 各機能を独立してテスト可能に
2. **テスト駆動**: 新機能には必ずテスト追加
3. **継続的デプロイ**: 実装完了次第即座にデプロイ
4. **ドキュメント更新**: コード変更と同時にドキュメント更新

### 品質保証
- 各Week完了時にプレイテスト実施
- 教育効果の検証（実際の保険知識習得確認）
- パフォーマンステスト（読み込み速度、操作性）
- アクセシビリティチェック

### リスク管理
- **技術的難易度**: 複雑な計算ロジックの段階的実装
- **UI複雑化**: 段階的なUI改善でユーザビリティ維持
- **スケジュール**: 週次レビューでスコープ調整

---

## 📈 成功指標

### 実装完成度指標
- **Week 2**: 基本現実感システム 100%
- **Week 4**: 保険選択システム 100%
- **Week 6**: 教育システム 100%
- **Week 7**: 最終ポリッシュ 100%

### 品質指標
- **バグ**: 週1件以下の新規バグ報告
- **パフォーマンス**: 3秒以内の初期読み込み
- **教育効果**: プレイ後の保険理解度向上確認

### プレイアビリティ指標
- **完走率**: 70%以上のプレイヤーが最終ステージ到達
- **理解度**: 80%以上のプレイヤーが保険選択判断可能
- **満足度**: 4.0/5.0以上のユーザー評価

---

## 🎮 展開計画

### 短期（実装完了後1ヶ月）
- 生命保険会社への教育ツールとしての提案
- 保険代理店での顧客説明ツール活用
- 金融リテラシー教育での活用

### 中期（3ヶ月後）
- 追加シナリオ実装（結婚、出産、転職等）
- より詳細な保険商品システム
- ユーザーデータ分析機能

### 長期（6ヶ月後）
- 実際の保険商品との連携
- パーソナライズド推奨システム
- 保険会社向けSaaS化

---

**Note**: このロードマップは現実的な保険教育効果を重視し、GAME_RULES_REALISTIC_FINALの完全実装を最優先としています。各フェーズの完了時には必ず動作確認とプレイテストを実施し、教育効果を検証します。