# パッケージマネージャー選択ガイド

> **最終更新**: 2025/07/30  
> **文書種別**: 正式仕様書  
> **更新頻度**: 完成後は変更なし

## なぜnpmを使用するのか

このプロジェクトでは、パッケージマネージャーとして **npm** を採用しています。

### 主な理由

#### 1. 🤝 ツール互換性の向上
- **Claude Codeとの完全な互換性**: Claude Codeは標準的なnpmコマンドと最も高い互換性を持ちます
- **PowerShellとの相性**: Windowsの標準シェルであるPowerShellで安定して動作します
- **クロスプラットフォーム対応**: Windows、macOS、Linuxすべてで同じコマンドが使用可能

#### 2. 🎯 開発者体験の向上
- **標準ツール**: Node.jsに同梱されているため、追加インストール不要
- **豊富なドキュメント**: 最も広く使われているため、トラブルシューティング情報が豊富
- **エラーメッセージの明確さ**: 多くの開発者が慣れ親しんだエラーメッセージ形式

#### 3. 🛡️ 安定性と信頼性
- **長い歴史**: Node.jsエコシステムで最も長く使われているパッケージマネージャー
- **成熟したエコシステム**: ほぼすべてのnpmパッケージがnpmでテストされている
- **企業での採用実績**: 多くの企業プロジェクトで標準として採用

### pnpmからの移行経緯

当初はpnpmを使用していましたが、以下の課題が発生しました：

1. **Claude CodeとPowerShellの組み合わせで動作不安定**
   - コマンド実行時のタイムアウト
   - パス解決の問題
   - 権限エラーの頻発

2. **開発フローの阻害**
   - 頻繁なエラーによる作業の中断
   - デバッグに時間がかかる
   - チーム開発時の環境差異問題

3. **CI/CD環境での複雑性**
   - GitHub Actionsでの追加設定が必要
   - キャッシュ管理の複雑化
   - ビルド時間の増加

### npmの使用方法

#### 基本コマンド
```bash
# 依存関係のインストール（初回）
npm install

# 依存関係のインストール（CI環境）
npm ci

# パッケージの追加
npm install <package-name>

# 開発依存関係の追加
npm install --save-dev <package-name>

# スクリプトの実行
npm run <script-name>
```

#### プロジェクト固有のコマンド
```bash
# 開発サーバーの起動
npm run dev

# プロダクションビルド
npm run build

# テストの実行
npm run test

# リントの実行
npm run lint
```

### 注意事項

1. **package-lock.jsonの重要性**
   - このファイルは必ずGitにコミットしてください
   - チーム全体で同じバージョンの依存関係を使用するために必要です

2. **npm ciの使用**
   - CI環境や本番環境では`npm install`ではなく`npm ci`を使用してください
   - より高速で、package-lock.jsonを厳密に参照します

3. **バージョン管理**
   - Node.js v20.xを推奨（package.jsonのenginesフィールドを参照）
   - npmは最新の安定版を使用してください

### 将来の検討事項

技術の進化に応じて、以下の条件が満たされた場合は他のパッケージマネージャーへの移行を検討します：

- Claude Codeとの完全な互換性が確保される
- PowerShellでの安定動作が保証される
- 移行コストを上回る明確なメリットがある

現時点では、プロジェクトの安定性と開発効率を最優先に、npmを継続使用します。

## 関連ドキュメント
- [開発環境セットアップガイド](./SETUP.md)
- [トラブルシューティング](./TROUBLESHOOTING.md)
- [CI/CD設定](./.github/workflows/README.md)