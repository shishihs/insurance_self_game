# ã‚³ãƒ³ãƒ—ãƒ©ã‚¤ã‚¢ãƒ³ã‚¹è¦ä»¶ã¸ã®å¯¾å¿œ

> **æœ€çµ‚æ›´æ–°**: 2025/08/01  
> **æ–‡æ›¸ç¨®åˆ¥**: æ­£å¼ä»•æ§˜æ›¸  
> **æ›´æ–°é »åº¦**: å››åŠæœŸæ›´æ–°

## æ¦‚è¦

insurance_gameãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«ãŠã‘ã‚‹æ³•çš„ãƒ»è¦åˆ¶è¦ä»¶ã¸ã®å¯¾å¿œçŠ¶æ³ã¨å®Ÿè£…æ–¹é‡ã‚’å®šç¾©ã—ã¾ã™ã€‚å›½éš›çš„ãªãƒ‡ãƒ¼ã‚¿ä¿è­·æ³•è¦åˆ¶ã¨ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£æ¨™æº–ã¸ã®æº–æ‹ ã‚’ç¢ºä¿ã—ã¾ã™ã€‚

## 1. é©ç”¨æ³•è¦åˆ¶

### 1.1 ãƒ‡ãƒ¼ã‚¿ä¿è­·æ³•è¦åˆ¶

#### EUä¸€èˆ¬ãƒ‡ãƒ¼ã‚¿ä¿è­·è¦å‰‡ï¼ˆGDPRï¼‰
**é©ç”¨ç¯„å›²**: EUåŸŸå†…ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‹ã‚‰ã®ã‚¢ã‚¯ã‚»ã‚¹

**ä¸»è¦è¦ä»¶**:
- ãƒ‡ãƒ¼ã‚¿å‡¦ç†ã®åˆæ³•çš„æ ¹æ‹ ã®ç¢ºç«‹
- ãƒ‡ãƒ¼ã‚¿ä¸»ä½“ã®æ¨©åˆ©ã¸ã®å¯¾å¿œ
- ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ãƒ»ãƒã‚¤ãƒ»ãƒ‡ã‚¶ã‚¤ãƒ³ã®å®Ÿè£…
- ãƒ‡ãƒ¼ã‚¿ä¾µå®³é€šçŸ¥ç¾©å‹™

**å¯¾å¿œçŠ¶æ³**:
- âœ… åˆæ³•çš„æ ¹æ‹ ã®æ–‡æ›¸åŒ–
- âœ… ãƒ‡ãƒ¼ã‚¿ä¸»ä½“æ¨©åˆ©ã®å®Ÿè£…
- âœ… ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ãƒãƒªã‚·ãƒ¼ã®æ•´å‚™
- âœ… ãƒ‡ãƒ¼ã‚¿æœ€å°åŒ–ã®å®Ÿè£…

#### æ—¥æœ¬å€‹äººæƒ…å ±ä¿è­·æ³•
**é©ç”¨ç¯„å›²**: æ—¥æœ¬å›½å†…ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼

**ä¸»è¦è¦ä»¶**:
- åˆ©ç”¨ç›®çš„ã®ç‰¹å®šãƒ»é€šçŸ¥
- é©æ­£å–å¾—ã®ç¢ºä¿
- å®‰å…¨ç®¡ç†æªç½®ã®å®Ÿæ–½
- ç¬¬ä¸‰è€…æä¾›ã®åˆ¶é™

**å¯¾å¿œçŠ¶æ³**:
- âœ… åˆ©ç”¨ç›®çš„ã®æ˜ç¤º
- âœ… é©æ­£å–å¾—ã®ç¢ºä¿
- âœ… æŠ€è¡“çš„å®‰å…¨ç®¡ç†æªç½®
- âœ… ç¬¬ä¸‰è€…æä¾›ã®åˆ¶é™

#### ã‚«ãƒªãƒ•ã‚©ãƒ«ãƒ‹ã‚¢å·æ¶ˆè²»è€…ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼æ³•ï¼ˆCCPAï¼‰
**é©ç”¨ç¯„å›²**: ã‚«ãƒªãƒ•ã‚©ãƒ«ãƒ‹ã‚¢å·ä½æ°‘

**ä¸»è¦è¦ä»¶**:
- å€‹äººæƒ…å ±ã®é–‹ç¤ºè«‹æ±‚æ¨©
- å‰Šé™¤è«‹æ±‚æ¨©
- è²©å£²æ‹’å¦æ¨©
- å·®åˆ¥ç¦æ­¢

**å¯¾å¿œçŠ¶æ³**:
- âœ… é–‹ç¤ºè«‹æ±‚ã¸ã®å¯¾å¿œ
- âœ… å‰Šé™¤æ©Ÿèƒ½ã®å®Ÿè£…
- âŒ è²©å£²æ‹’å¦æ¨©ï¼ˆéè©²å½“ï¼‰
- âœ… å·®åˆ¥ç¦æ­¢ã®éµå®ˆ

### 1.2 ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£æ¨™æº–

#### OWASP Application Security
**é©ç”¨ç¯„å›²**: Webã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£

**OWASP Top 10 å¯¾å¿œçŠ¶æ³**:
- âœ… A01:2021 â€“ Broken Access Control
- âœ… A02:2021 â€“ Cryptographic Failures
- âœ… A03:2021 â€“ Injection
- âœ… A04:2021 â€“ Insecure Design
- âœ… A05:2021 â€“ Security Misconfiguration
- âœ… A06:2021 â€“ Vulnerable Components
- âœ… A07:2021 â€“ Identification and Authentication
- âœ… A08:2021 â€“ Software and Data Integrity
- âœ… A09:2021 â€“ Security Logging and Monitoring
- âœ… A10:2021 â€“ Server-Side Request Forgery

#### NIST Cybersecurity Framework
**é©ç”¨ç¯„å›²**: ã‚µã‚¤ãƒãƒ¼ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç®¡ç†

**ã‚³ã‚¢æ©Ÿèƒ½ã®å®Ÿè£…**:
- âœ… è­˜åˆ¥ï¼ˆIdentifyï¼‰
- âœ… ä¿è­·ï¼ˆProtectï¼‰
- âœ… æ¤œçŸ¥ï¼ˆDetectï¼‰
- âš ï¸ å¯¾å¿œï¼ˆRespondï¼‰- éƒ¨åˆ†å®Ÿè£…
- âš ï¸ å¾©æ—§ï¼ˆRecoverï¼‰- éƒ¨åˆ†å®Ÿè£…

## 2. GDPRæº–æ‹ å®Ÿè£…

### 2.1 ãƒ‡ãƒ¼ã‚¿å‡¦ç†ã®åˆæ³•çš„æ ¹æ‹ 

#### å®Ÿè£…è©³ç´°
```typescript
// src/utils/gdpr-compliance.ts
export class GDPRCompliance {
  // å‡¦ç†ã®åˆæ³•çš„æ ¹æ‹ ã‚’è¨˜éŒ²
  private static readonly LEGAL_BASIS = {
    game_state: 'contract', // å¥‘ç´„å±¥è¡Œã®ãŸã‚
    user_preferences: 'contract', // å¥‘ç´„å±¥è¡Œã®ãŸã‚
    analytics: 'consent', // åŒæ„ã«åŸºã¥ã
    security_logs: 'legitimate_interest', // æ­£å½“åˆ©ç›Šã®ãŸã‚
    error_logs: 'legitimate_interest' // æ­£å½“åˆ©ç›Šã®ãŸã‚
  };
  
  // ãƒ‡ãƒ¼ã‚¿å‡¦ç†ã®åˆæ³•æ€§ç¢ºèª
  static isProcessingLegal(dataType: string, hasConsent: boolean = false): boolean {
    const basis = this.LEGAL_BASIS[dataType as keyof typeof this.LEGAL_BASIS];
    
    switch (basis) {
      case 'consent':
        return hasConsent;
      case 'contract':
      case 'legitimate_interest':
        return true;
      default:
        return false;
    }
  }
  
  // ãƒ‡ãƒ¼ã‚¿å‡¦ç†è¨˜éŒ²ã®ç¶­æŒ
  static logDataProcessing(activity: DataProcessingActivity) {
    const record: ProcessingRecord = {
      timestamp: Date.now(),
      activity: activity.name,
      purpose: activity.purpose,
      legalBasis: activity.legalBasis,
      dataCategories: activity.dataCategories,
      retention: activity.retention,
      recipients: activity.recipients || []
    };
    
    this.storeProcessingRecord(record);
  }
  
  private static storeProcessingRecord(record: ProcessingRecord) {
    const records = this.getProcessingRecords();
    records.push(record);
    
    // æœ€å¤§1000ä»¶ã¾ã§ä¿æŒ
    if (records.length > 1000) {
      records.splice(0, records.length - 1000);
    }
    
    localStorage.setItem('gdpr_processing_records', JSON.stringify(records));
  }
  
  private static getProcessingRecords(): ProcessingRecord[] {
    const stored = localStorage.getItem('gdpr_processing_records');
    return stored ? JSON.parse(stored) : [];
  }
}

interface DataProcessingActivity {
  name: string;
  purpose: string;
  legalBasis: 'consent' | 'contract' | 'legitimate_interest' | 'legal_obligation';
  dataCategories: string[];
  retention: string;
  recipients?: string[];
}

interface ProcessingRecord {
  timestamp: number;
  activity: string;
  purpose: string;
  legalBasis: string;
  dataCategories: string[];
  retention: string;
  recipients: string[];
}
```

### 2.2 ãƒ‡ãƒ¼ã‚¿ä¸»ä½“ã®æ¨©åˆ©

#### ã‚¢ã‚¯ã‚»ã‚¹æ¨©ã®å®Ÿè£…
```typescript
// src/utils/data-subject-rights.ts
export class DataSubjectRights {
  // ãƒ‡ãƒ¼ã‚¿ãƒãƒ¼ã‚¿ãƒ“ãƒªãƒ†ã‚£ï¼ˆãƒ‡ãƒ¼ã‚¿ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ï¼‰
  static exportUserData(): UserDataExport {
    const gameState = localStorage.getItem('game_state');
    const preferences = localStorage.getItem('user_preferences');
    const statistics = localStorage.getItem('game_statistics');
    
    const exportData: UserDataExport = {
      exportDate: new Date().toISOString(),
      dataController: 'Insurance Game Project',
      user: {
        gameState: gameState ? JSON.parse(gameState) : null,
        preferences: preferences ? JSON.parse(preferences) : null,
        statistics: statistics ? JSON.parse(statistics) : null
      },
      metadata: {
        dataCategories: ['game_progress', 'user_preferences', 'game_statistics'],
        retentionPeriod: 'Until user deletion',
        legalBasis: 'Contract performance'
      }
    };
    
    return exportData;
  }
  
  // å‰Šé™¤æ¨©ï¼ˆå¿˜ã‚Œã‚‰ã‚Œã‚‹æ¨©åˆ©ï¼‰
  static deleteUserData(confirmDeletion: boolean = false): boolean {
    if (!confirmDeletion) {
      return false;
    }
    
    try {
      // ã‚²ãƒ¼ãƒ é–¢é€£ãƒ‡ãƒ¼ã‚¿ã®å‰Šé™¤
      localStorage.removeItem('game_state');
      localStorage.removeItem('user_preferences');
      localStorage.removeItem('game_statistics');
      localStorage.removeItem('player_achievements');
      
      // GDPRé–¢é€£ãƒ‡ãƒ¼ã‚¿ã®å‰Šé™¤
      localStorage.removeItem('gdpr_processing_records');
      localStorage.removeItem('cookie_consent');
      
      // ã‚»ãƒƒã‚·ãƒ§ãƒ³ãƒ‡ãƒ¼ã‚¿ã®å‰Šé™¤
      sessionStorage.clear();
      
      // Cookieã®å‰Šé™¤
      this.deleteCookies();
      
      return true;
    } catch (error) {
      console.error('Data deletion failed:', error);
      return false;
    }
  }
  
  // è¨‚æ­£æ¨©
  static correctUserData(corrections: UserDataCorrections): boolean {
    try {
      Object.entries(corrections).forEach(([key, value]) => {
        if (value !== undefined && value !== null) {
          localStorage.setItem(key, JSON.stringify(value));
        }
      });
      
      return true;
    } catch (error) {
      console.error('Data correction failed:', error);
      return false;
    }
  }
  
  // å‡¦ç†åˆ¶é™æ¨©
  static restrictProcessing(restrictions: ProcessingRestrictions): boolean {
    const restrictionSettings = {
      ...this.getRestrictionSettings(),
      ...restrictions,
      timestamp: Date.now()
    };
    
    localStorage.setItem('processing_restrictions', JSON.stringify(restrictionSettings));
    return true;
  }
  
  private static deleteCookies() {
    // ã™ã¹ã¦ã®Cookieã‚’å‰Šé™¤
    document.cookie.split(";").forEach(cookie => {
      const eqPos = cookie.indexOf("=");
      const name = eqPos > -1 ? cookie.substr(0, eqPos) : cookie;
      document.cookie = name + "=;expires=Thu, 01 Jan 1970 00:00:00 GMT;path=/";
    });
  }
  
  private static getRestrictionSettings(): ProcessingRestrictions {
    const stored = localStorage.getItem('processing_restrictions');
    return stored ? JSON.parse(stored) : {};
  }
}

interface UserDataExport {
  exportDate: string;
  dataController: string;
  user: {
    gameState: any;
    preferences: any;
    statistics: any;
  };
  metadata: {
    dataCategories: string[];
    retentionPeriod: string;
    legalBasis: string;
  };
}

interface UserDataCorrections {
  game_state?: any;
  user_preferences?: any;
  game_statistics?: any;
}

interface ProcessingRestrictions {
  analytics?: boolean;
  marketing?: boolean;
  profiling?: boolean;
  timestamp?: number;
}
```

### 2.3 ãƒ‡ãƒ¼ã‚¿ä¾µå®³é€šçŸ¥

#### ä¾µå®³æ¤œçŸ¥ã‚·ã‚¹ãƒ†ãƒ 
```typescript
// src/utils/breach-detection.ts
export class BreachDetection {
  private static readonly BREACH_INDICATORS = [
    'unauthorized_access',
    'data_modification',
    'data_destruction',
    'data_loss',
    'system_intrusion'
  ];
  
  // ãƒ‡ãƒ¼ã‚¿ä¾µå®³ã®æ¤œçŸ¥
  static detectBreach(indicator: string, details: any): void {
    if (this.BREACH_INDICATORS.includes(indicator)) {
      const breach: DataBreach = {
        id: this.generateBreachId(),
        timestamp: Date.now(),
        indicator,
        details,
        severity: this.assessSeverity(indicator, details),
        status: 'detected',
        affectedData: this.identifyAffectedData(details),
        notificationRequired: this.requiresNotification(indicator, details)
      };
      
      this.logBreach(breach);
      
      if (breach.notificationRequired) {
        this.initiateNotificationProcess(breach);
      }
    }
  }
  
  private static assessSeverity(indicator: string, details: any): 'low' | 'medium' | 'high' | 'critical' {
    // é‡è¦åº¦è©•ä¾¡ãƒ­ã‚¸ãƒƒã‚¯
    if (indicator === 'system_intrusion' || details.personalDataInvolved) {
      return 'critical';
    }
    if (indicator === 'unauthorized_access') {
      return 'high';
    }
    if (indicator === 'data_modification') {
      return 'medium';
    }
    return 'low';
  }
  
  private static requiresNotification(indicator: string, details: any): boolean {
    // GDPR Article 33/34ã«åŸºã¥ãé€šçŸ¥è¦ä»¶åˆ¤å®š
    return details.personalDataInvolved && 
           (indicator === 'system_intrusion' || 
            indicator === 'unauthorized_access' ||
            details.riskToIndividuals === 'high');
  }
  
  private static initiateNotificationProcess(breach: DataBreach): void {
    // 72æ™‚é–“ä»¥å†…ã®ç›£ç£å½“å±€ã¸ã®é€šçŸ¥æº–å‚™
    if (breach.severity === 'critical' || breach.severity === 'high') {
      this.scheduleAuthorityNotification(breach);
    }
    
    // ãƒ‡ãƒ¼ã‚¿ä¸»ä½“ã¸ã®é€šçŸ¥åˆ¤å®š
    if (breach.details.riskToIndividuals === 'high') {
      this.scheduleDataSubjectNotification(breach);
    }
  }
  
  private static scheduleAuthorityNotification(breach: DataBreach): void {
    // GitHub Issueã®è‡ªå‹•ä½œæˆ
    const issueData = {
      title: `ğŸš¨ Data Breach Notification Required - ${breach.id}`,
      body: this.generateBreachReport(breach),
      labels: ['critical', 'data-breach', 'gdpr-notification']
    };
    
    console.warn('Authority notification required:', issueData);
  }
  
  private static generateBreachReport(breach: DataBreach): string {
    return `
## Data Breach Report

**Breach ID**: ${breach.id}
**Detection Time**: ${new Date(breach.timestamp).toISOString()}
**Severity**: ${breach.severity}

### Description
${breach.details.description || 'Automated breach detection'}

### Affected Data
${breach.affectedData.join(', ')}

### Risk Assessment
- **Personal Data Involved**: ${breach.details.personalDataInvolved ? 'Yes' : 'No'}
- **Risk to Individuals**: ${breach.details.riskToIndividuals || 'Unknown'}

### Required Actions
- [ ] Internal investigation
- [ ] Risk assessment
- [ ] Authority notification (within 72 hours)
- [ ] Data subject notification (if high risk)
- [ ] Remediation measures

### Timeline
- **Detection**: ${new Date(breach.timestamp).toISOString()}
- **Authority Notification Deadline**: ${new Date(breach.timestamp + 72 * 60 * 60 * 1000).toISOString()}
    `;
  }
}

interface DataBreach {
  id: string;
  timestamp: number;
  indicator: string;
  details: any;
  severity: 'low' | 'medium' | 'high' | 'critical';
  status: 'detected' | 'investigating' | 'contained' | 'resolved';
  affectedData: string[];
  notificationRequired: boolean;
}
```

## 3. å€‹äººæƒ…å ±ä¿è­·æ³•å¯¾å¿œ

### 3.1 åˆ©ç”¨ç›®çš„ã®ç‰¹å®šãƒ»é€šçŸ¥

#### å®Ÿè£…ä¾‹
```vue
<!-- src/components/legal/PrivacyNotice.vue -->
<template>
  <div class="privacy-notice">
    <h2>å€‹äººæƒ…å ±ã®å–ã‚Šæ‰±ã„ã«ã¤ã„ã¦</h2>
    
    <div class="purpose-section">
      <h3>åˆ©ç”¨ç›®çš„</h3>
      <ul>
        <li>ã‚²ãƒ¼ãƒ ã‚µãƒ¼ãƒ“ã‚¹ã®æä¾›</li>
        <li>ãƒ¦ãƒ¼ã‚¶ãƒ¼è¨­å®šã®è¨˜æ†¶ãƒ»å¾©å…ƒ</li>
        <li>ã‚µãƒ¼ãƒ“ã‚¹ã®æ”¹å–„ãƒ»å‘ä¸Š</li>
        <li>æŠ€è¡“çš„å•é¡Œã®è§£æ±º</li>
      </ul>
    </div>
    
    <div class="data-section">
      <h3>å–å¾—ã™ã‚‹æƒ…å ±</h3>
      <table class="data-table">
        <thead>
          <tr>
            <th>é …ç›®</th>
            <th>å–å¾—æ–¹æ³•</th>
            <th>åˆ©ç”¨ç›®çš„</th>
            <th>ä¿å­˜æœŸé–“</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>ã‚²ãƒ¼ãƒ é€²æ—</td>
            <td>è‡ªå‹•å–å¾—</td>
            <td>ã‚µãƒ¼ãƒ“ã‚¹æä¾›</td>
            <td>å‰Šé™¤ã¾ã§</td>
          </tr>
          <tr>
            <td>è¨­å®šæƒ…å ±</td>
            <td>ãƒ¦ãƒ¼ã‚¶ãƒ¼å…¥åŠ›</td>
            <td>ã‚µãƒ¼ãƒ“ã‚¹æä¾›</td>
            <td>å‰Šé™¤ã¾ã§</td>
          </tr>
          <tr>
            <td>ã‚¨ãƒ©ãƒ¼æƒ…å ±</td>
            <td>è‡ªå‹•å–å¾—</td>
            <td>æ”¹å–„ãƒ»å‘ä¸Š</td>
            <td>90æ—¥é–“</td>
          </tr>
        </tbody>
      </table>
    </div>
    
    <div class="rights-section">
      <h3>ãŠå®¢æ§˜ã®æ¨©åˆ©</h3>
      <ul>
        <li>åˆ©ç”¨åœæ­¢ãƒ»å‰Šé™¤ã®è«‹æ±‚</li>
        <li>é–‹ç¤ºã®è«‹æ±‚</li>
        <li>è¨‚æ­£ãƒ»è¿½åŠ ãƒ»å‰Šé™¤ã®è«‹æ±‚</li>
      </ul>
      
      <button @click="exerciseRights" class="rights-button">
        æ¨©åˆ©ã‚’è¡Œä½¿ã™ã‚‹
      </button>
    </div>
  </div>
</template>

<script setup lang="ts">
const exerciseRights = () => {
  // æ¨©åˆ©è¡Œä½¿ç”»é¢ã¸ã®é·ç§»
  window.open('/data-subject-rights', '_blank');
};
</script>
```

### 3.2 å®‰å…¨ç®¡ç†æªç½®

#### æŠ€è¡“çš„å®‰å…¨ç®¡ç†æªç½®
```typescript
// src/utils/security-measures.ts
export class SecurityMeasures {
  // ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡
  static implementAccessControl(): void {
    // CSPè¨­å®š
    this.setContentSecurityPolicy();
    
    // ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ˜ãƒƒãƒ€ãƒ¼è¨­å®š
    this.setSecurityHeaders();
    
    // HTTPSå¼·åˆ¶
    this.enforceHTTPS();
  }
  
  // ãƒ‡ãƒ¼ã‚¿ã®æš—å·åŒ–
  static encryptSensitiveData(data: any): string {
    return CryptoManager.encryptData(JSON.stringify(data), this.getEncryptionKey());
  }
  
  // ã‚¢ã‚¯ã‚»ã‚¹ãƒ­ã‚°ã®è¨˜éŒ²
  static logAccess(event: AccessEvent): void {
    const logEntry: AccessLog = {
      timestamp: Date.now(),
      event: event.type,
      resource: event.resource,
      result: event.result,
      userAgent: navigator.userAgent,
      sessionId: this.getSessionId()
    };
    
    this.storeAccessLog(logEntry);
  }
  
  // ä¸æ­£ã‚¢ã‚¯ã‚»ã‚¹ã®æ¤œçŸ¥
  static detectSuspiciousActivity(): void {
    const recentAccess = this.getRecentAccessLogs();
    
    // çŸ­æ™‚é–“ã§ã®å¤§é‡ã‚¢ã‚¯ã‚»ã‚¹æ¤œçŸ¥
    if (this.isRapidAccess(recentAccess)) {
      this.alertSuspiciousActivity('rapid_access', recentAccess);
    }
    
    // ç•°å¸¸ãªã‚¢ã‚¯ã‚»ã‚¹ãƒ‘ã‚¿ãƒ¼ãƒ³æ¤œçŸ¥
    if (this.isAnomalousPattern(recentAccess)) {
      this.alertSuspiciousActivity('anomalous_pattern', recentAccess);
    }
  }
  
  private static isRapidAccess(logs: AccessLog[]): boolean {
    const timeWindow = 5 * 60 * 1000; // 5åˆ†
    const threshold = 100; // 100å›
    
    const now = Date.now();
    const recentLogs = logs.filter(log => (now - log.timestamp) < timeWindow);
    
    return recentLogs.length > threshold;
  }
}

interface AccessEvent {
  type: string;
  resource: string;
  result: 'success' | 'failure' | 'blocked';
}

interface AccessLog {
  timestamp: number;
  event: string;
  resource: string;
  result: string;
  userAgent: string;
  sessionId: string;
}
```

## 4. ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£æ¨™æº–å¯¾å¿œ

### 4.1 OWASP Top 10 å¯¾ç­–

#### A03:2021 â€“ Injectionå¯¾ç­–
```typescript
// src/utils/injection-prevention.ts
export class InjectionPrevention {
  // XSSé˜²æ­¢
  static sanitizeInput(input: string): string {
    const map: Record<string, string> = {
      '&': '&amp;',
      '<': '&lt;',
      '>': '&gt;',
      '"': '&quot;',
      "'": '&#x27;',
      '/': '&#x2F;'
    };
    
    return input.replace(/[&<>"'/]/g, s => map[s]);
  }
  
  // HTMLã‚¨ã‚¹ã‚±ãƒ¼ãƒ—
  static escapeHtml(unsafe: string): string {
    return unsafe
      .replace(/&/g, "&amp;")
      .replace(/</g, "&lt;")
      .replace(/>/g, "&gt;")
      .replace(/"/g, "&quot;")
      .replace(/'/g, "&#039;");
  }
  
  // JSONã‚¨ã‚¹ã‚±ãƒ¼ãƒ—
  static escapeJson(obj: any): string {
    return JSON.stringify(obj).replace(/</g, '\\u003c').replace(/>/g, '\\u003e');
  }
  
  // URLæ¤œè¨¼
  static validateUrl(url: string): boolean {
    try {
      const urlObj = new URL(url);
      return ['http:', 'https:'].includes(urlObj.protocol) &&
             !url.includes('javascript:') &&
             !url.includes('data:');
    } catch {
      return false;
    }
  }
}
```

### 4.2 NIST Frameworkå¯¾å¿œ

#### è­˜åˆ¥ï¼ˆIdentifyï¼‰æ©Ÿèƒ½
```typescript
// src/utils/asset-inventory.ts
export class AssetInventory {
  private static readonly ASSETS = {
    data: [
      { name: 'game_state', classification: 'internal', retention: 'user_controlled' },
      { name: 'user_preferences', classification: 'internal', retention: 'user_controlled' },
      { name: 'error_logs', classification: 'internal', retention: '90_days' },
      { name: 'access_logs', classification: 'confidential', retention: '30_days' }
    ],
    systems: [
      { name: 'web_application', criticality: 'high', exposure: 'public' },
      { name: 'github_repository', criticality: 'high', exposure: 'public' },
      { name: 'github_actions', criticality: 'medium', exposure: 'internal' }
    ],
    dependencies: [
      { name: 'vue', version: '3.x', risk: 'low' },
      { name: 'typescript', version: '5.x', risk: 'low' },
      { name: 'vite', version: '5.x', risk: 'medium' }
    ]
  };
  
  static getAssetInventory(): AssetInventory {
    return {
      lastUpdated: Date.now(),
      assets: this.ASSETS,
      riskAssessment: this.assessRisks()
    };
  }
  
  private static assessRisks(): RiskAssessment[] {
    return [
      {
        asset: 'user_data',
        threat: 'data_breach',
        likelihood: 'low',
        impact: 'medium',
        riskLevel: 'medium',
        mitigations: ['encryption', 'access_control', 'monitoring']
      },
      {
        asset: 'web_application',
        threat: 'xss_attack',
        likelihood: 'medium',
        impact: 'medium',
        riskLevel: 'medium',
        mitigations: ['input_validation', 'output_encoding', 'csp']
      }
    ];
  }
}

interface AssetInventory {
  lastUpdated: number;
  assets: any;
  riskAssessment: RiskAssessment[];
}

interface RiskAssessment {
  asset: string;
  threat: string;
  likelihood: 'low' | 'medium' | 'high';
  impact: 'low' | 'medium' | 'high';
  riskLevel: 'low' | 'medium' | 'high' | 'critical';
  mitigations: string[];
}
```

## 5. ç›£æŸ»ãƒ»è©•ä¾¡

### 5.1 ã‚³ãƒ³ãƒ—ãƒ©ã‚¤ã‚¢ãƒ³ã‚¹ç›£æŸ»

#### è‡ªå‹•ç›£æŸ»ã‚·ã‚¹ãƒ†ãƒ 
```typescript
// src/utils/compliance-audit.ts
export class ComplianceAudit {
  static async performAudit(): Promise<AuditReport> {
    const report: AuditReport = {
      timestamp: Date.now(),
      auditor: 'automated_system',
      scope: ['gdpr', 'personal_info_protection_act', 'owasp_top10'],
      findings: [],
      recommendations: [],
      overallCompliance: 0
    };
    
    // GDPRç›£æŸ»
    const gdprFindings = await this.auditGDPR();
    report.findings.push(...gdprFindings);
    
    // å€‹äººæƒ…å ±ä¿è­·æ³•ç›£æŸ»
    const pipaFindings = await this.auditPIPA();
    report.findings.push(...pipaFindings);
    
    // ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç›£æŸ»
    const securityFindings = await this.auditSecurity();
    report.findings.push(...securityFindings);
    
    // ç·åˆè©•ä¾¡
    report.overallCompliance = this.calculateCompliance(report.findings);
    report.recommendations = this.generateRecommendations(report.findings);
    
    return report;
  }
  
  private static async auditGDPR(): Promise<AuditFinding[]> {
    const findings: AuditFinding[] = [];
    
    // åˆæ³•çš„æ ¹æ‹ ã®ç¢ºèª
    if (!this.checkLegalBasis()) {
      findings.push({
        type: 'gdpr_legal_basis',
        severity: 'high',
        description: 'Legal basis for data processing not clearly established',
        recommendation: 'Document legal basis for all data processing activities'
      });
    }
    
    // ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ãƒãƒªã‚·ãƒ¼ã®ç¢ºèª
    if (!this.checkPrivacyPolicy()) {
      findings.push({
        type: 'gdpr_privacy_policy',
        severity: 'medium',
        description: 'Privacy policy needs updates',
        recommendation: 'Update privacy policy to include all required information'
      });
    }
    
    return findings;
  }
  
  private static calculateCompliance(findings: AuditFinding[]): number {
    const totalChecks = 50; // ç·ãƒã‚§ãƒƒã‚¯é …ç›®æ•°
    const criticalIssues = findings.filter(f => f.severity === 'critical').length;
    const highIssues = findings.filter(f => f.severity === 'high').length;
    const mediumIssues = findings.filter(f => f.severity === 'medium').length;
    
    const penaltyScore = (criticalIssues * 10) + (highIssues * 5) + (mediumIssues * 2);
    const complianceScore = Math.max(0, 100 - (penaltyScore / totalChecks * 100));
    
    return Math.round(complianceScore);
  }
}

interface AuditReport {
  timestamp: number;
  auditor: string;
  scope: string[];
  findings: AuditFinding[];
  recommendations: string[];
  overallCompliance: number;
}

interface AuditFinding {
  type: string;
  severity: 'low' | 'medium' | 'high' | 'critical';
  description: string;
  recommendation: string;
}
```

### 5.2 ç¶™ç¶šçš„ã‚³ãƒ³ãƒ—ãƒ©ã‚¤ã‚¢ãƒ³ã‚¹ç›£è¦–

#### GitHub Actions ã«ã‚ˆã‚‹ç›£è¦–
```yaml
# .github/workflows/compliance-check.yml
name: Compliance Check

on:
  push:
    branches: [ master ]
  schedule:
    - cron: '0 6 * * 1' # æ¯é€±æœˆæ›œæ—¥6:00

jobs:
  compliance-audit:
    runs-on: ubuntu-latest
    
    steps:
      - name: Checkout code
        uses: actions/checkout@v4
      
      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '18'
      
      - name: Install dependencies
        run: npm ci
      
      - name: Run GDPR compliance check
        run: npm run compliance:gdpr
      
      - name: Run security compliance check
        run: npm run compliance:security
      
      - name: Generate compliance report
        run: |
          node scripts/generate-compliance-report.js > compliance-report.md
      
      - name: Create compliance issue
        if: failure()
        uses: actions/github-script@v7
        with:
          script: |
            const fs = require('fs');
            const report = fs.readFileSync('compliance-report.md', 'utf8');
            
            github.rest.issues.create({
              owner: context.repo.owner,
              repo: context.repo.repo,
              title: 'âš ï¸ Compliance Issues Detected',
              body: report,
              labels: ['compliance', 'security', 'urgent']
            });
```

## 6. ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

### GDPRæº–æ‹ ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ
- [ ] åˆæ³•çš„æ ¹æ‹ ãŒæ–‡æ›¸åŒ–ã•ã‚Œã¦ã„ã‚‹
- [ ] ãƒ‡ãƒ¼ã‚¿å‡¦ç†è¨˜éŒ²ãŒç¶­æŒã•ã‚Œã¦ã„ã‚‹
- [ ] ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ãƒãƒªã‚·ãƒ¼ãŒæ•´å‚™ã•ã‚Œã¦ã„ã‚‹
- [ ] ãƒ‡ãƒ¼ã‚¿ä¸»ä½“ã®æ¨©åˆ©ãŒå®Ÿè£…ã•ã‚Œã¦ã„ã‚‹
- [ ] ãƒ‡ãƒ¼ã‚¿ä¾µå®³é€šçŸ¥æ‰‹é †ãŒç¢ºç«‹ã•ã‚Œã¦ã„ã‚‹
- [ ] ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ãƒ»ãƒã‚¤ãƒ»ãƒ‡ã‚¶ã‚¤ãƒ³ãŒå®Ÿè£…ã•ã‚Œã¦ã„ã‚‹

### å€‹äººæƒ…å ±ä¿è­·æ³•æº–æ‹ ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ
- [ ] åˆ©ç”¨ç›®çš„ãŒç‰¹å®šãƒ»é€šçŸ¥ã•ã‚Œã¦ã„ã‚‹
- [ ] é©æ­£å–å¾—ãŒç¢ºä¿ã•ã‚Œã¦ã„ã‚‹
- [ ] å®‰å…¨ç®¡ç†æªç½®ãŒå®Ÿæ–½ã•ã‚Œã¦ã„ã‚‹
- [ ] ç¬¬ä¸‰è€…æä¾›ãŒåˆ¶é™ã•ã‚Œã¦ã„ã‚‹
- [ ] é–‹ç¤ºç­‰ã®æ±‚ã‚ã«å¯¾å¿œã§ãã‚‹
- [ ] è‹¦æƒ…å‡¦ç†ä½“åˆ¶ãŒæ•´å‚™ã•ã‚Œã¦ã„ã‚‹

### ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£æ¨™æº–æº–æ‹ ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ
- [ ] OWASP Top 10 å¯¾ç­–ãŒå®Ÿè£…ã•ã‚Œã¦ã„ã‚‹
- [ ] ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ˜ãƒƒãƒ€ãƒ¼ãŒè¨­å®šã•ã‚Œã¦ã„ã‚‹
- [ ] æš—å·åŒ–ãŒé©åˆ‡ã«å®Ÿè£…ã•ã‚Œã¦ã„ã‚‹
- [ ] ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡ãŒå®Ÿè£…ã•ã‚Œã¦ã„ã‚‹
- [ ] ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç›£è¦–ãŒå®Ÿæ–½ã•ã‚Œã¦ã„ã‚‹
- [ ] ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆå¯¾å¿œæ‰‹é †ãŒç¢ºç«‹ã•ã‚Œã¦ã„ã‚‹

## é–¢é€£ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

- [ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒãƒªã‚·ãƒ¼](./SECURITY_POLICY.md)
- [ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ãƒãƒªã‚·ãƒ¼](./PRIVACY_POLICY.md)
- [ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆå¯¾å¿œæ‰‹é †](./INCIDENT_RESPONSE.md)
- [ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³](../development/SECURITY_GUIDELINES.md)