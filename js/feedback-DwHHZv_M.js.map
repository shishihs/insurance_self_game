{"version":3,"file":"feedback-DwHHZv_M.js","sources":["../../src/components/feedback/FeedbackModal.vue","../../src/components/feedback/ReviewSystem.vue","../../src/components/feedback/BugReporter.vue","../../src/components/feedback/FeedbackButton.vue"],"sourcesContent":["<template>\r\n  <div v-if=\"isOpen\" class=\"feedback-modal-overlay\" @click=\"closeOnOverlay\">\r\n    <div class=\"feedback-modal\" @click.stop role=\"dialog\" aria-modal=\"true\" aria-labelledby=\"feedback-title\">\r\n      <!-- ヘッダー -->\r\n      <header class=\"feedback-header\">\r\n        <h2 id=\"feedback-title\" class=\"feedback-title\">\r\n          {{ currentStep === 'selection' ? 'フィードバックを送信' : getStepTitle() }}\r\n        </h2>\r\n        <button\r\n          @click=\"close\"\r\n          class=\"close-button\"\r\n          aria-label=\"フィードバックモーダルを閉じる\"\r\n          type=\"button\"\r\n        >\r\n          <svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\r\n            <path d=\"M18 6L6 18M6 6l12 12\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"/>\r\n          </svg>\r\n        </button>\r\n      </header>\r\n\r\n      <!-- ステップ選択 -->\r\n      <div v-if=\"currentStep === 'selection'\" class=\"feedback-selection\">\r\n        <p class=\"selection-description\">\r\n          ご意見やご要望をお聞かせください。あなたのフィードバックがゲームをより良くします。\r\n        </p>\r\n        \r\n        <div class=\"feedback-options\">\r\n          <button\r\n            v-for=\"option in feedbackOptions\"\r\n            :key=\"option.type\"\r\n            @click=\"selectFeedbackType(option.type)\"\r\n            class=\"feedback-option-btn\"\r\n            :aria-describedby=\"`option-${option.type}-desc`\"\r\n          >\r\n            <div class=\"option-icon\" :style=\"{ backgroundColor: option.color }\">\r\n              {{ option.icon }}\r\n            </div>\r\n            <div class=\"option-content\">\r\n              <h3 class=\"option-title\">{{ option.title }}</h3>\r\n              <p class=\"option-description\" :id=\"`option-${option.type}-desc`\">\r\n                {{ option.description }}\r\n              </p>\r\n            </div>\r\n          </button>\r\n        </div>\r\n      </div>\r\n\r\n      <!-- フィードバックフォーム -->\r\n      <form v-else @submit.prevent=\"submitFeedback\" class=\"feedback-form\">\r\n        <!-- カテゴリ別の専用フィールド -->\r\n        <div v-if=\"selectedType === 'bug'\" class=\"bug-report-fields\">\r\n          <div class=\"form-group\">\r\n            <label for=\"bug-severity\" class=\"form-label\">重要度</label>\r\n            <select \r\n              id=\"bug-severity\" \r\n              v-model=\"formData.bugReport.severity\" \r\n              class=\"form-select\"\r\n              required\r\n            >\r\n              <option value=\"\">選択してください</option>\r\n              <option value=\"low\">軽微 - 操作に支障なし</option>\r\n              <option value=\"medium\">中程度 - 一部操作に影響</option>\r\n              <option value=\"high\">重大 - ゲーム進行に支障</option>\r\n              <option value=\"critical\">致命的 - ゲームが停止</option>\r\n            </select>\r\n          </div>\r\n\r\n          <div class=\"form-group\">\r\n            <label for=\"reproduction-rate\" class=\"form-label\">再現頻度</label>\r\n            <select \r\n              id=\"reproduction-rate\" \r\n              v-model=\"formData.bugReport.reproductionRate\" \r\n              class=\"form-select\"\r\n              required\r\n            >\r\n              <option value=\"\">選択してください</option>\r\n              <option value=\"always\">毎回発生</option>\r\n              <option value=\"often\">頻繁に発生</option>\r\n              <option value=\"sometimes\">時々発生</option>\r\n              <option value=\"rarely\">稀に発生</option>\r\n            </select>\r\n          </div>\r\n        </div>\r\n\r\n        <div v-if=\"selectedType === 'review'\" class=\"review-fields\">\r\n          <div class=\"form-group\">\r\n            <label class=\"form-label\">総合評価</label>\r\n            <div class=\"star-rating\">\r\n              <button\r\n                v-for=\"star in 5\"\r\n                :key=\"star\"\r\n                type=\"button\"\r\n                @click=\"setRating('overall', star)\"\r\n                class=\"star-button\"\r\n                :class=\"{ active: formData.review.overallRating >= star }\"\r\n                :aria-label=\"`総合評価 ${star} 星`\"\r\n              >\r\n                ★\r\n              </button>\r\n            </div>\r\n          </div>\r\n\r\n          <div class=\"aspect-ratings\">\r\n            <div v-for=\"aspect in aspectRatings\" :key=\"aspect.key\" class=\"aspect-rating\">\r\n              <label class=\"form-label\">{{ aspect.label }}</label>\r\n              <div class=\"star-rating\">\r\n                <button\r\n                  v-for=\"star in 5\"\r\n                  :key=\"star\"\r\n                  type=\"button\"\r\n                  @click=\"setRating(aspect.key, star)\"\r\n                  class=\"star-button\"\r\n                  :class=\"{ active: formData.review.aspects[aspect.key] >= star }\"\r\n                  :aria-label=\"`${aspect.label} ${star} 星`\"\r\n                >\r\n                  ★\r\n                </button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <div class=\"form-group\">\r\n            <label class=\"form-label\">\r\n              <input\r\n                type=\"checkbox\"\r\n                v-model=\"formData.review.wouldRecommend\"\r\n                class=\"form-checkbox\"\r\n              />\r\n              このゲームを他の人におすすめしますか？\r\n            </label>\r\n          </div>\r\n        </div>\r\n\r\n        <!-- 共通フィールド -->\r\n        <div class=\"form-group\">\r\n          <label for=\"feedback-title\" class=\"form-label\">\r\n            タイトル <span class=\"required\">*</span>\r\n          </label>\r\n          <input\r\n            id=\"feedback-title\"\r\n            v-model=\"formData.title\"\r\n            type=\"text\"\r\n            class=\"form-input\"\r\n            placeholder=\"簡潔にお聞かせください\"\r\n            required\r\n            maxlength=\"100\"\r\n          />\r\n          <div class=\"character-count\">{{ formData.title.length }}/100</div>\r\n        </div>\r\n\r\n        <div class=\"form-group\">\r\n          <label for=\"feedback-description\" class=\"form-label\">\r\n            詳細 <span class=\"required\">*</span>\r\n          </label>\r\n          <textarea\r\n            id=\"feedback-description\"\r\n            v-model=\"formData.description\"\r\n            class=\"form-textarea\"\r\n            :placeholder=\"getDescriptionPlaceholder()\"\r\n            required\r\n            rows=\"5\"\r\n            maxlength=\"1000\"\r\n          ></textarea>\r\n          <div class=\"character-count\">{{ formData.description.length }}/1000</div>\r\n        </div>\r\n\r\n        <!-- バグレポート専用フィールド -->\r\n        <div v-if=\"selectedType === 'bug'\" class=\"bug-specific-fields\">\r\n          <div class=\"form-group\">\r\n            <label for=\"steps-to-reproduce\" class=\"form-label\">\r\n              再現手順 <span class=\"required\">*</span>\r\n            </label>\r\n            <textarea\r\n              id=\"steps-to-reproduce\"\r\n              v-model=\"formData.bugReport.stepsToReproduce\"\r\n              class=\"form-textarea\"\r\n              placeholder=\"1. ○○をクリック&#10;2. △△を選択&#10;3. □□が発生\"\r\n              required\r\n              rows=\"4\"\r\n            ></textarea>\r\n          </div>\r\n\r\n          <div class=\"form-group\">\r\n            <label for=\"expected-behavior\" class=\"form-label\">期待される動作</label>\r\n            <textarea\r\n              id=\"expected-behavior\"\r\n              v-model=\"formData.bugReport.expectedBehavior\"\r\n              class=\"form-textarea\"\r\n              placeholder=\"本来はどのような動作を期待していましたか？\"\r\n              rows=\"2\"\r\n            ></textarea>\r\n          </div>\r\n\r\n          <div class=\"form-group\">\r\n            <label for=\"actual-behavior\" class=\"form-label\">実際の動作</label>\r\n            <textarea\r\n              id=\"actual-behavior\"\r\n              v-model=\"formData.bugReport.actualBehavior\"\r\n              class=\"form-textarea\"\r\n              placeholder=\"実際にはどのような動作が発生しましたか？\"\r\n              rows=\"2\"\r\n            ></textarea>\r\n          </div>\r\n\r\n          <div class=\"form-group\">\r\n            <label class=\"form-label\">\r\n              <input\r\n                type=\"checkbox\"\r\n                v-model=\"includeScreenshot\"\r\n                class=\"form-checkbox\"\r\n              />\r\n              スクリーンショットを含める（推奨）\r\n            </label>\r\n            <p class=\"form-help\">スクリーンショットは問題の特定に役立ちます</p>\r\n          </div>\r\n        </div>\r\n\r\n        <!-- 送信者情報 -->\r\n        <div class=\"submitter-section\">\r\n          <h3 class=\"section-title\">送信者情報（任意）</h3>\r\n          \r\n          <div class=\"form-group\">\r\n            <label class=\"form-label\">\r\n              <input\r\n                type=\"checkbox\"\r\n                v-model=\"isAnonymous\"\r\n                class=\"form-checkbox\"\r\n              />\r\n              匿名で送信する\r\n            </label>\r\n            <p class=\"form-help\">\r\n              匿名の場合、返信はできませんが、フィードバックは大切に活用させていただきます\r\n            </p>\r\n          </div>\r\n\r\n          <div v-if=\"!isAnonymous\" class=\"contact-fields\">\r\n            <div class=\"form-group\">\r\n              <label for=\"submitter-name\" class=\"form-label\">お名前</label>\r\n              <input\r\n                id=\"submitter-name\"\r\n                v-model=\"formData.submitter.name\"\r\n                type=\"text\"\r\n                class=\"form-input\"\r\n                placeholder=\"田中太郎\"\r\n                maxlength=\"50\"\r\n              />\r\n            </div>\r\n\r\n            <div class=\"form-group\">\r\n              <label for=\"submitter-email\" class=\"form-label\">メールアドレス</label>\r\n              <input\r\n                id=\"submitter-email\"\r\n                v-model=\"formData.submitter.email\"\r\n                type=\"email\"\r\n                class=\"form-input\"\r\n                placeholder=\"example@example.com\"\r\n              />\r\n              <p class=\"form-help\">返信が必要な場合のみご入力ください</p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <!-- アクションボタン -->\r\n        <div class=\"form-actions\">\r\n          <button\r\n            type=\"button\"\r\n            @click=\"goBack\"\r\n            class=\"btn-secondary\"\r\n          >\r\n            戻る\r\n          </button>\r\n          <button\r\n            type=\"submit\"\r\n            class=\"btn-primary\"\r\n            :disabled=\"!isFormValid || isSubmitting\"\r\n          >\r\n            <span v-if=\"isSubmitting\">送信中...</span>\r\n            <span v-else>送信する</span>\r\n          </button>\r\n        </div>\r\n      </form>\r\n\r\n      <!-- 送信完了画面 -->\r\n      <div v-if=\"currentStep === 'success'\" class=\"success-message\">\r\n        <div class=\"success-icon\">✅</div>\r\n        <h3 class=\"success-title\">フィードバックを送信しました</h3>\r\n        <p class=\"success-description\">\r\n          貴重なご意見をありがとうございます。\r\n          {{isAnonymous ? 'いただいたフィードバックは今後の改善に活用させていただきます。' : 'ご連絡先をいただいている場合は、必要に応じて返信いたします。'}}\r\n        </p>\r\n        <button @click=\"close\" class=\"btn-primary\">閉じる</button>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup lang=\"ts\">\r\nimport { ref, reactive, computed, watch, onMounted } from 'vue'\r\nimport { FeedbackManagementService } from '../../domain/services/FeedbackManagementService'\r\nimport type { SatisfactionRating } from '../../domain/entities/Feedback';\nimport { FeedbackCategory } from '../../domain/entities/Feedback'\r\n\r\n// Props & Emits\r\ninterface Props {\r\n  isOpen: boolean\r\n  gameState?: {\r\n    stage: string\r\n    turn: number\r\n    vitality: number\r\n    phase: string\r\n  }\r\n}\r\n\r\nconst props = withDefaults(defineProps<Props>(), {\r\n  isOpen: false\r\n})\r\n\r\nconst emit = defineEmits<{\r\n  close: []\r\n  feedbackSubmitted: [feedbackId: string]\r\n}>()\r\n\r\n// Services\r\nconst feedbackService = new FeedbackManagementService()\r\n\r\n// State\r\nconst currentStep = ref<'selection' | 'form' | 'success'>('selection')\r\nconst selectedType = ref<string>('')\r\nconst isSubmitting = ref(false)\r\nconst isAnonymous = ref(true)\r\nconst includeScreenshot = ref(false)\r\n\r\n// Form Data\r\nconst formData = reactive({\r\n  title: '',\r\n  description: '',\r\n  submitter: {\r\n    name: '',\r\n    email: ''\r\n  },\r\n  bugReport: {\r\n    severity: '',\r\n    reproductionRate: '',\r\n    stepsToReproduce: '',\r\n    expectedBehavior: '',\r\n    actualBehavior: ''\r\n  },\r\n  review: {\r\n    overallRating: 0,\r\n    aspects: {\r\n      gameplay: 0,\r\n      ui: 0,\r\n      performance: 0,\r\n      accessibility: 0\r\n    },\r\n    wouldRecommend: false\r\n  }\r\n})\r\n\r\n// Feedback Options\r\nconst feedbackOptions = [\r\n  {\r\n    type: 'bug',\r\n    title: 'バグ報告',\r\n    description: '動作不良や予期しない動作を報告',\r\n    icon: '🐛',\r\n    color: '#EF4444'\r\n  },\r\n  {\r\n    type: 'feature',\r\n    title: '機能要望',\r\n    description: '新しい機能やゲームプレイの改善案',\r\n    icon: '💡',\r\n    color: '#3B82F6'\r\n  },\r\n  {\r\n    type: 'ui',\r\n    title: 'UI/UX改善',\r\n    description: 'インターフェースの使いやすさ向上',\r\n    icon: '🎨',\r\n    color: '#8B5CF6'\r\n  },\r\n  {\r\n    type: 'review',\r\n    title: '評価・レビュー',\r\n    description: 'ゲーム全体の評価とご感想',\r\n    icon: '⭐',\r\n    color: '#F59E0B'\r\n  },\r\n  {\r\n    type: 'accessibility',\r\n    title: 'アクセシビリティ',\r\n    description: 'バリアフリー・操作性の改善提案',\r\n    icon: '♿',\r\n    color: '#10B981'\r\n  },\r\n  {\r\n    type: 'general',\r\n    title: 'その他',\r\n    description: '上記以外のご意見・ご質問',\r\n    icon: '💬',\r\n    color: '#6B7280'\r\n  }\r\n]\r\n\r\n// Aspect Ratings\r\nconst aspectRatings = [\r\n  { key: 'gameplay', label: 'ゲームプレイ' },\r\n  { key: 'ui', label: 'UI・操作性' },\r\n  { key: 'performance', label: 'パフォーマンス' },\r\n  { key: 'accessibility', label: 'アクセシビリティ' }\r\n]\r\n\r\n// Computed\r\nconst isFormValid = computed(() => {\r\n  if (!formData.title.trim() || !formData.description.trim()) {\r\n    return false\r\n  }\r\n\r\n  if (selectedType.value === 'bug') {\r\n    return formData.bugReport.severity && \r\n           formData.bugReport.reproductionRate && \r\n           formData.bugReport.stepsToReproduce.trim()\r\n  }\r\n\r\n  if (selectedType.value === 'review') {\r\n    return formData.review.overallRating > 0\r\n  }\r\n\r\n  return true\r\n})\r\n\r\n// Methods\r\nconst selectFeedbackType = (type: string) => {\r\n  selectedType.value = type\r\n  currentStep.value = 'form'\r\n}\r\n\r\nconst goBack = () => {\r\n  if (currentStep.value === 'form') {\r\n    currentStep.value = 'selection'\r\n  }\r\n}\r\n\r\nconst close = () => {\r\n  resetForm()\r\n  emit('close')\r\n}\r\n\r\nconst closeOnOverlay = (event: MouseEvent) => {\r\n  if (event.target === event.currentTarget) {\r\n    close()\r\n  }\r\n}\r\n\r\nconst setRating = (type: string, rating: number) => {\r\n  if (type === 'overall') {\r\n    formData.review.overallRating = rating\r\n  } else {\r\n    formData.review.aspects[type as keyof typeof formData.review.aspects] = rating\r\n  }\r\n}\r\n\r\nconst getStepTitle = () => {\r\n  const option = feedbackOptions.find(opt => opt.type === selectedType.value)\r\n  return option ? option.title : 'フィードバック'\r\n}\r\n\r\nconst getDescriptionPlaceholder = () => {\r\n  switch (selectedType.value) {\r\n    case 'bug':\r\n      return 'どのような問題が発生しましたか？できるだけ詳しく教えてください。'\r\n    case 'feature':\r\n      return 'どのような機能があると良いと思いますか？具体的なアイデアをお聞かせください。'\r\n    case 'ui':\r\n      return 'どの部分を改善すべきでしょうか？より使いやすくするための提案をお願いします。'\r\n    case 'review':\r\n      return 'ゲーム全体の感想や、特に良かった点・改善すべき点をお聞かせください。'\r\n    case 'accessibility':\r\n      return 'どのような機能や改善があると、より利用しやすくなりますか？'\r\n    default:\r\n      return 'ご意見やご質問をお聞かせください。'\r\n  }\r\n}\r\n\r\nconst getCategoryFromType = (type: string): FeedbackCategory => {\r\n  const mapping: Record<string, FeedbackCategory> = {\r\n    bug: FeedbackCategory.BUG_REPORT,\r\n    feature: FeedbackCategory.FEATURE_REQUEST,\r\n    ui: FeedbackCategory.UI_UX,\r\n    review: FeedbackCategory.GENERAL,\r\n    accessibility: FeedbackCategory.ACCESSIBILITY,\r\n    general: FeedbackCategory.GENERAL\r\n  }\r\n  return mapping[type] || FeedbackCategory.GENERAL\r\n}\r\n\r\nconst submitFeedback = async () => {\r\n  if (!isFormValid.value || isSubmitting.value) return\r\n\r\n  isSubmitting.value = true\r\n\r\n  try {\r\n    // スクリーンショットを取得（バグレポートで選択された場合）\r\n    let screenshot: string | undefined\r\n    if (selectedType.value === 'bug' && includeScreenshot.value) {\r\n      screenshot = await captureScreenshot()\r\n    }\r\n\r\n    // システム情報を収集\r\n    const systemInfo = {\r\n      userAgent: navigator.userAgent,\r\n      screenResolution: `${screen.width}x${screen.height}`,\r\n      viewport: `${window.innerWidth}x${window.innerHeight}`,\r\n      gameVersion: '0.2.7', // TODO: バージョンを動的に取得\r\n      timestamp: new Date(),\r\n      gameState: props.gameState\r\n    }\r\n\r\n    // 送信者情報\r\n    const submitter = {\r\n      name: isAnonymous.value ? undefined : formData.submitter.name || undefined,\r\n      email: isAnonymous.value ? undefined : formData.submitter.email || undefined,\r\n      isAnonymous: isAnonymous.value,\r\n      userAgent: navigator.userAgent,\r\n      sessionId: generateSessionId()\r\n    }\r\n\r\n    // フィードバック作成パラメータ\r\n    const createParams = {\r\n      category: getCategoryFromType(selectedType.value),\r\n      title: formData.title.trim(),\r\n      description: formData.description.trim(),\r\n      submitter,\r\n      systemInfo,\r\n      tags: [selectedType.value]\r\n    }\r\n\r\n    // カテゴリ別の詳細データを追加\r\n    if (selectedType.value === 'bug') {\r\n      createParams.bugReportData = {\r\n        stepsToReproduce: formData.bugReport.stepsToReproduce.split('\\n').filter(step => step.trim()),\r\n        expectedBehavior: formData.bugReport.expectedBehavior,\r\n        actualBehavior: formData.bugReport.actualBehavior,\r\n        screenshot,\r\n        severity: formData.bugReport.severity as 'low' | 'medium' | 'high' | 'critical',\r\n        reproductionRate: formData.bugReport.reproductionRate as 'always' | 'often' | 'sometimes' | 'rarely'\r\n      }\r\n    }\r\n\r\n    if (selectedType.value === 'review') {\r\n      createParams.reviewData = {\r\n        overallRating: formData.review.overallRating as SatisfactionRating,\r\n        aspects: {\r\n          gameplay: formData.review.aspects.gameplay as SatisfactionRating,\r\n          ui: formData.review.aspects.ui as SatisfactionRating,\r\n          performance: formData.review.aspects.performance as SatisfactionRating,\r\n          accessibility: formData.review.aspects.accessibility as SatisfactionRating\r\n        },\r\n        wouldRecommend: formData.review.wouldRecommend,\r\n        playTime: calculatePlayTime()\r\n      }\r\n    }\r\n\r\n    // フィードバックを作成\r\n    const feedback = feedbackService.createFeedback(createParams)\r\n    \r\n    // 成功通知\r\n    currentStep.value = 'success'\r\n    emit('feedbackSubmitted', feedback.id)\r\n\r\n    // アナリティクス送信（将来的に実装）\r\n    trackFeedbackSubmission(selectedType.value, feedback.id)\r\n\r\n  } catch (error) {\r\n    console.error('Failed to submit feedback:', error)\r\n    alert('フィードバックの送信に失敗しました。しばらく後にもう一度お試しください。')\r\n  } finally {\r\n    isSubmitting.value = false\r\n  }\r\n}\r\n\r\nconst captureScreenshot = async (): Promise<string | undefined> => {\r\n  try {\r\n    // HTML2Canvasまたは類似のライブラリを使用してスクリーンショットを取得\r\n    // 現在は簡易実装として、canvas要素から画像データを取得\r\n    const canvas = document.createElement('canvas')\r\n    const ctx = canvas.getContext('2d')\r\n    if (!ctx) return undefined\r\n\r\n    canvas.width = window.innerWidth\r\n    canvas.height = window.innerHeight\r\n\r\n    // 簡易的な実装（実際にはhtml2canvasなどを使用）\r\n    ctx.fillStyle = '#1a1a1a'\r\n    ctx.fillRect(0, 0, canvas.width, canvas.height)\r\n    ctx.fillStyle = '#ffffff'\r\n    ctx.font = '16px Arial'\r\n    ctx.fillText(`Screenshot captured at ${  new Date().toLocaleString()}`, 10, 30)\r\n\r\n    return canvas.toDataURL('image/png')\r\n  } catch (error) {\r\n    console.error('Failed to capture screenshot:', error)\r\n    return undefined\r\n  }\r\n}\r\n\r\nconst generateSessionId = (): string => {\r\n  return `session_${  Date.now()  }_${  Math.random().toString(36).substr(2, 9)}`\r\n}\r\n\r\nconst calculatePlayTime = (): number => {\r\n  // 実際の実装では、ゲーム開始からの経過時間を計算\r\n  return Math.floor(Math.random() * 3600) // 仮の実装\r\n}\r\n\r\nconst trackFeedbackSubmission = (type: string, feedbackId: string) => {\r\n  // アナリティクスイベントを送信\r\n  console.log(`Feedback submitted: ${type} (${feedbackId})`)\r\n}\r\n\r\nconst resetForm = () => {\r\n  currentStep.value = 'selection'\r\n  selectedType.value = ''\r\n  isSubmitting.value = false\r\n  isAnonymous.value = true\r\n  includeScreenshot.value = false\r\n  \r\n  // フォームデータをリセット\r\n  Object.assign(formData, {\r\n    title: '',\r\n    description: '',\r\n    submitter: { name: '', email: '' },\r\n    bugReport: {\r\n      severity: '',\r\n      reproductionRate: '',\r\n      stepsToReproduce: '',\r\n      expectedBehavior: '',\r\n      actualBehavior: ''\r\n    },\r\n    review: {\r\n      overallRating: 0,\r\n      aspects: { gameplay: 0, ui: 0, performance: 0, accessibility: 0 },\r\n      wouldRecommend: false\r\n    }\r\n  })\r\n}\r\n\r\n// Watchers\r\nwatch(() => props.isOpen, (isOpen) => {\r\n  if (isOpen) {\r\n    // モーダルが開かれた時の処理\r\n    document.body.style.overflow = 'hidden'\r\n  } else {\r\n    // モーダルが閉じられた時の処理\r\n    document.body.style.overflow = ''\r\n    resetForm()\r\n  }\r\n})\r\n\r\n// Lifecycle\r\nonMounted(() => {\r\n  // 既存のフィードバックサービスが利用可能かチェック\r\n  if (!feedbackService) {\r\n    console.warn('FeedbackManagementService is not available')\r\n  }\r\n})\r\n</script>\r\n\r\n<style scoped>\r\n/* =================================\r\n   モーダルベース\r\n   ================================= */\r\n\r\n.feedback-modal-overlay {\r\n  position: fixed;\r\n  top: 0;\r\n  left: 0;\r\n  right: 0;\r\n  bottom: 0;\r\n  background: rgba(0, 0, 0, 0.8);\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  z-index: 1000;\r\n  padding: var(--space-md);\r\n  backdrop-filter: blur(4px);\r\n}\r\n\r\n.feedback-modal {\r\n  background: var(--bg-primary);\r\n  border-radius: 16px;\r\n  width: 100%;\r\n  max-width: 600px;\r\n  max-height: 90vh;\r\n  overflow-y: auto;\r\n  box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);\r\n  border: 1px solid rgba(129, 140, 248, 0.2);\r\n}\r\n\r\n/* =================================\r\n   ヘッダー\r\n   ================================= */\r\n\r\n.feedback-header {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: space-between;\r\n  padding: var(--space-lg);\r\n  border-bottom: 1px solid rgba(129, 140, 248, 0.2);\r\n  background: rgba(129, 140, 248, 0.05);\r\n}\r\n\r\n.feedback-title {\r\n  font-size: var(--text-xl);\r\n  font-weight: 700;\r\n  color: rgba(129, 140, 248, 1);\r\n  margin: 0;\r\n}\r\n\r\n.close-button {\r\n  background: none;\r\n  border: none;\r\n  color: rgba(255, 255, 255, 0.7);\r\n  cursor: pointer;\r\n  padding: var(--space-xs);\r\n  border-radius: 4px;\r\n  transition: all var(--transition-fast);\r\n}\r\n\r\n.close-button:hover {\r\n  color: rgba(255, 255, 255, 1);\r\n  background: rgba(255, 255, 255, 0.1);\r\n}\r\n\r\n/* =================================\r\n   フィードバック選択\r\n   ================================= */\r\n\r\n.feedback-selection {\r\n  padding: var(--space-lg);\r\n}\r\n\r\n.selection-description {\r\n  color: rgba(255, 255, 255, 0.8);\r\n  margin-bottom: var(--space-lg);\r\n  line-height: 1.6;\r\n}\r\n\r\n.feedback-options {\r\n  display: grid;\r\n  gap: var(--space-md);\r\n}\r\n\r\n.feedback-option-btn {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: var(--space-md);\r\n  padding: var(--space-md);\r\n  background: rgba(255, 255, 255, 0.05);\r\n  border: 2px solid rgba(129, 140, 248, 0.2);\r\n  border-radius: 12px;\r\n  cursor: pointer;\r\n  transition: all var(--transition-normal);\r\n  text-align: left;\r\n  width: 100%;\r\n}\r\n\r\n.feedback-option-btn:hover {\r\n  border-color: rgba(129, 140, 248, 0.5);\r\n  background: rgba(129, 140, 248, 0.1);\r\n  transform: translateY(-2px);\r\n}\r\n\r\n.option-icon {\r\n  width: 48px;\r\n  height: 48px;\r\n  border-radius: 50%;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  font-size: var(--text-xl);\r\n  flex-shrink: 0;\r\n}\r\n\r\n.option-content {\r\n  flex: 1;\r\n}\r\n\r\n.option-title {\r\n  font-size: var(--text-lg);\r\n  font-weight: 600;\r\n  color: rgba(255, 255, 255, 0.95);\r\n  margin: 0 0 var(--space-xs) 0;\r\n}\r\n\r\n.option-description {\r\n  font-size: var(--text-sm);\r\n  color: rgba(255, 255, 255, 0.7);\r\n  margin: 0;\r\n  line-height: 1.4;\r\n}\r\n\r\n/* =================================\r\n   フォーム\r\n   ================================= */\r\n\r\n.feedback-form {\r\n  padding: var(--space-lg);\r\n}\r\n\r\n.form-group {\r\n  margin-bottom: var(--space-lg);\r\n}\r\n\r\n.form-label {\r\n  display: block;\r\n  font-weight: 600;\r\n  color: rgba(255, 255, 255, 0.9);\r\n  margin-bottom: var(--space-sm);\r\n  font-size: var(--text-sm);\r\n}\r\n\r\n.required {\r\n  color: #EF4444;\r\n}\r\n\r\n.form-input,\r\n.form-select,\r\n.form-textarea {\r\n  width: 100%;\r\n  padding: var(--space-sm);\r\n  background: rgba(255, 255, 255, 0.05);\r\n  border: 2px solid rgba(129, 140, 248, 0.2);\r\n  border-radius: 8px;\r\n  color: rgba(255, 255, 255, 0.9);\r\n  font-size: var(--text-sm);\r\n  transition: border-color var(--transition-fast);\r\n}\r\n\r\n.form-input:focus,\r\n.form-select:focus,\r\n.form-textarea:focus {\r\n  outline: none;\r\n  border-color: rgba(129, 140, 248, 0.6);\r\n  background: rgba(255, 255, 255, 0.08);\r\n}\r\n\r\n.form-textarea {\r\n  resize: vertical;\r\n  min-height: 80px;\r\n  font-family: inherit;\r\n}\r\n\r\n.form-checkbox {\r\n  margin-right: var(--space-sm);\r\n  accent-color: rgba(129, 140, 248, 1);\r\n}\r\n\r\n.character-count {\r\n  font-size: var(--text-xs);\r\n  color: rgba(255, 255, 255, 0.5);\r\n  text-align: right;\r\n  margin-top: var(--space-xs);\r\n}\r\n\r\n.form-help {\r\n  font-size: var(--text-xs);\r\n  color: rgba(255, 255, 255, 0.6);\r\n  margin-top: var(--space-xs);\r\n  margin-bottom: 0;\r\n}\r\n\r\n/* =================================\r\n   評価システム\r\n   ================================= */\r\n\r\n.star-rating {\r\n  display: flex;\r\n  gap: var(--space-xs);\r\n  margin-top: var(--space-xs);\r\n}\r\n\r\n.star-button {\r\n  background: none;\r\n  border: none;\r\n  font-size: var(--text-xl);\r\n  color: rgba(255, 255, 255, 0.3);\r\n  cursor: pointer;\r\n  transition: color var(--transition-fast);\r\n  padding: var(--space-xs);\r\n}\r\n\r\n.star-button:hover,\r\n.star-button.active {\r\n  color: #F59E0B;\r\n}\r\n\r\n.aspect-ratings {\r\n  display: grid;\r\n  gap: var(--space-md);\r\n  margin-top: var(--space-md);\r\n}\r\n\r\n.aspect-rating {\r\n  padding: var(--space-sm);\r\n  background: rgba(255, 255, 255, 0.03);\r\n  border-radius: 8px;\r\n}\r\n\r\n/* =================================\r\n   セクション\r\n   ================================= */\r\n\r\n.section-title {\r\n  font-size: var(--text-lg);\r\n  font-weight: 600;\r\n  color: rgba(129, 140, 248, 1);\r\n  margin: 0 0 var(--space-md) 0;\r\n  padding-top: var(--space-lg);\r\n  border-top: 1px solid rgba(129, 140, 248, 0.2);\r\n}\r\n\r\n.submitter-section .section-title {\r\n  border-top: none;\r\n  padding-top: 0;\r\n}\r\n\r\n.contact-fields {\r\n  display: grid;\r\n  gap: var(--space-md);\r\n}\r\n\r\n/* =================================\r\n   アクションボタン\r\n   ================================= */\r\n\r\n.form-actions {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  gap: var(--space-md);\r\n  margin-top: var(--space-xl);\r\n  padding-top: var(--space-lg);\r\n  border-top: 1px solid rgba(129, 140, 248, 0.2);\r\n}\r\n\r\n.btn-primary,\r\n.btn-secondary {\r\n  padding: var(--space-sm) var(--space-lg);\r\n  border-radius: 8px;\r\n  font-weight: 600;\r\n  cursor: pointer;\r\n  transition: all var(--transition-fast);\r\n  border: none;\r\n  font-size: var(--text-sm);\r\n  min-width: 120px;\r\n}\r\n\r\n.btn-primary {\r\n  background: var(--primary-gradient);\r\n  color: white;\r\n}\r\n\r\n.btn-primary:hover:not(:disabled) {\r\n  transform: translateY(-2px);\r\n  box-shadow: 0 8px 25px rgba(129, 140, 248, 0.3);\r\n}\r\n\r\n.btn-primary:disabled {\r\n  opacity: 0.6;\r\n  cursor: not-allowed;\r\n}\r\n\r\n.btn-secondary {\r\n  background: rgba(255, 255, 255, 0.1);\r\n  color: rgba(255, 255, 255, 0.8);\r\n  border: 2px solid rgba(129, 140, 248, 0.3);\r\n}\r\n\r\n.btn-secondary:hover {\r\n  background: rgba(255, 255, 255, 0.15);\r\n  border-color: rgba(129, 140, 248, 0.5);\r\n}\r\n\r\n/* =================================\r\n   成功画面\r\n   ================================= */\r\n\r\n.success-message {\r\n  padding: var(--space-xl);\r\n  text-align: center;\r\n}\r\n\r\n.success-icon {\r\n  font-size: 4rem;\r\n  margin-bottom: var(--space-lg);\r\n}\r\n\r\n.success-title {\r\n  font-size: var(--text-xl);\r\n  font-weight: 700;\r\n  color: rgba(34, 197, 94, 1);\r\n  margin: 0 0 var(--space-md) 0;\r\n}\r\n\r\n.success-description {\r\n  color: rgba(255, 255, 255, 0.8);\r\n  line-height: 1.6;\r\n  margin-bottom: var(--space-xl);\r\n}\r\n\r\n/* =================================\r\n   レスポンシブ\r\n   ================================= */\r\n\r\n@media (max-width: 640px) {\r\n  .feedback-modal-overlay {\r\n    padding: var(--space-sm);\r\n  }\r\n\r\n  .feedback-modal {\r\n    max-height: 95vh;\r\n  }\r\n\r\n  .feedback-header,\r\n  .feedback-selection,\r\n  .feedback-form,\r\n  .success-message {\r\n    padding: var(--space-md);\r\n  }\r\n\r\n  .feedback-options {\r\n    gap: var(--space-sm);\r\n  }\r\n\r\n  .feedback-option-btn {\r\n    flex-direction: column;\r\n    text-align: center;\r\n    gap: var(--space-sm);\r\n  }\r\n\r\n  .contact-fields {\r\n    grid-template-columns: 1fr;\r\n  }\r\n\r\n  .form-actions {\r\n    flex-direction: column;\r\n  }\r\n\r\n  .aspect-ratings {\r\n    gap: var(--space-sm);\r\n  }\r\n}\r\n\r\n/* =================================\r\n   アクセシビリティ\r\n   ================================= */\r\n\r\n@media (prefers-reduced-motion: reduce) {\r\n  .feedback-option-btn,\r\n  .btn-primary,\r\n  .btn-secondary,\r\n  .star-button {\r\n    transition: none;\r\n  }\r\n\r\n  .feedback-option-btn:hover,\r\n  .btn-primary:hover {\r\n    transform: none;\r\n  }\r\n}\r\n\r\n.feedback-modal:focus-within {\r\n  outline: 2px solid rgba(129, 140, 248, 0.8);\r\n  outline-offset: 2px;\r\n}\r\n\r\n.form-input:invalid,\r\n.form-textarea:invalid,\r\n.form-select:invalid {\r\n  border-color: #EF4444;\r\n}\r\n\r\n.form-input:invalid:focus,\r\n.form-textarea:invalid:focus,\r\n.form-select:invalid:focus {\r\n  border-color: #EF4444;\r\n  box-shadow: 0 0 0 3px rgba(239, 68, 68, 0.1);\r\n}\r\n</style>","<template>\r\n  <div class=\"review-system\">\r\n    <!-- クイック評価ボタン -->\r\n    <div v-if=\"mode === 'quick'\" class=\"quick-review\">\r\n      <div class=\"quick-review-header\">\r\n        <h3 class=\"quick-title\">ゲームはいかがでしたか？</h3>\r\n        <p class=\"quick-subtitle\">簡単な評価をお聞かせください</p>\r\n      </div>\r\n      \r\n      <div class=\"quick-actions\">\r\n        <button\r\n          v-for=\"rating in quickRatings\"\r\n          :key=\"rating.value\"\r\n          @click=\"submitQuickRating(rating.value)\"\r\n          class=\"quick-rating-btn\"\r\n          :class=\"{ selected: selectedQuickRating === rating.value }\"\r\n          :aria-label=\"`${rating.label} - ${rating.description}`\"\r\n        >\r\n          <div class=\"rating-emoji\">{{ rating.emoji }}</div>\r\n          <div class=\"rating-label\">{{ rating.label }}</div>\r\n        </button>\r\n      </div>\r\n      \r\n      <button \r\n        @click=\"expandToFullReview\" \r\n        class=\"expand-btn\"\r\n        :disabled=\"!selectedQuickRating\"\r\n      >\r\n        詳細な評価を書く\r\n      </button>\r\n    </div>\r\n\r\n    <!-- 詳細レビューフォーム -->\r\n    <div v-else class=\"detailed-review\">\r\n      <div class=\"review-header\">\r\n        <h3 class=\"review-title\">詳細レビュー</h3>\r\n        <p class=\"review-subtitle\">あなたの体験をお聞かせください</p>\r\n      </div>\r\n\r\n      <form @submit.prevent=\"submitDetailedReview\" class=\"review-form\">\r\n        <!-- 総合評価 -->\r\n        <div class=\"rating-section\">\r\n          <h4 class=\"section-title\">総合評価</h4>\r\n          <div class=\"star-rating-container\">\r\n            <div class=\"star-rating\">\r\n              <button\r\n                v-for=\"star in 5\"\r\n                :key=\"star\"\r\n                type=\"button\"\r\n                @click=\"setOverallRating(star)\"\r\n                @mouseover=\"hoverOverallRating = star\"\r\n                @mouseleave=\"hoverOverallRating = 0\"\r\n                class=\"star-button\"\r\n                :class=\"{ \r\n                  active: overallRating >= star,\r\n                  hover: hoverOverallRating >= star && hoverOverallRating > overallRating\r\n                }\"\r\n                :aria-label=\"`${star} 星評価`\"\r\n              >\r\n                ★\r\n              </button>\r\n            </div>\r\n            <div class=\"rating-description\">\r\n              {{ getRatingDescription(hoverOverallRating || overallRating) }}\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <!-- 項目別評価 -->\r\n        <div class=\"aspect-ratings-section\">\r\n          <h4 class=\"section-title\">項目別評価</h4>\r\n          <div class=\"aspect-grid\">\r\n            <div \r\n              v-for=\"aspect in aspectRatings\" \r\n              :key=\"aspect.key\"\r\n              class=\"aspect-item\"\r\n            >\r\n              <div class=\"aspect-header\">\r\n                <div class=\"aspect-icon\">{{ aspect.icon }}</div>\r\n                <div class=\"aspect-info\">\r\n                  <h5 class=\"aspect-title\">{{ aspect.title }}</h5>\r\n                  <p class=\"aspect-description\">{{ aspect.description }}</p>\r\n                </div>\r\n              </div>\r\n              <div class=\"aspect-rating\">\r\n                <div class=\"star-rating small\">\r\n                  <button\r\n                    v-for=\"star in 5\"\r\n                    :key=\"star\"\r\n                    type=\"button\"\r\n                    @click=\"setAspectRating(aspect.key, star)\"\r\n                    class=\"star-button\"\r\n                    :class=\"{ active: aspectRatingsData[aspect.key] >= star }\"\r\n                    :aria-label=\"`${aspect.title} ${star} 星評価`\"\r\n                  >\r\n                    ★\r\n                  </button>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <!-- コメント -->\r\n        <div class=\"comment-section\">\r\n          <h4 class=\"section-title\">コメント</h4>\r\n          <div class=\"comment-prompts\">\r\n            <button\r\n              v-for=\"prompt in commentPrompts\"\r\n              :key=\"prompt.id\"\r\n              type=\"button\"\r\n              @click=\"selectCommentPrompt(prompt)\"\r\n              class=\"prompt-btn\"\r\n              :class=\"{ selected: selectedPrompt?.id === prompt.id }\"\r\n            >\r\n              {{ prompt.text }}\r\n            </button>\r\n          </div>\r\n          <textarea\r\n            v-model=\"reviewComment\"\r\n            class=\"comment-textarea\"\r\n            :placeholder=\"selectedPrompt?.placeholder || '自由にご感想をお聞かせください...'\"\r\n            rows=\"4\"\r\n            maxlength=\"500\"\r\n          ></textarea>\r\n          <div class=\"character-count\">{{ reviewComment.length }}/500</div>\r\n        </div>\r\n\r\n        <!-- 推奨度 -->\r\n        <div class=\"recommendation-section\">\r\n          <h4 class=\"section-title\">推奨度</h4>\r\n          <p class=\"section-description\">このゲームを友人におすすめしますか？</p>\r\n          <div class=\"recommendation-scale\">\r\n            <div class=\"scale-labels\">\r\n              <span class=\"scale-label\">おすすめしない</span>\r\n              <span class=\"scale-label\">おすすめする</span>\r\n            </div>\r\n            <div class=\"scale-track\">\r\n              <input\r\n                type=\"range\"\r\n                v-model=\"recommendationScore\"\r\n                min=\"0\"\r\n                max=\"10\"\r\n                step=\"1\"\r\n                class=\"scale-slider\"\r\n                :aria-label=\"`推奨度 ${recommendationScore} 点`\"\r\n              />\r\n              <div class=\"scale-markers\">\r\n                <div \r\n                  v-for=\"n in 11\" \r\n                  :key=\"n-1\"\r\n                  class=\"scale-marker\"\r\n                  :class=\"{ active: recommendationScore >= n-1 }\"\r\n                ></div>\r\n              </div>\r\n            </div>\r\n            <div class=\"scale-value\">{{ recommendationScore }}/10</div>\r\n          </div>\r\n        </div>\r\n\r\n        <!-- タグ選択 -->\r\n        <div class=\"tags-section\">\r\n          <h4 class=\"section-title\">印象的だった要素</h4>\r\n          <p class=\"section-description\">当てはまるものを選択してください（複数選択可）</p>\r\n          <div class=\"tags-grid\">\r\n            <button\r\n              v-for=\"tag in availableTags\"\r\n              :key=\"tag.id\"\r\n              type=\"button\"\r\n              @click=\"toggleTag(tag.id)\"\r\n              class=\"tag-button\"\r\n              :class=\"{ selected: selectedTags.includes(tag.id) }\"\r\n            >\r\n              <span class=\"tag-icon\">{{ tag.icon }}</span>\r\n              <span class=\"tag-label\">{{ tag.label }}</span>\r\n            </button>\r\n          </div>\r\n        </div>\r\n\r\n        <!-- プレイ時間（任意） -->\r\n        <div class=\"playtime-section\">\r\n          <h4 class=\"section-title\">プレイ時間</h4>\r\n          <div class=\"playtime-options\">\r\n            <button\r\n              v-for=\"option in playtimeOptions\"\r\n              :key=\"option.value\"\r\n              type=\"button\"\r\n              @click=\"selectedPlaytime = option.value\"\r\n              class=\"playtime-btn\"\r\n              :class=\"{ selected: selectedPlaytime === option.value }\"\r\n            >\r\n              {{ option.label }}\r\n            </button>\r\n          </div>\r\n        </div>\r\n\r\n        <!-- 送信ボタン -->\r\n        <div class=\"form-actions\">\r\n          <button\r\n            type=\"button\"\r\n            @click=\"switchToQuickMode\"\r\n            class=\"btn-secondary\"\r\n          >\r\n            簡易モードに戻る\r\n          </button>\r\n          <button\r\n            type=\"submit\"\r\n            class=\"btn-primary\"\r\n            :disabled=\"!isFormValid || isSubmitting\"\r\n          >\r\n            <span v-if=\"isSubmitting\">送信中...</span>\r\n            <span v-else>レビューを送信</span>\r\n          </button>\r\n        </div>\r\n      </form>\r\n    </div>\r\n\r\n    <!-- 送信完了メッセージ -->\r\n    <div v-if=\"showSuccessMessage\" class=\"success-overlay\">\r\n      <div class=\"success-content\">\r\n        <div class=\"success-icon\">🎉</div>\r\n        <h3 class=\"success-title\">レビューをありがとうございます！</h3>\r\n        <p class=\"success-message\">\r\n          あなたの貴重な意見がゲームの改善に役立ちます。\r\n        </p>\r\n        <button @click=\"closeSuccessMessage\" class=\"btn-primary\">\r\n          閉じる\r\n        </button>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup lang=\"ts\">\r\nimport { ref, reactive, computed, watch } from 'vue'\r\nimport { FeedbackManagementService } from '../../domain/services/FeedbackManagementService'\r\nimport type { SatisfactionRating } from '../../domain/entities/Feedback'\r\n\r\n// Props & Emits\r\ninterface Props {\r\n  mode?: 'quick' | 'detailed'\r\n  gameState?: {\r\n    stage: string\r\n    turn: number\r\n    vitality: number\r\n    phase: string\r\n  }\r\n}\r\n\r\nconst props = withDefaults(defineProps<Props>(), {\r\n  mode: 'quick'\r\n})\r\n\r\nconst emit = defineEmits<{\r\n  reviewSubmitted: [reviewId: string]\r\n  modeChanged: [mode: 'quick' | 'detailed']\r\n}>()\r\n\r\n// Services\r\nconst feedbackService = new FeedbackManagementService()\r\n\r\n// State\r\nconst currentMode = ref<'quick' | 'detailed'>(props.mode)\r\nconst selectedQuickRating = ref<number>(0)\r\nconst hoverOverallRating = ref<number>(0)\r\nconst overallRating = ref<number>(0)\r\nconst reviewComment = ref<string>('')\r\nconst recommendationScore = ref<number>(5)\r\nconst selectedPlaytime = ref<string>('')\r\nconst selectedTags = ref<string[]>([])\r\nconst selectedPrompt = ref<any>(null)\r\nconst isSubmitting = ref(false)\r\nconst showSuccessMessage = ref(false)\r\n\r\n// 項目別評価データ\r\nconst aspectRatingsData = reactive({\r\n  gameplay: 0,\r\n  ui: 0,\r\n  performance: 0,\r\n  accessibility: 0\r\n})\r\n\r\n// クイック評価オプション\r\nconst quickRatings = [\r\n  {\r\n    value: 1,\r\n    label: 'いまいち',\r\n    emoji: '😞',\r\n    description: '期待に届かなかった'\r\n  },\r\n  {\r\n    value: 2,\r\n    label: 'まあまあ',\r\n    emoji: '😐',\r\n    description: '普通の出来'\r\n  },\r\n  {\r\n    value: 3,\r\n    label: 'よかった',\r\n    emoji: '😊',\r\n    description: '楽しめた'\r\n  },\r\n  {\r\n    value: 4,\r\n    label: 'とてもよかった',\r\n    emoji: '😄',\r\n    description: '大いに楽しめた'\r\n  },\r\n  {\r\n    value: 5,\r\n    label: '最高だった',\r\n    emoji: '🤩',\r\n    description: '期待を大きく上回った'\r\n  }\r\n]\r\n\r\n// 項目別評価\r\nconst aspectRatings = [\r\n  {\r\n    key: 'gameplay',\r\n    title: 'ゲームプレイ',\r\n    description: '面白さ・戦略性',\r\n    icon: '🎮'\r\n  },\r\n  {\r\n    key: 'ui',\r\n    title: 'UI・操作性',\r\n    description: '使いやすさ・直感性',\r\n    icon: '🖱️'\r\n  },\r\n  {\r\n    key: 'performance',\r\n    title: 'パフォーマンス',\r\n    description: '動作の軽さ・安定性',\r\n    icon: '⚡'\r\n  },\r\n  {\r\n    key: 'accessibility',\r\n    title: 'アクセシビリティ',\r\n    description: '利用しやすさ・配慮',\r\n    icon: '♿'\r\n  }\r\n]\r\n\r\n// コメントプロンプト\r\nconst commentPrompts = [\r\n  {\r\n    id: 'liked',\r\n    text: '特に良かった点',\r\n    placeholder: 'どの部分が特に気に入りましたか？具体的にお聞かせください。'\r\n  },\r\n  {\r\n    id: 'improvement',\r\n    text: '改善してほしい点',\r\n    placeholder: 'どの部分を改善すればより良くなると思いますか？'\r\n  },\r\n  {\r\n    id: 'feature',\r\n    text: '追加してほしい機能',\r\n    placeholder: 'どのような機能があると更に楽しめると思いますか？'\r\n  },\r\n  {\r\n    id: 'general',\r\n    text: '全体的な感想',\r\n    placeholder: 'ゲーム全体を通しての感想をお聞かせください。'\r\n  }\r\n]\r\n\r\n// タグオプション\r\nconst availableTags = [\r\n  { id: 'addictive', label: 'ハマる', icon: '🎯' },\r\n  { id: 'relaxing', label: 'リラックス', icon: '😌' },\r\n  { id: 'challenging', label: 'やりがい', icon: '💪' },\r\n  { id: 'educational', label: '学びになる', icon: '📚' },\r\n  { id: 'innovative', label: '斬新', icon: '💡' },\r\n  { id: 'beautiful', label: '美しい', icon: '🎨' },\r\n  { id: 'intuitive', label: '直感的', icon: '👆' },\r\n  { id: 'immersive', label: '没入感', icon: '🌟' }\r\n]\r\n\r\n// プレイ時間オプション\r\nconst playtimeOptions = [\r\n  { value: '< 30min', label: '30分未満' },\r\n  { value: '30min - 1h', label: '30分〜1時間' },\r\n  { value: '1h - 2h', label: '1〜2時間' },\r\n  { value: '2h - 5h', label: '2〜5時間' },\r\n  { value: '5h+', label: '5時間以上' }\r\n]\r\n\r\n// Computed\r\nconst isFormValid = computed(() => {\r\n  return overallRating.value > 0 && reviewComment.value.trim().length > 0\r\n})\r\n\r\n// Methods\r\nconst submitQuickRating = async (rating: number) => {\r\n  selectedQuickRating.value = rating\r\n  \r\n  try {\r\n    const feedback = await feedbackService.createReview({\r\n      title: `クイック評価: ${quickRatings.find(r => r.value === rating)?.label}`,\r\n      description: `ユーザーからの ${rating} 星評価`,\r\n      submitter: {\r\n        isAnonymous: true,\r\n        userAgent: navigator.userAgent,\r\n        sessionId: generateSessionId()\r\n      },\r\n      systemInfo: {\r\n        userAgent: navigator.userAgent,\r\n        screenResolution: `${screen.width}x${screen.height}`,\r\n        viewport: `${window.innerWidth}x${window.innerHeight}`,\r\n        gameVersion: '0.2.7',\r\n        timestamp: new Date(),\r\n        gameState: props.gameState\r\n      },\r\n      reviewData: {\r\n        overallRating: rating as SatisfactionRating,\r\n        aspects: {\r\n          gameplay: rating as SatisfactionRating,\r\n          ui: rating as SatisfactionRating,\r\n          performance: rating as SatisfactionRating,\r\n          accessibility: rating as SatisfactionRating\r\n        },\r\n        wouldRecommend: rating >= 4\r\n      }\r\n    })\r\n    \r\n    showSuccessMessage.value = true\r\n    emit('reviewSubmitted', feedback.id)\r\n  } catch (error) {\r\n    console.error('Failed to submit quick rating:', error)\r\n    alert('評価の送信に失敗しました。')\r\n  }\r\n}\r\n\r\nconst expandToFullReview = () => {\r\n  if (selectedQuickRating.value > 0) {\r\n    overallRating.value = selectedQuickRating.value\r\n    Object.keys(aspectRatingsData).forEach(key => {\r\n      aspectRatingsData[key as keyof typeof aspectRatingsData] = selectedQuickRating.value\r\n    })\r\n    recommendationScore.value = selectedQuickRating.value >= 4 ? 8 : 4\r\n  }\r\n  currentMode.value = 'detailed'\r\n  emit('modeChanged', 'detailed')\r\n}\r\n\r\nconst switchToQuickMode = () => {\r\n  currentMode.value = 'quick'\r\n  emit('modeChanged', 'quick')\r\n}\r\n\r\nconst setOverallRating = (rating: number) => {\r\n  overallRating.value = rating\r\n}\r\n\r\nconst setAspectRating = (aspect: string, rating: number) => {\r\n  aspectRatingsData[aspect as keyof typeof aspectRatingsData] = rating\r\n}\r\n\r\nconst selectCommentPrompt = (prompt: any) => {\r\n  selectedPrompt.value = selectedPrompt.value?.id === prompt.id ? null : prompt\r\n}\r\n\r\nconst toggleTag = (tagId: string) => {\r\n  const index = selectedTags.value.indexOf(tagId)\r\n  if (index > -1) {\r\n    selectedTags.value.splice(index, 1)\r\n  } else {\r\n    selectedTags.value.push(tagId)\r\n  }\r\n}\r\n\r\nconst submitDetailedReview = async () => {\r\n  if (!isFormValid.value || isSubmitting.value) return\r\n\r\n  isSubmitting.value = true\r\n\r\n  try {\r\n    const feedback = await feedbackService.createReview({\r\n      title: `詳細レビュー: ${getRatingDescription(overallRating.value)}`,\r\n      description: reviewComment.value.trim(),\r\n      submitter: {\r\n        isAnonymous: true,\r\n        userAgent: navigator.userAgent,\r\n        sessionId: generateSessionId()\r\n      },\r\n      systemInfo: {\r\n        userAgent: navigator.userAgent,\r\n        screenResolution: `${screen.width}x${screen.height}`,\r\n        viewport: `${window.innerWidth}x${window.innerHeight}`,\r\n        gameVersion: '0.2.7',\r\n        timestamp: new Date(),\r\n        gameState: props.gameState\r\n      },\r\n      reviewData: {\r\n        overallRating: overallRating.value as SatisfactionRating,\r\n        aspects: {\r\n          gameplay: aspectRatingsData.gameplay as SatisfactionRating,\r\n          ui: aspectRatingsData.ui as SatisfactionRating,\r\n          performance: aspectRatingsData.performance as SatisfactionRating,\r\n          accessibility: aspectRatingsData.accessibility as SatisfactionRating\r\n        },\r\n        wouldRecommend: recommendationScore.value >= 6,\r\n        playTime: getPlayTimeInMinutes()\r\n      },\r\n      tags: [\r\n        'detailed-review',\r\n        ...selectedTags.value,\r\n        `recommendation-${recommendationScore.value}`,\r\n        selectedPlaytime.value ? `playtime-${selectedPlaytime.value}` : ''\r\n      ].filter(Boolean)\r\n    })\r\n\r\n    showSuccessMessage.value = true\r\n    emit('reviewSubmitted', feedback.id)\r\n  } catch (error) {\r\n    console.error('Failed to submit detailed review:', error)\r\n    alert('レビューの送信に失敗しました。')\r\n  } finally {\r\n    isSubmitting.value = false\r\n  }\r\n}\r\n\r\nconst closeSuccessMessage = () => {\r\n  showSuccessMessage.value = false\r\n  resetForm()\r\n}\r\n\r\nconst resetForm = () => {\r\n  selectedQuickRating.value = 0\r\n  overallRating.value = 0\r\n  reviewComment.value = ''\r\n  recommendationScore.value = 5\r\n  selectedPlaytime.value = ''\r\n  selectedTags.value = []\r\n  selectedPrompt.value = null\r\n  Object.keys(aspectRatingsData).forEach(key => {\r\n    aspectRatingsData[key as keyof typeof aspectRatingsData] = 0\r\n  })\r\n}\r\n\r\nconst getRatingDescription = (rating: number): string => {\r\n  const descriptions = [\r\n    '',\r\n    '改善が必要',\r\n    'まあまあ',\r\n    '良い',\r\n    'とても良い',\r\n    '素晴らしい'\r\n  ]\r\n  return descriptions[rating] || ''\r\n}\r\n\r\nconst generateSessionId = (): string => {\r\n  return `review_${  Date.now()  }_${  Math.random().toString(36).substr(2, 9)}`\r\n}\r\n\r\nconst getPlayTimeInMinutes = (): number => {\r\n  const playtimeMap: Record<string, number> = {\r\n    '< 30min': 15,\r\n    '30min - 1h': 45,\r\n    '1h - 2h': 90,\r\n    '2h - 5h': 210,\r\n    '5h+': 360\r\n  }\r\n  return playtimeMap[selectedPlaytime.value] || 0\r\n}\r\n\r\n// Watchers\r\nwatch(() => props.mode, (newMode) => {\r\n  currentMode.value = newMode\r\n})\r\n</script>\r\n\r\n<style scoped>\r\n/* =================================\r\n   レビューシステムベース\r\n   ================================= */\r\n\r\n.review-system {\r\n  position: relative;\r\n  background: rgba(255, 255, 255, 0.05);\r\n  border-radius: 16px;\r\n  padding: var(--space-lg);\r\n  border: 1px solid rgba(129, 140, 248, 0.2);\r\n}\r\n\r\n/* =================================\r\n   クイックレビュー\r\n   ================================= */\r\n\r\n.quick-review-header {\r\n  text-align: center;\r\n  margin-bottom: var(--space-xl);\r\n}\r\n\r\n.quick-title {\r\n  font-size: var(--text-xl);\r\n  font-weight: 700;\r\n  color: rgba(255, 255, 255, 0.95);\r\n  margin: 0 0 var(--space-sm) 0;\r\n}\r\n\r\n.quick-subtitle {\r\n  color: rgba(255, 255, 255, 0.7);\r\n  margin: 0;\r\n}\r\n\r\n.quick-actions {\r\n  display: flex;\r\n  justify-content: center;\r\n  gap: var(--space-md);\r\n  margin-bottom: var(--space-xl);\r\n  flex-wrap: wrap;\r\n}\r\n\r\n.quick-rating-btn {\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  gap: var(--space-sm);\r\n  padding: var(--space-md);\r\n  background: rgba(255, 255, 255, 0.05);\r\n  border: 2px solid rgba(129, 140, 248, 0.2);\r\n  border-radius: 12px;\r\n  cursor: pointer;\r\n  transition: all var(--transition-normal);\r\n  min-width: 80px;\r\n}\r\n\r\n.quick-rating-btn:hover,\r\n.quick-rating-btn.selected {\r\n  border-color: rgba(129, 140, 248, 0.6);\r\n  background: rgba(129, 140, 248, 0.1);\r\n  transform: translateY(-2px);\r\n}\r\n\r\n.rating-emoji {\r\n  font-size: 2rem;\r\n  line-height: 1;\r\n}\r\n\r\n.rating-label {\r\n  font-size: var(--text-sm);\r\n  font-weight: 600;\r\n  color: rgba(255, 255, 255, 0.9);\r\n}\r\n\r\n.expand-btn {\r\n  display: block;\r\n  margin: 0 auto;\r\n  padding: var(--space-sm) var(--space-lg);\r\n  background: var(--primary-gradient);\r\n  color: white;\r\n  border: none;\r\n  border-radius: 8px;\r\n  font-weight: 600;\r\n  cursor: pointer;\r\n  transition: all var(--transition-fast);\r\n}\r\n\r\n.expand-btn:disabled {\r\n  opacity: 0.5;\r\n  cursor: not-allowed;\r\n}\r\n\r\n.expand-btn:hover:not(:disabled) {\r\n  transform: translateY(-2px);\r\n  box-shadow: 0 8px 25px rgba(129, 140, 248, 0.3);\r\n}\r\n\r\n/* =================================\r\n   詳細レビュー\r\n   ================================= */\r\n\r\n.review-header {\r\n  text-align: center;\r\n  margin-bottom: var(--space-xl);\r\n}\r\n\r\n.review-title {\r\n  font-size: var(--text-xl);\r\n  font-weight: 700;\r\n  color: rgba(129, 140, 248, 1);\r\n  margin: 0 0 var(--space-sm) 0;\r\n}\r\n\r\n.review-subtitle {\r\n  color: rgba(255, 255, 255, 0.7);\r\n  margin: 0;\r\n}\r\n\r\n.review-form {\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: var(--space-xl);\r\n}\r\n\r\n/* =================================\r\n   セクション共通\r\n   ================================= */\r\n\r\n.section-title {\r\n  font-size: var(--text-lg);\r\n  font-weight: 600;\r\n  color: rgba(255, 255, 255, 0.95);\r\n  margin: 0 0 var(--space-md) 0;\r\n}\r\n\r\n.section-description {\r\n  color: rgba(255, 255, 255, 0.7);\r\n  font-size: var(--text-sm);\r\n  margin: 0 0 var(--space-md) 0;\r\n}\r\n\r\n/* =================================\r\n   評価セクション\r\n   ================================= */\r\n\r\n.star-rating-container {\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  gap: var(--space-md);\r\n}\r\n\r\n.star-rating {\r\n  display: flex;\r\n  gap: var(--space-sm);\r\n  justify-content: center;\r\n}\r\n\r\n.star-rating.small {\r\n  gap: var(--space-xs);\r\n}\r\n\r\n.star-button {\r\n  background: none;\r\n  border: none;\r\n  font-size: var(--text-2xl);\r\n  color: rgba(255, 255, 255, 0.3);\r\n  cursor: pointer;\r\n  transition: all var(--transition-fast);\r\n  padding: var(--space-xs);\r\n}\r\n\r\n.star-rating.small .star-button {\r\n  font-size: var(--text-lg);\r\n}\r\n\r\n.star-button:hover,\r\n.star-button.active,\r\n.star-button.hover {\r\n  color: #F59E0B;\r\n  transform: scale(1.1);\r\n}\r\n\r\n.rating-description {\r\n  font-size: var(--text-sm);\r\n  color: rgba(255, 255, 255, 0.8);\r\n  font-weight: 600;\r\n  min-height: 20px;\r\n}\r\n\r\n/* =================================\r\n   項目別評価\r\n   ================================= */\r\n\r\n.aspect-grid {\r\n  display: grid;\r\n  gap: var(--space-md);\r\n}\r\n\r\n.aspect-item {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: space-between;\r\n  padding: var(--space-md);\r\n  background: rgba(255, 255, 255, 0.03);\r\n  border-radius: 8px;\r\n  border: 1px solid rgba(129, 140, 248, 0.1);\r\n}\r\n\r\n.aspect-header {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: var(--space-md);\r\n  flex: 1;\r\n}\r\n\r\n.aspect-icon {\r\n  font-size: var(--text-xl);\r\n  width: 40px;\r\n  text-align: center;\r\n}\r\n\r\n.aspect-info {\r\n  flex: 1;\r\n}\r\n\r\n.aspect-title {\r\n  font-size: var(--text-base);\r\n  font-weight: 600;\r\n  color: rgba(255, 255, 255, 0.9);\r\n  margin: 0 0 var(--space-xs) 0;\r\n}\r\n\r\n.aspect-description {\r\n  font-size: var(--text-sm);\r\n  color: rgba(255, 255, 255, 0.6);\r\n  margin: 0;\r\n}\r\n\r\n/* =================================\r\n   コメントセクション\r\n   ================================= */\r\n\r\n.comment-prompts {\r\n  display: flex;\r\n  gap: var(--space-sm);\r\n  margin-bottom: var(--space-md);\r\n  flex-wrap: wrap;\r\n}\r\n\r\n.prompt-btn {\r\n  padding: var(--space-xs) var(--space-sm);\r\n  background: rgba(255, 255, 255, 0.05);\r\n  border: 1px solid rgba(129, 140, 248, 0.3);\r\n  border-radius: 20px;\r\n  color: rgba(255, 255, 255, 0.8);\r\n  cursor: pointer;\r\n  transition: all var(--transition-fast);\r\n  font-size: var(--text-sm);\r\n}\r\n\r\n.prompt-btn:hover,\r\n.prompt-btn.selected {\r\n  background: rgba(129, 140, 248, 0.2);\r\n  border-color: rgba(129, 140, 248, 0.6);\r\n  color: rgba(255, 255, 255, 0.95);\r\n}\r\n\r\n.comment-textarea {\r\n  width: 100%;\r\n  padding: var(--space-md);\r\n  background: rgba(255, 255, 255, 0.05);\r\n  border: 2px solid rgba(129, 140, 248, 0.2);\r\n  border-radius: 8px;\r\n  color: rgba(255, 255, 255, 0.9);\r\n  font-family: inherit;\r\n  font-size: var(--text-sm);\r\n  resize: vertical;\r\n  min-height: 100px;\r\n}\r\n\r\n.comment-textarea:focus {\r\n  outline: none;\r\n  border-color: rgba(129, 140, 248, 0.6);\r\n  background: rgba(255, 255, 255, 0.08);\r\n}\r\n\r\n.character-count {\r\n  text-align: right;\r\n  font-size: var(--text-xs);\r\n  color: rgba(255, 255, 255, 0.5);\r\n  margin-top: var(--space-xs);\r\n}\r\n\r\n/* =================================\r\n   推奨度セクション\r\n   ================================= */\r\n\r\n.recommendation-scale {\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: var(--space-sm);\r\n}\r\n\r\n.scale-labels {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  font-size: var(--text-sm);\r\n  color: rgba(255, 255, 255, 0.7);\r\n}\r\n\r\n.scale-track {\r\n  position: relative;\r\n  padding: var(--space-sm) 0;\r\n}\r\n\r\n.scale-slider {\r\n  width: 100%;\r\n  height: 6px;\r\n  background: rgba(255, 255, 255, 0.1);\r\n  border-radius: 3px;\r\n  outline: none;\r\n  appearance: none;\r\n  cursor: pointer;\r\n}\r\n\r\n.scale-slider::-webkit-slider-thumb {\r\n  width: 20px;\r\n  height: 20px;\r\n  background: var(--primary-gradient);\r\n  border-radius: 50%;\r\n  cursor: pointer;\r\n  appearance: none;\r\n  border: 2px solid white;\r\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);\r\n}\r\n\r\n.scale-markers {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  position: absolute;\r\n  top: 0;\r\n  left: 0;\r\n  right: 0;\r\n  height: 6px;\r\n  pointer-events: none;\r\n}\r\n\r\n.scale-marker {\r\n  width: 2px;\r\n  height: 6px;\r\n  background: rgba(255, 255, 255, 0.3);\r\n  border-radius: 1px;\r\n}\r\n\r\n.scale-marker.active {\r\n  background: rgba(129, 140, 248, 0.8);\r\n}\r\n\r\n.scale-value {\r\n  text-align: center;\r\n  font-size: var(--text-lg);\r\n  font-weight: 600;\r\n  color: rgba(129, 140, 248, 1);\r\n}\r\n\r\n/* =================================\r\n   タグセクション\r\n   ================================= */\r\n\r\n.tags-grid {\r\n  display: grid;\r\n  grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));\r\n  gap: var(--space-sm);\r\n}\r\n\r\n.tag-button {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: var(--space-sm);\r\n  padding: var(--space-sm);\r\n  background: rgba(255, 255, 255, 0.05);\r\n  border: 2px solid rgba(129, 140, 248, 0.2);\r\n  border-radius: 8px;\r\n  cursor: pointer;\r\n  transition: all var(--transition-fast);\r\n  font-size: var(--text-sm);\r\n  color: rgba(255, 255, 255, 0.8);\r\n}\r\n\r\n.tag-button:hover,\r\n.tag-button.selected {\r\n  border-color: rgba(129, 140, 248, 0.6);\r\n  background: rgba(129, 140, 248, 0.1);\r\n  color: rgba(255, 255, 255, 0.95);\r\n}\r\n\r\n.tag-icon {\r\n  font-size: var(--text-base);\r\n}\r\n\r\n/* =================================\r\n   プレイ時間セクション\r\n   ================================= */\r\n\r\n.playtime-options {\r\n  display: flex;\r\n  gap: var(--space-sm);\r\n  flex-wrap: wrap;\r\n}\r\n\r\n.playtime-btn {\r\n  padding: var(--space-sm) var(--space-md);\r\n  background: rgba(255, 255, 255, 0.05);\r\n  border: 2px solid rgba(129, 140, 248, 0.2);\r\n  border-radius: 20px;\r\n  color: rgba(255, 255, 255, 0.8);\r\n  cursor: pointer;\r\n  transition: all var(--transition-fast);\r\n  font-size: var(--text-sm);\r\n}\r\n\r\n.playtime-btn:hover,\r\n.playtime-btn.selected {\r\n  border-color: rgba(129, 140, 248, 0.6);\r\n  background: rgba(129, 140, 248, 0.1);\r\n  color: rgba(255, 255, 255, 0.95);\r\n}\r\n\r\n/* =================================\r\n   フォームアクション\r\n   ================================= */\r\n\r\n.form-actions {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  gap: var(--space-md);\r\n  margin-top: var(--space-xl);\r\n  padding-top: var(--space-lg);\r\n  border-top: 1px solid rgba(129, 140, 248, 0.2);\r\n}\r\n\r\n.btn-primary,\r\n.btn-secondary {\r\n  padding: var(--space-sm) var(--space-lg);\r\n  border-radius: 8px;\r\n  font-weight: 600;\r\n  cursor: pointer;\r\n  transition: all var(--transition-fast);\r\n  border: none;\r\n  font-size: var(--text-sm);\r\n  min-width: 120px;\r\n}\r\n\r\n.btn-primary {\r\n  background: var(--primary-gradient);\r\n  color: white;\r\n}\r\n\r\n.btn-primary:hover:not(:disabled) {\r\n  transform: translateY(-2px);\r\n  box-shadow: 0 8px 25px rgba(129, 140, 248, 0.3);\r\n}\r\n\r\n.btn-primary:disabled {\r\n  opacity: 0.6;\r\n  cursor: not-allowed;\r\n}\r\n\r\n.btn-secondary {\r\n  background: rgba(255, 255, 255, 0.1);\r\n  color: rgba(255, 255, 255, 0.8);\r\n  border: 2px solid rgba(129, 140, 248, 0.3);\r\n}\r\n\r\n.btn-secondary:hover {\r\n  background: rgba(255, 255, 255, 0.15);\r\n  border-color: rgba(129, 140, 248, 0.5);\r\n}\r\n\r\n/* =================================\r\n   成功メッセージ\r\n   ================================= */\r\n\r\n.success-overlay {\r\n  position: absolute;\r\n  top: 0;\r\n  left: 0;\r\n  right: 0;\r\n  bottom: 0;\r\n  background: rgba(0, 0, 0, 0.8);\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  border-radius: 16px;\r\n  backdrop-filter: blur(4px);\r\n}\r\n\r\n.success-content {\r\n  text-align: center;\r\n  padding: var(--space-xl);\r\n  background: var(--bg-primary);\r\n  border-radius: 12px;\r\n  border: 2px solid rgba(34, 197, 94, 0.3);\r\n  max-width: 400px;\r\n}\r\n\r\n.success-icon {\r\n  font-size: 3rem;\r\n  margin-bottom: var(--space-md);\r\n}\r\n\r\n.success-title {\r\n  font-size: var(--text-xl);\r\n  font-weight: 700;\r\n  color: rgba(34, 197, 94, 1);\r\n  margin: 0 0 var(--space-md) 0;\r\n}\r\n\r\n.success-message {\r\n  color: rgba(255, 255, 255, 0.8);\r\n  line-height: 1.6;\r\n  margin-bottom: var(--space-xl);\r\n}\r\n\r\n/* =================================\r\n   レスポンシブ\r\n   ================================= */\r\n\r\n@media (max-width: 768px) {\r\n  .quick-actions {\r\n    flex-direction: column;\r\n    align-items: center;\r\n  }\r\n\r\n  .quick-rating-btn {\r\n    width: 100%;\r\n    max-width: 200px;\r\n    flex-direction: row;\r\n    justify-content: center;\r\n  }\r\n\r\n  .aspect-item {\r\n    flex-direction: column;\r\n    gap: var(--space-md);\r\n    text-align: center;\r\n  }\r\n\r\n  .tags-grid {\r\n    grid-template-columns: 1fr;\r\n  }\r\n\r\n  .playtime-options {\r\n    flex-direction: column;\r\n  }\r\n\r\n  .form-actions {\r\n    flex-direction: column;\r\n  }\r\n}\r\n\r\n@media (max-width: 480px) {\r\n  .review-system {\r\n    padding: var(--space-md);\r\n  }\r\n\r\n  .comment-prompts {\r\n    flex-direction: column;\r\n  }\r\n\r\n  .scale-labels {\r\n    font-size: var(--text-xs);\r\n  }\r\n}\r\n\r\n/* =================================\r\n   アクセシビリティ\r\n   ================================= */\r\n\r\n@media (prefers-reduced-motion: reduce) {\r\n  .quick-rating-btn,\r\n  .tag-button,\r\n  .playtime-btn,\r\n  .star-button {\r\n    transition: none;\r\n  }\r\n\r\n  .quick-rating-btn:hover,\r\n  .star-button:hover {\r\n    transform: none;\r\n  }\r\n}\r\n\r\n.review-system:focus-within {\r\n  outline: 2px solid rgba(129, 140, 248, 0.8);\r\n  outline-offset: 2px;\r\n}\r\n</style>","<template>\r\n  <div class=\"bug-reporter\">\r\n    <!-- ヘッダー -->\r\n    <div class=\"bug-reporter-header\">\r\n      <div class=\"header-icon\">🐛</div>\r\n      <div class=\"header-content\">\r\n        <h3 class=\"header-title\">バグレポート</h3>\r\n        <p class=\"header-subtitle\">\r\n          問題の詳細を教えてください。スクリーンショットや詳細な手順があると解決が早くなります。\r\n        </p>\r\n      </div>\r\n    </div>\r\n\r\n    <form @submit.prevent=\"submitBugReport\" class=\"bug-report-form\">\r\n      <!-- クイック分類 -->\r\n      <div class=\"form-section\">\r\n        <h4 class=\"section-title\">問題の種類</h4>\r\n        <div class=\"bug-categories\">\r\n          <button\r\n            v-for=\"category in bugCategories\"\r\n            :key=\"category.id\"\r\n            type=\"button\"\r\n            @click=\"selectCategory(category)\"\r\n            class=\"category-btn\"\r\n            :class=\"{ selected: selectedCategory?.id === category.id }\"\r\n            :aria-describedby=\"`category-${category.id}-desc`\"\r\n          >\r\n            <div class=\"category-icon\" :style=\"{ backgroundColor: category.color }\">\r\n              {{ category.icon }}\r\n            </div>\r\n            <div class=\"category-content\">\r\n              <div class=\"category-title\">{{ category.title }}</div>\r\n              <div class=\"category-description\" :id=\"`category-${category.id}-desc`\">\r\n                {{ category.description }}\r\n              </div>\r\n            </div>\r\n          </button>\r\n        </div>\r\n      </div>\r\n\r\n      <!-- 重要度選択 -->\r\n      <div class=\"form-section\">\r\n        <label for=\"severity\" class=\"form-label\">\r\n          重要度 <span class=\"required\">*</span>\r\n        </label>\r\n        <select \r\n          id=\"severity\" \r\n          v-model=\"formData.severity\" \r\n          class=\"form-select\"\r\n          required\r\n          @change=\"updateSeverityDescription\"\r\n        >\r\n          <option value=\"\">選択してください</option>\r\n          <option value=\"low\">軽微 - 操作に支障なし</option>\r\n          <option value=\"medium\">中程度 - 一部操作に影響</option>\r\n          <option value=\"high\">重大 - ゲーム進行に支障</option>\r\n          <option value=\"critical\">致命的 - ゲームが停止</option>\r\n        </select>\r\n        <div v-if=\"severityDescription\" class=\"severity-description\">\r\n          {{ severityDescription }}\r\n        </div>\r\n      </div>\r\n\r\n      <!-- タイトル -->\r\n      <div class=\"form-section\">\r\n        <label for=\"bug-title\" class=\"form-label\">\r\n          問題のタイトル <span class=\"required\">*</span>\r\n        </label>\r\n        <input\r\n          id=\"bug-title\"\r\n          v-model=\"formData.title\"\r\n          type=\"text\"\r\n          class=\"form-input\"\r\n          :placeholder=\"getTitlePlaceholder()\"\r\n          required\r\n          maxlength=\"100\"\r\n        />\r\n        <div class=\"character-count\">{{ formData.title.length }}/100</div>\r\n      </div>\r\n\r\n      <!-- 問題の説明 -->\r\n      <div class=\"form-section\">\r\n        <label for=\"bug-description\" class=\"form-label\">\r\n          問題の詳細 <span class=\"required\">*</span>\r\n        </label>\r\n        <textarea\r\n          id=\"bug-description\"\r\n          v-model=\"formData.description\"\r\n          class=\"form-textarea\"\r\n          placeholder=\"どのような問題が発生しましたか？できるだけ詳しく説明してください。\"\r\n          required\r\n          rows=\"4\"\r\n          maxlength=\"1000\"\r\n        ></textarea>\r\n        <div class=\"character-count\">{{ formData.description.length }}/1000</div>\r\n      </div>\r\n\r\n      <!-- 再現手順 -->\r\n      <div class=\"form-section\">\r\n        <label for=\"reproduction-steps\" class=\"form-label\">\r\n          再現手順 <span class=\"required\">*</span>\r\n        </label>\r\n        <div class=\"steps-helper\">\r\n          <div class=\"helper-tabs\">\r\n            <button\r\n              type=\"button\"\r\n              @click=\"stepsInputMode = 'manual'\"\r\n              class=\"helper-tab\"\r\n              :class=\"{ active: stepsInputMode === 'manual' }\"\r\n            >\r\n              手動入力\r\n            </button>\r\n            <button\r\n              type=\"button\"\r\n              @click=\"stepsInputMode = 'guided'\"\r\n              class=\"helper-tab\"\r\n              :class=\"{ active: stepsInputMode === 'guided' }\"\r\n            >\r\n              ステップ形式\r\n            </button>\r\n          </div>\r\n\r\n          <div v-if=\"stepsInputMode === 'manual'\" class=\"manual-input\">\r\n            <textarea\r\n              id=\"reproduction-steps\"\r\n              v-model=\"formData.stepsToReproduce\"\r\n              class=\"form-textarea\"\r\n              placeholder=\"1. ○○をクリック&#10;2. △△を選択&#10;3. □□が発生\"\r\n              required\r\n              rows=\"5\"\r\n            ></textarea>\r\n          </div>\r\n\r\n          <div v-else class=\"guided-input\">\r\n            <div class=\"steps-list\">\r\n              <div\r\n                v-for=\"(step, index) in guidedSteps\"\r\n                :key=\"index\"\r\n                class=\"step-item\"\r\n              >\r\n                <div class=\"step-number\">{{ index + 1 }}</div>\r\n                <input\r\n                  v-model=\"guidedSteps[index]\"\r\n                  type=\"text\"\r\n                  class=\"step-input\"\r\n                  :placeholder=\"`ステップ ${index + 1} の操作内容`\"\r\n                  @input=\"updateStepsFromGuided\"\r\n                />\r\n                <button\r\n                  v-if=\"guidedSteps.length > 1\"\r\n                  type=\"button\"\r\n                  @click=\"removeStep(index)\"\r\n                  class=\"remove-step-btn\"\r\n                  aria-label=\"このステップを削除\"\r\n                >\r\n                  ×\r\n                </button>\r\n              </div>\r\n            </div>\r\n            <button\r\n              type=\"button\"\r\n              @click=\"addStep\"\r\n              class=\"add-step-btn\"\r\n              :disabled=\"guidedSteps.length >= 10\"\r\n            >\r\n              + ステップを追加\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <!-- 期待される動作 -->\r\n      <div class=\"form-section\">\r\n        <label for=\"expected-behavior\" class=\"form-label\">期待される動作</label>\r\n        <textarea\r\n          id=\"expected-behavior\"\r\n          v-model=\"formData.expectedBehavior\"\r\n          class=\"form-textarea\"\r\n          placeholder=\"本来はどのような動作を期待していましたか？\"\r\n          rows=\"3\"\r\n        ></textarea>\r\n      </div>\r\n\r\n      <!-- 実際の動作 -->\r\n      <div class=\"form-section\">\r\n        <label for=\"actual-behavior\" class=\"form-label\">実際の動作</label>\r\n        <textarea\r\n          id=\"actual-behavior\"\r\n          v-model=\"formData.actualBehavior\"\r\n          class=\"form-textarea\"\r\n          placeholder=\"実際にはどのような動作が発生しましたか？\"\r\n          rows=\"3\"\r\n        ></textarea>\r\n      </div>\r\n\r\n      <!-- 再現頻度 -->\r\n      <div class=\"form-section\">\r\n        <label for=\"reproduction-rate\" class=\"form-label\">\r\n          再現頻度 <span class=\"required\">*</span>\r\n        </label>\r\n        <div class=\"frequency-options\">\r\n          <label\r\n            v-for=\"freq in frequencyOptions\"\r\n            :key=\"freq.value\"\r\n            class=\"frequency-option\"\r\n          >\r\n            <input\r\n              type=\"radio\"\r\n              v-model=\"formData.reproductionRate\"\r\n              :value=\"freq.value\"\r\n              class=\"frequency-radio\"\r\n              required\r\n            />\r\n            <div class=\"frequency-content\">\r\n              <div class=\"frequency-label\">{{ freq.label }}</div>\r\n              <div class=\"frequency-description\">{{ freq.description }}</div>\r\n            </div>\r\n          </label>\r\n        </div>\r\n      </div>\r\n\r\n      <!-- エラーメッセージ -->\r\n      <div class=\"form-section\">\r\n        <label for=\"error-message\" class=\"form-label\">エラーメッセージ（もしあれば）</label>\r\n        <textarea\r\n          id=\"error-message\"\r\n          v-model=\"formData.errorMessage\"\r\n          class=\"form-textarea mono-font\"\r\n          placeholder=\"表示されたエラーメッセージをそのままコピー&ペーストしてください\"\r\n          rows=\"3\"\r\n        ></textarea>\r\n      </div>\r\n\r\n      <!-- スクリーンショット -->\r\n      <div class=\"form-section\">\r\n        <div class=\"screenshot-section\">\r\n          <div class=\"screenshot-header\">\r\n            <label class=\"form-label\">スクリーンショット</label>\r\n            <div class=\"screenshot-actions\">\r\n              <button\r\n                type=\"button\"\r\n                @click=\"captureScreenshot\"\r\n                class=\"capture-btn\"\r\n                :disabled=\"isCapturing\"\r\n              >\r\n                <span v-if=\"isCapturing\">撮影中...</span>\r\n                <span v-else>📸 画面を撮影</span>\r\n              </button>\r\n              <input\r\n                ref=\"fileInput\"\r\n                type=\"file\"\r\n                accept=\"image/*\"\r\n                @change=\"handleFileUpload\"\r\n                class=\"file-input\"\r\n                style=\"display: none\"\r\n              />\r\n              <button\r\n                type=\"button\"\r\n                @click=\"$refs.fileInput?.click()\"\r\n                class=\"upload-btn\"\r\n              >\r\n                📁 ファイルを選択\r\n              </button>\r\n            </div>\r\n          </div>\r\n          \r\n          <div v-if=\"screenshots.length > 0\" class=\"screenshots-preview\">\r\n            <div\r\n              v-for=\"(screenshot, index) in screenshots\"\r\n              :key=\"index\"\r\n              class=\"screenshot-item\"\r\n            >\r\n              <img\r\n                :src=\"screenshot.data\"\r\n                :alt=\"`スクリーンショット ${index + 1}`\"\r\n                class=\"screenshot-image\"\r\n                @click=\"previewImage(screenshot.data)\"\r\n              />\r\n              <div class=\"screenshot-info\">\r\n                <div class=\"screenshot-name\">{{ screenshot.name }}</div>\r\n                <div class=\"screenshot-size\">{{ formatFileSize(screenshot.size) }}</div>\r\n              </div>\r\n              <button\r\n                type=\"button\"\r\n                @click=\"removeScreenshot(index)\"\r\n                class=\"remove-screenshot-btn\"\r\n                aria-label=\"スクリーンショットを削除\"\r\n              >\r\n                ×\r\n              </button>\r\n            </div>\r\n          </div>\r\n          \r\n          <div v-else class=\"no-screenshots\">\r\n            <div class=\"no-screenshots-icon\">📷</div>\r\n            <p class=\"no-screenshots-text\">\r\n              スクリーンショットがあると問題の特定が早くなります\r\n            </p>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <!-- システム情報の自動収集 -->\r\n      <div class=\"form-section\">\r\n        <div class=\"system-info-section\">\r\n          <h4 class=\"section-title\">システム情報</h4>\r\n          <div class=\"system-info-toggle\">\r\n            <label class=\"toggle-label\">\r\n              <input\r\n                type=\"checkbox\"\r\n                v-model=\"includeSystemInfo\"\r\n                class=\"toggle-checkbox\"\r\n              />\r\n              <span class=\"toggle-slider\"></span>\r\n              システム情報を含める（推奨）\r\n            </label>\r\n            <p class=\"toggle-description\">\r\n              ブラウザ情報、画面サイズ、ゲーム状態などを自動で収集します\r\n            </p>\r\n          </div>\r\n          \r\n          <div v-if=\"includeSystemInfo && systemInfo\" class=\"system-info-preview\">\r\n            <div class=\"info-item\">\r\n              <span class=\"info-label\">ブラウザ:</span>\r\n              <span class=\"info-value\">{{ getBrowserName() }}</span>\r\n            </div>\r\n            <div class=\"info-item\">\r\n              <span class=\"info-label\">画面サイズ:</span>\r\n              <span class=\"info-value\">{{ systemInfo.screenResolution }}</span>\r\n            </div>\r\n            <div class=\"info-item\">\r\n              <span class=\"info-label\">ゲーム状態:</span>\r\n              <span class=\"info-value\">{{ getGameStateText() }}</span>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <!-- 送信者情報 -->\r\n      <div class=\"form-section\">\r\n        <h4 class=\"section-title\">連絡先（任意）</h4>\r\n        <div class=\"contact-toggle\">\r\n          <label class=\"toggle-label\">\r\n            <input\r\n              type=\"checkbox\"\r\n              v-model=\"provideContact\"\r\n              class=\"toggle-checkbox\"\r\n            />\r\n            <span class=\"toggle-slider\"></span>\r\n            連絡先を提供する\r\n          </label>\r\n          <p class=\"toggle-description\">\r\n            進捗の通知や追加情報の確認が必要な場合にご連絡します\r\n          </p>\r\n        </div>\r\n        \r\n        <div v-if=\"provideContact\" class=\"contact-fields\">\r\n          <div class=\"contact-field\">\r\n            <label for=\"contact-email\" class=\"form-label\">メールアドレス</label>\r\n            <input\r\n              id=\"contact-email\"\r\n              v-model=\"formData.contactEmail\"\r\n              type=\"email\"\r\n              class=\"form-input\"\r\n              placeholder=\"example@example.com\"\r\n            />\r\n          </div>\r\n          <div class=\"contact-field\">\r\n            <label for=\"contact-name\" class=\"form-label\">お名前</label>\r\n            <input\r\n              id=\"contact-name\"\r\n              v-model=\"formData.contactName\"\r\n              type=\"text\"\r\n              class=\"form-input\"\r\n              placeholder=\"田中太郎\"\r\n              maxlength=\"50\"\r\n            />\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <!-- 送信ボタン -->\r\n      <div class=\"form-actions\">\r\n        <button\r\n          type=\"button\"\r\n          @click=\"resetForm\"\r\n          class=\"btn-secondary\"\r\n        >\r\n          リセット\r\n        </button>\r\n        <button\r\n          type=\"submit\"\r\n          class=\"btn-primary\"\r\n          :disabled=\"!isFormValid || isSubmitting\"\r\n        >\r\n          <span v-if=\"isSubmitting\">送信中...</span>\r\n          <span v-else>バグレポートを送信</span>\r\n        </button>\r\n      </div>\r\n    </form>\r\n\r\n    <!-- 画像プレビューモーダル -->\r\n    <div v-if=\"previewImageUrl\" class=\"image-preview-modal\" @click=\"closeImagePreview\">\r\n      <div class=\"preview-content\" @click.stop>\r\n        <img :src=\"previewImageUrl\" alt=\"プレビュー画像\" class=\"preview-image\" />\r\n        <button @click=\"closeImagePreview\" class=\"close-preview-btn\">×</button>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- 送信成功メッセージ -->\r\n    <div v-if=\"showSuccessMessage\" class=\"success-overlay\">\r\n      <div class=\"success-content\">\r\n        <div class=\"success-icon\">✅</div>\r\n        <h3 class=\"success-title\">バグレポートを送信しました</h3>\r\n        <div class=\"success-details\">\r\n          <p class=\"report-id\">レポートID: <code>{{ submittedReportId }}</code></p>\r\n          <p class=\"success-message\">\r\n            {{ provideContact \r\n              ? 'ご連絡先をいただいているため、進捗があればお知らせします。' \r\n              : 'バグの修正状況は今後のアップデート情報でご確認ください。' }}\r\n          </p>\r\n        </div>\r\n        <div class=\"success-actions\">\r\n          <button @click=\"createAnotherReport\" class=\"btn-secondary\">\r\n            別のバグを報告\r\n          </button>\r\n          <button @click=\"closeReporter\" class=\"btn-primary\">\r\n            閉じる\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup lang=\"ts\">\r\nimport { ref, reactive, computed, onMounted } from 'vue'\r\nimport { FeedbackManagementService } from '../../domain/services/FeedbackManagementService'\r\n\r\n// Props & Emits\r\ninterface Props {\r\n  gameState?: {\r\n    stage: string\r\n    turn: number\r\n    vitality: number\r\n    phase: string\r\n  }\r\n}\r\n\r\nconst props = defineProps<Props>()\r\n\r\nconst emit = defineEmits<{\r\n  bugReported: [reportId: string]\r\n  close: []\r\n}>()\r\n\r\n// Services\r\nconst feedbackService = new FeedbackManagementService()\r\n\r\n// State\r\nconst stepsInputMode = ref<'manual' | 'guided'>('manual')\r\nconst guidedSteps = ref<string[]>([''])\r\nconst screenshots = ref<Array<{ name: string; data: string; size: number }>>([])\r\nconst isCapturing = ref(false)\r\nconst includeSystemInfo = ref(true)\r\nconst provideContact = ref(false)\r\nconst isSubmitting = ref(false)\r\nconst showSuccessMessage = ref(false)\r\nconst submittedReportId = ref('')\r\nconst previewImageUrl = ref('')\r\nconst selectedCategory = ref<any>(null)\r\nconst severityDescription = ref('')\r\nconst systemInfo = ref<any>(null)\r\n\r\n// Form Data\r\nconst formData = reactive({\r\n  severity: '',\r\n  title: '',\r\n  description: '',\r\n  stepsToReproduce: '',\r\n  expectedBehavior: '',\r\n  actualBehavior: '',\r\n  reproductionRate: '',\r\n  errorMessage: '',\r\n  contactEmail: '',\r\n  contactName: ''\r\n})\r\n\r\n// Bug Categories\r\nconst bugCategories = [\r\n  {\r\n    id: 'ui',\r\n    title: 'UI・表示の問題',\r\n    description: 'ボタンが押せない、表示が崩れるなど',\r\n    icon: '🎨',\r\n    color: '#8B5CF6'\r\n  },\r\n  {\r\n    id: 'gameplay',\r\n    title: 'ゲームプレイの問題',\r\n    description: 'カードが選択できない、ゲームが進まないなど',\r\n    icon: '🎮',\r\n    color: '#3B82F6'\r\n  },\r\n  {\r\n    id: 'performance',\r\n    title: 'パフォーマンスの問題',\r\n    description: '動作が重い、フリーズするなど',\r\n    icon: '⚡',\r\n    color: '#F59E0B'\r\n  },\r\n  {\r\n    id: 'audio',\r\n    title: '音声の問題',\r\n    description: '音が出ない、音量調整ができないなど',\r\n    icon: '🔊',\r\n    color: '#10B981'\r\n  },\r\n  {\r\n    id: 'save',\r\n    title: 'セーブ・ロードの問題',\r\n    description: '進行状況が保存されない、読み込めないなど',\r\n    icon: '💾',\r\n    color: '#EF4444'\r\n  },\r\n  {\r\n    id: 'other',\r\n    title: 'その他',\r\n    description: '上記に当てはまらない問題',\r\n    icon: '❓',\r\n    color: '#6B7280'\r\n  }\r\n]\r\n\r\n// Frequency Options\r\nconst frequencyOptions = [\r\n  {\r\n    value: 'always',\r\n    label: '毎回発生',\r\n    description: '同じ操作をすると必ず発生する'\r\n  },\r\n  {\r\n    value: 'often',\r\n    label: '頻繁に発生',\r\n    description: '半分以上の確率で発生する'\r\n  },\r\n  {\r\n    value: 'sometimes',\r\n    label: '時々発生',\r\n    description: 'たまに発生する'\r\n  },\r\n  {\r\n    value: 'rarely',\r\n    label: '稀に発生',\r\n    description: '一度だけ、または非常に稀に発生'\r\n  }\r\n]\r\n\r\n// Computed\r\nconst isFormValid = computed(() => {\r\n  return formData.severity &&\r\n         formData.title.trim() &&\r\n         formData.description.trim() &&\r\n         formData.stepsToReproduce.trim() &&\r\n         formData.reproductionRate\r\n})\r\n\r\n// Methods\r\nconst selectCategory = (category: any) => {\r\n  selectedCategory.value = selectedCategory.value?.id === category.id ? null : category\r\n  if (selectedCategory.value && !formData.title) {\r\n    // カテゴリに基づいてタイトルのテンプレートを提案\r\n    const templates = {\r\n      ui: 'UIの表示に関する問題',\r\n      gameplay: 'ゲームプレイの進行に関する問題',\r\n      performance: 'パフォーマンスに関する問題',\r\n      audio: '音声に関する問題',\r\n      save: 'セーブ・ロードに関する問題',\r\n      other: 'その他の問題'\r\n    }\r\n    // ここではタイトルは自動設定せず、プレースホルダーで誘導\r\n  }\r\n}\r\n\r\nconst getTitlePlaceholder = () => {\r\n  if (selectedCategory.value) {\r\n    const placeholders = {\r\n      ui: '例: ○○ボタンが押せない',\r\n      gameplay: '例: カード選択後にゲームが進まない',\r\n      performance: '例: ゲーム開始時に長時間フリーズする',\r\n      audio: '例: 効果音が再生されない',\r\n      save: '例: ゲーム終了後にスコアが保存されない',\r\n      other: '例: 具体的な問題を簡潔に'\r\n    }\r\n    return placeholders[selectedCategory.value.id as keyof typeof placeholders] || '問題を簡潔に説明してください'\r\n  }\r\n  return '問題を簡潔に説明してください'\r\n}\r\n\r\nconst updateSeverityDescription = () => {\r\n  const descriptions = {\r\n    low: '機能は使えるが、改善の余地がある軽微な問題',\r\n    medium: 'いくつかの機能に影響するが、回避方法がある問題',\r\n    high: 'ゲームの主要機能に大きく影響する問題',\r\n    critical: 'ゲームが全く使用できない、またはデータ損失の可能性がある問題'\r\n  }\r\n  severityDescription.value = descriptions[formData.severity as keyof typeof descriptions] || ''\r\n}\r\n\r\nconst addStep = () => {\r\n  if (guidedSteps.value.length < 10) {\r\n    guidedSteps.value.push('')\r\n  }\r\n}\r\n\r\nconst removeStep = (index: number) => {\r\n  if (guidedSteps.value.length > 1) {\r\n    guidedSteps.value.splice(index, 1)\r\n    updateStepsFromGuided()\r\n  }\r\n}\r\n\r\nconst updateStepsFromGuided = () => {\r\n  formData.stepsToReproduce = guidedSteps.value\r\n    .filter(step => step.trim())\r\n    .map((step, index) => `${index + 1}. ${step}`)\r\n    .join('\\n')\r\n}\r\n\r\nconst captureScreenshot = async () => {\r\n  isCapturing.value = true\r\n  try {\r\n    // 簡易的なスクリーンショット実装\r\n    // 実際の実装では html2canvas などを使用\r\n    const canvas = document.createElement('canvas')\r\n    const ctx = canvas.getContext('2d')\r\n    if (!ctx) throw new Error('Canvas context not available')\r\n\r\n    canvas.width = window.innerWidth\r\n    canvas.height = window.innerHeight\r\n    \r\n    // 背景色を設定\r\n    ctx.fillStyle = '#1a1a1a'\r\n    ctx.fillRect(0, 0, canvas.width, canvas.height)\r\n    \r\n    // テキストを描画（実際の画面キャプチャの代替）\r\n    ctx.fillStyle = '#ffffff'\r\n    ctx.font = '16px Arial'\r\n    ctx.fillText(`Screenshot captured at ${new Date().toLocaleString()}`, 10, 30)\r\n    ctx.fillText(`Browser: ${navigator.userAgent.split(' ').slice(-1)[0]}`, 10, 60)\r\n    ctx.fillText(`Screen: ${canvas.width}x${canvas.height}`, 10, 90)\r\n    \r\n    if (props.gameState) {\r\n      ctx.fillText(`Game Stage: ${props.gameState.stage}`, 10, 120)\r\n      ctx.fillText(`Turn: ${props.gameState.turn}`, 10, 150)\r\n      ctx.fillText(`Vitality: ${props.gameState.vitality}`, 10, 180)\r\n    }\r\n\r\n    const dataUrl = canvas.toDataURL('image/png')\r\n    const size = Math.round((dataUrl.length * 3) / 4) // Base64 size estimation\r\n    \r\n    screenshots.value.push({\r\n      name: `screenshot_${Date.now()}.png`,\r\n      data: dataUrl,\r\n      size\r\n    })\r\n  } catch (error) {\r\n    console.error('Failed to capture screenshot:', error)\r\n    alert('スクリーンショットの撮影に失敗しました。')\r\n  } finally {\r\n    isCapturing.value = false\r\n  }\r\n}\r\n\r\nconst handleFileUpload = (event: Event) => {\r\n  const target = event.target as HTMLInputElement\r\n  const files = target.files\r\n  if (!files) return\r\n\r\n  Array.from(files).forEach(file => {\r\n    if (file.type.startsWith('image/')) {\r\n      const reader = new FileReader()\r\n      reader.onload = (e) => {\r\n        const result = e.target?.result as string\r\n        if (result) {\r\n          screenshots.value.push({\r\n            name: file.name,\r\n            data: result,\r\n            size: file.size\r\n          })\r\n        }\r\n      }\r\n      reader.readAsDataURL(file)\r\n    }\r\n  })\r\n  \r\n  // ファイル入力をリセット\r\n  target.value = ''\r\n}\r\n\r\nconst removeScreenshot = (index: number) => {\r\n  screenshots.value.splice(index, 1)\r\n}\r\n\r\nconst previewImage = (imageData: string) => {\r\n  previewImageUrl.value = imageData\r\n}\r\n\r\nconst closeImagePreview = () => {\r\n  previewImageUrl.value = ''\r\n}\r\n\r\nconst formatFileSize = (bytes: number): string => {\r\n  if (bytes === 0) return '0 Bytes'\r\n  const k = 1024\r\n  const sizes = ['Bytes', 'KB', 'MB', 'GB']\r\n  const i = Math.floor(Math.log(bytes) / Math.log(k))\r\n  return `${parseFloat((bytes / Math.pow(k, i)).toFixed(2))  } ${  sizes[i]}`\r\n}\r\n\r\nconst getBrowserName = (): string => {\r\n  const userAgent = navigator.userAgent\r\n  if (userAgent.includes('Chrome')) return 'Chrome'\r\n  if (userAgent.includes('Firefox')) return 'Firefox'\r\n  if (userAgent.includes('Safari')) return 'Safari'\r\n  if (userAgent.includes('Edge')) return 'Edge'\r\n  return 'Unknown'\r\n}\r\n\r\nconst getGameStateText = (): string => {\r\n  if (!props.gameState) return 'Unknown'\r\n  return `${props.gameState.stage} - Turn ${props.gameState.turn}`\r\n}\r\n\r\nconst submitBugReport = async () => {\r\n  if (!isFormValid.value || isSubmitting.value) return\r\n\r\n  isSubmitting.value = true\r\n\r\n  try {\r\n    // システム情報を収集\r\n    const systemInfo = {\r\n      userAgent: navigator.userAgent,\r\n      screenResolution: `${screen.width}x${screen.height}`,\r\n      viewport: `${window.innerWidth}x${window.innerHeight}`,\r\n      gameVersion: '0.2.7',\r\n      timestamp: new Date(),\r\n      gameState: props.gameState\r\n    }\r\n\r\n    // 送信者情報\r\n    const submitter = {\r\n      name: provideContact.value ? formData.contactName || undefined : undefined,\r\n      email: provideContact.value ? formData.contactEmail || undefined : undefined,\r\n      isAnonymous: !provideContact.value,\r\n      userAgent: navigator.userAgent,\r\n      sessionId: generateSessionId()\r\n    }\r\n\r\n    // バグレポートデータ\r\n    const bugReportData = {\r\n      stepsToReproduce: formData.stepsToReproduce.split('\\n').filter(step => step.trim()),\r\n      expectedBehavior: formData.expectedBehavior,\r\n      actualBehavior: formData.actualBehavior,\r\n      errorMessage: formData.errorMessage || undefined,\r\n      severity: formData.severity as 'low' | 'medium' | 'high' | 'critical',\r\n      reproductionRate: formData.reproductionRate as 'always' | 'often' | 'sometimes' | 'rarely',\r\n      screenshot: screenshots.value.length > 0 ? screenshots.value[0].data : undefined\r\n    }\r\n\r\n    // タグを生成\r\n    const tags = [\r\n      'bug-report',\r\n      selectedCategory.value?.id || 'uncategorized',\r\n      `severity-${formData.severity}`,\r\n      `frequency-${formData.reproductionRate}`,\r\n      screenshots.value.length > 0 ? 'with-screenshot' : 'no-screenshot'\r\n    ]\r\n\r\n    // フィードバックを作成\r\n    const feedback = feedbackService.createBugReport({\r\n      title: formData.title.trim(),\r\n      description: formData.description.trim(),\r\n      submitter,\r\n      systemInfo: includeSystemInfo.value ? systemInfo : {\r\n        userAgent: 'Not provided',\r\n        screenResolution: 'Not provided',\r\n        viewport: 'Not provided',\r\n        gameVersion: '0.2.7',\r\n        timestamp: new Date()\r\n      },\r\n      bugReportData,\r\n      tags\r\n    })\r\n\r\n    submittedReportId.value = feedback.id\r\n    showSuccessMessage.value = true\r\n    emit('bugReported', feedback.id)\r\n\r\n  } catch (error) {\r\n    console.error('Failed to submit bug report:', error)\r\n    alert('バグレポートの送信に失敗しました。しばらく後にもう一度お試しください。')\r\n  } finally {\r\n    isSubmitting.value = false\r\n  }\r\n}\r\n\r\nconst resetForm = () => {\r\n  Object.assign(formData, {\r\n    severity: '',\r\n    title: '',\r\n    description: '',\r\n    stepsToReproduce: '',\r\n    expectedBehavior: '',\r\n    actualBehavior: '',\r\n    reproductionRate: '',\r\n    errorMessage: '',\r\n    contactEmail: '',\r\n    contactName: ''\r\n  })\r\n  \r\n  selectedCategory.value = null\r\n  severityDescription.value = ''\r\n  screenshots.value = []\r\n  guidedSteps.value = ['']\r\n  stepsInputMode.value = 'manual'\r\n  includeSystemInfo.value = true\r\n  provideContact.value = false\r\n}\r\n\r\nconst createAnotherReport = () => {\r\n  showSuccessMessage.value = false\r\n  resetForm()\r\n}\r\n\r\nconst closeReporter = () => {\r\n  emit('close')\r\n}\r\n\r\nconst generateSessionId = (): string => {\r\n  return `bugreport_${  Date.now()  }_${  Math.random().toString(36).substr(2, 9)}`\r\n}\r\n\r\n// Lifecycle\r\nonMounted(() => {\r\n  // システム情報を初期化\r\n  systemInfo.value = {\r\n    userAgent: navigator.userAgent,\r\n    screenResolution: `${screen.width}x${screen.height}`,\r\n    viewport: `${window.innerWidth}x${window.innerHeight}`,\r\n    timestamp: new Date()\r\n  }\r\n})\r\n</script>\r\n\r\n<style scoped>\r\n/* =================================\r\n   バグレポーターベース\r\n   ================================= */\r\n\r\n.bug-reporter {\r\n  background: rgba(255, 255, 255, 0.05);\r\n  border-radius: 16px;\r\n  border: 1px solid rgba(239, 68, 68, 0.3);\r\n  overflow: hidden;\r\n}\r\n\r\n/* =================================\r\n   ヘッダー\r\n   ================================= */\r\n\r\n.bug-reporter-header {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: var(--space-lg);\r\n  padding: var(--space-lg);\r\n  background: rgba(239, 68, 68, 0.1);\r\n  border-bottom: 1px solid rgba(239, 68, 68, 0.2);\r\n}\r\n\r\n.header-icon {\r\n  font-size: 3rem;\r\n  flex-shrink: 0;\r\n}\r\n\r\n.header-content {\r\n  flex: 1;\r\n}\r\n\r\n.header-title {\r\n  font-size: var(--text-xl);\r\n  font-weight: 700;\r\n  color: rgba(239, 68, 68, 1);\r\n  margin: 0 0 var(--space-sm) 0;\r\n}\r\n\r\n.header-subtitle {\r\n  color: rgba(255, 255, 255, 0.8);\r\n  margin: 0;\r\n  line-height: 1.5;\r\n}\r\n\r\n/* =================================\r\n   フォーム\r\n   ================================= */\r\n\r\n.bug-report-form {\r\n  padding: var(--space-lg);\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: var(--space-xl);\r\n}\r\n\r\n.form-section {\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: var(--space-md);\r\n}\r\n\r\n.section-title {\r\n  font-size: var(--text-lg);\r\n  font-weight: 600;\r\n  color: rgba(255, 255, 255, 0.95);\r\n  margin: 0;\r\n}\r\n\r\n.form-label {\r\n  font-weight: 600;\r\n  color: rgba(255, 255, 255, 0.9);\r\n  font-size: var(--text-sm);\r\n}\r\n\r\n.required {\r\n  color: #EF4444;\r\n}\r\n\r\n.form-input,\r\n.form-select,\r\n.form-textarea {\r\n  width: 100%;\r\n  padding: var(--space-sm);\r\n  background: rgba(255, 255, 255, 0.05);\r\n  border: 2px solid rgba(129, 140, 248, 0.2);\r\n  border-radius: 8px;\r\n  color: rgba(255, 255, 255, 0.9);\r\n  font-size: var(--text-sm);\r\n  transition: border-color var(--transition-fast);\r\n  font-family: inherit;\r\n}\r\n\r\n.form-textarea.mono-font {\r\n  font-family: 'Courier New', monospace;\r\n}\r\n\r\n.form-input:focus,\r\n.form-select:focus,\r\n.form-textarea:focus {\r\n  outline: none;\r\n  border-color: rgba(129, 140, 248, 0.6);\r\n  background: rgba(255, 255, 255, 0.08);\r\n}\r\n\r\n.character-count {\r\n  text-align: right;\r\n  font-size: var(--text-xs);\r\n  color: rgba(255, 255, 255, 0.5);\r\n}\r\n\r\n.severity-description {\r\n  font-size: var(--text-sm);\r\n  color: rgba(255, 255, 255, 0.7);\r\n  padding: var(--space-sm);\r\n  background: rgba(129, 140, 248, 0.1);\r\n  border-radius: 6px;\r\n  border-left: 3px solid rgba(129, 140, 248, 0.5);\r\n}\r\n\r\n/* =================================\r\n   カテゴリ選択\r\n   ================================= */\r\n\r\n.bug-categories {\r\n  display: grid;\r\n  gap: var(--space-sm);\r\n}\r\n\r\n.category-btn {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: var(--space-md);\r\n  padding: var(--space-md);\r\n  background: rgba(255, 255, 255, 0.03);\r\n  border: 2px solid rgba(129, 140, 248, 0.2);\r\n  border-radius: 8px;\r\n  cursor: pointer;\r\n  transition: all var(--transition-fast);\r\n  text-align: left;\r\n  width: 100%;\r\n}\r\n\r\n.category-btn:hover,\r\n.category-btn.selected {\r\n  border-color: rgba(129, 140, 248, 0.5);\r\n  background: rgba(129, 140, 248, 0.1);\r\n}\r\n\r\n.category-icon {\r\n  width: 40px;\r\n  height: 40px;\r\n  border-radius: 50%;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  font-size: var(--text-lg);\r\n  flex-shrink: 0;\r\n}\r\n\r\n.category-content {\r\n  flex: 1;\r\n}\r\n\r\n.category-title {\r\n  font-weight: 600;\r\n  color: rgba(255, 255, 255, 0.95);\r\n  margin-bottom: var(--space-xs);\r\n}\r\n\r\n.category-description {\r\n  font-size: var(--text-sm);\r\n  color: rgba(255, 255, 255, 0.7);\r\n}\r\n\r\n/* =================================\r\n   ステップ入力\r\n   ================================= */\r\n\r\n.steps-helper {\r\n  border: 1px solid rgba(129, 140, 248, 0.2);\r\n  border-radius: 8px;\r\n  overflow: hidden;\r\n}\r\n\r\n.helper-tabs {\r\n  display: flex;\r\n  background: rgba(255, 255, 255, 0.03);\r\n}\r\n\r\n.helper-tab {\r\n  flex: 1;\r\n  padding: var(--space-sm);\r\n  background: none;\r\n  border: none;\r\n  color: rgba(255, 255, 255, 0.7);\r\n  cursor: pointer;\r\n  transition: all var(--transition-fast);\r\n  font-size: var(--text-sm);\r\n}\r\n\r\n.helper-tab.active {\r\n  background: rgba(129, 140, 248, 0.2);\r\n  color: rgba(255, 255, 255, 0.95);\r\n}\r\n\r\n.manual-input,\r\n.guided-input {\r\n  padding: var(--space-md);\r\n}\r\n\r\n.steps-list {\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: var(--space-sm);\r\n  margin-bottom: var(--space-md);\r\n}\r\n\r\n.step-item {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: var(--space-sm);\r\n}\r\n\r\n.step-number {\r\n  width: 24px;\r\n  height: 24px;\r\n  border-radius: 50%;\r\n  background: rgba(129, 140, 248, 0.2);\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  font-size: var(--text-sm);\r\n  font-weight: 600;\r\n  color: rgba(255, 255, 255, 0.9);\r\n  flex-shrink: 0;\r\n}\r\n\r\n.step-input {\r\n  flex: 1;\r\n  padding: var(--space-sm);\r\n  background: rgba(255, 255, 255, 0.05);\r\n  border: 1px solid rgba(129, 140, 248, 0.2);\r\n  border-radius: 4px;\r\n  color: rgba(255, 255, 255, 0.9);\r\n  font-size: var(--text-sm);\r\n}\r\n\r\n.remove-step-btn {\r\n  width: 24px;\r\n  height: 24px;\r\n  border-radius: 50%;\r\n  background: rgba(239, 68, 68, 0.2);\r\n  border: none;\r\n  color: rgba(239, 68, 68, 1);\r\n  cursor: pointer;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  font-size: var(--text-sm);\r\n  flex-shrink: 0;\r\n}\r\n\r\n.add-step-btn {\r\n  padding: var(--space-sm) var(--space-md);\r\n  background: rgba(129, 140, 248, 0.1);\r\n  border: 1px solid rgba(129, 140, 248, 0.3);\r\n  border-radius: 6px;\r\n  color: rgba(129, 140, 248, 1);\r\n  cursor: pointer;\r\n  font-size: var(--text-sm);\r\n  transition: all var(--transition-fast);\r\n}\r\n\r\n.add-step-btn:hover:not(:disabled) {\r\n  background: rgba(129, 140, 248, 0.2);\r\n}\r\n\r\n.add-step-btn:disabled {\r\n  opacity: 0.5;\r\n  cursor: not-allowed;\r\n}\r\n\r\n/* =================================\r\n   再現頻度\r\n   ================================= */\r\n\r\n.frequency-options {\r\n  display: grid;\r\n  gap: var(--space-sm);\r\n}\r\n\r\n.frequency-option {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: var(--space-md);\r\n  padding: var(--space-md);\r\n  background: rgba(255, 255, 255, 0.03);\r\n  border: 2px solid rgba(129, 140, 248, 0.2);\r\n  border-radius: 8px;\r\n  cursor: pointer;\r\n  transition: all var(--transition-fast);\r\n}\r\n\r\n.frequency-option:has(.frequency-radio:checked) {\r\n  border-color: rgba(129, 140, 248, 0.6);\r\n  background: rgba(129, 140, 248, 0.1);\r\n}\r\n\r\n.frequency-radio {\r\n  accent-color: rgba(129, 140, 248, 1);\r\n}\r\n\r\n.frequency-content {\r\n  flex: 1;\r\n}\r\n\r\n.frequency-label {\r\n  font-weight: 600;\r\n  color: rgba(255, 255, 255, 0.95);\r\n  margin-bottom: var(--space-xs);\r\n}\r\n\r\n.frequency-description {\r\n  font-size: var(--text-sm);\r\n  color: rgba(255, 255, 255, 0.7);\r\n}\r\n\r\n/* =================================\r\n   スクリーンショット\r\n   ================================= */\r\n\r\n.screenshot-section {\r\n  border: 1px solid rgba(129, 140, 248, 0.2);\r\n  border-radius: 8px;\r\n  padding: var(--space-md);\r\n}\r\n\r\n.screenshot-header {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  margin-bottom: var(--space-md);\r\n}\r\n\r\n.screenshot-actions {\r\n  display: flex;\r\n  gap: var(--space-sm);\r\n}\r\n\r\n.capture-btn,\r\n.upload-btn {\r\n  padding: var(--space-sm) var(--space-md);\r\n  background: rgba(129, 140, 248, 0.1);\r\n  border: 1px solid rgba(129, 140, 248, 0.3);\r\n  border-radius: 6px;\r\n  color: rgba(129, 140, 248, 1);\r\n  cursor: pointer;\r\n  font-size: var(--text-sm);\r\n  transition: all var(--transition-fast);\r\n}\r\n\r\n.capture-btn:hover,\r\n.upload-btn:hover {\r\n  background: rgba(129, 140, 248, 0.2);\r\n}\r\n\r\n.capture-btn:disabled {\r\n  opacity: 0.5;\r\n  cursor: not-allowed;\r\n}\r\n\r\n.screenshots-preview {\r\n  display: grid;\r\n  grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));\r\n  gap: var(--space-md);\r\n}\r\n\r\n.screenshot-item {\r\n  position: relative;\r\n  background: rgba(255, 255, 255, 0.05);\r\n  border-radius: 8px;\r\n  padding: var(--space-sm);\r\n  border: 1px solid rgba(129, 140, 248, 0.2);\r\n}\r\n\r\n.screenshot-image {\r\n  width: 100%;\r\n  height: 100px;\r\n  object-fit: cover;\r\n  border-radius: 4px;\r\n  cursor: pointer;\r\n  transition: opacity var(--transition-fast);\r\n}\r\n\r\n.screenshot-image:hover {\r\n  opacity: 0.8;\r\n}\r\n\r\n.screenshot-info {\r\n  margin-top: var(--space-sm);\r\n}\r\n\r\n.screenshot-name {\r\n  font-size: var(--text-xs);\r\n  color: rgba(255, 255, 255, 0.8);\r\n  font-weight: 600;\r\n  white-space: nowrap;\r\n  overflow: hidden;\r\n  text-overflow: ellipsis;\r\n}\r\n\r\n.screenshot-size {\r\n  font-size: var(--text-xs);\r\n  color: rgba(255, 255, 255, 0.6);\r\n}\r\n\r\n.remove-screenshot-btn {\r\n  position: absolute;\r\n  top: var(--space-xs);\r\n  right: var(--space-xs);\r\n  width: 20px;\r\n  height: 20px;\r\n  border-radius: 50%;\r\n  background: rgba(239, 68, 68, 0.8);\r\n  border: none;\r\n  color: white;\r\n  cursor: pointer;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  font-size: var(--text-xs);\r\n}\r\n\r\n.no-screenshots {\r\n  text-align: center;\r\n  padding: var(--space-xl);\r\n  color: rgba(255, 255, 255, 0.6);\r\n}\r\n\r\n.no-screenshots-icon {\r\n  font-size: 2rem;\r\n  margin-bottom: var(--space-md);\r\n}\r\n\r\n.no-screenshots-text {\r\n  margin: 0;\r\n  font-size: var(--text-sm);\r\n}\r\n\r\n/* =================================\r\n   システム情報・連絡先\r\n   ================================= */\r\n\r\n.system-info-section,\r\n.contact-toggle {\r\n  border: 1px solid rgba(129, 140, 248, 0.2);\r\n  border-radius: 8px;\r\n  padding: var(--space-md);\r\n}\r\n\r\n.toggle-label {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: var(--space-sm);\r\n  cursor: pointer;\r\n  font-weight: 600;\r\n  color: rgba(255, 255, 255, 0.9);\r\n}\r\n\r\n.toggle-checkbox {\r\n  display: none;\r\n}\r\n\r\n.toggle-slider {\r\n  width: 44px;\r\n  height: 24px;\r\n  background: rgba(255, 255, 255, 0.2);\r\n  border-radius: 12px;\r\n  position: relative;\r\n  transition: background var(--transition-fast);\r\n}\r\n\r\n.toggle-slider::before {\r\n  content: '';\r\n  position: absolute;\r\n  width: 20px;\r\n  height: 20px;\r\n  border-radius: 50%;\r\n  background: white;\r\n  top: 2px;\r\n  left: 2px;\r\n  transition: transform var(--transition-fast);\r\n}\r\n\r\n.toggle-checkbox:checked + .toggle-slider {\r\n  background: rgba(129, 140, 248, 0.8);\r\n}\r\n\r\n.toggle-checkbox:checked + .toggle-slider::before {\r\n  transform: translateX(20px);\r\n}\r\n\r\n.toggle-description {\r\n  font-size: var(--text-sm);\r\n  color: rgba(255, 255, 255, 0.7);\r\n  margin: var(--space-sm) 0 0 0;\r\n}\r\n\r\n.system-info-preview {\r\n  margin-top: var(--space-md);\r\n  padding: var(--space-sm);\r\n  background: rgba(255, 255, 255, 0.03);\r\n  border-radius: 6px;\r\n}\r\n\r\n.info-item {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  margin-bottom: var(--space-xs);\r\n  font-size: var(--text-sm);\r\n}\r\n\r\n.info-label {\r\n  color: rgba(255, 255, 255, 0.7);\r\n}\r\n\r\n.info-value {\r\n  color: rgba(255, 255, 255, 0.9);\r\n  font-family: monospace;\r\n}\r\n\r\n.contact-fields {\r\n  margin-top: var(--space-md);\r\n  display: grid;\r\n  gap: var(--space-md);\r\n}\r\n\r\n/* =================================\r\n   フォームアクション\r\n   ================================= */\r\n\r\n.form-actions {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  gap: var(--space-md);\r\n  margin-top: var(--space-xl);\r\n  padding-top: var(--space-lg);\r\n  border-top: 1px solid rgba(129, 140, 248, 0.2);\r\n}\r\n\r\n.btn-primary,\r\n.btn-secondary {\r\n  padding: var(--space-sm) var(--space-lg);\r\n  border-radius: 8px;\r\n  font-weight: 600;\r\n  cursor: pointer;\r\n  transition: all var(--transition-fast);\r\n  border: none;\r\n  font-size: var(--text-sm);\r\n  min-width: 140px;\r\n}\r\n\r\n.btn-primary {\r\n  background: var(--primary-gradient);\r\n  color: white;\r\n}\r\n\r\n.btn-primary:hover:not(:disabled) {\r\n  transform: translateY(-2px);\r\n  box-shadow: 0 8px 25px rgba(129, 140, 248, 0.3);\r\n}\r\n\r\n.btn-primary:disabled {\r\n  opacity: 0.6;\r\n  cursor: not-allowed;\r\n}\r\n\r\n.btn-secondary {\r\n  background: rgba(255, 255, 255, 0.1);\r\n  color: rgba(255, 255, 255, 0.8);\r\n  border: 2px solid rgba(129, 140, 248, 0.3);\r\n}\r\n\r\n.btn-secondary:hover {\r\n  background: rgba(255, 255, 255, 0.15);\r\n  border-color: rgba(129, 140, 248, 0.5);\r\n}\r\n\r\n/* =================================\r\n   画像プレビューモーダル\r\n   ================================= */\r\n\r\n.image-preview-modal {\r\n  position: fixed;\r\n  top: 0;\r\n  left: 0;\r\n  right: 0;\r\n  bottom: 0;\r\n  background: rgba(0, 0, 0, 0.9);\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  z-index: 2000;\r\n  backdrop-filter: blur(4px);\r\n}\r\n\r\n.preview-content {\r\n  position: relative;\r\n  max-width: 90vw;\r\n  max-height: 90vh;\r\n}\r\n\r\n.preview-image {\r\n  max-width: 100%;\r\n  max-height: 100%;\r\n  border-radius: 8px;\r\n}\r\n\r\n.close-preview-btn {\r\n  position: absolute;\r\n  top: 10px;\r\n  right: 10px;\r\n  width: 32px;\r\n  height: 32px;\r\n  border-radius: 50%;\r\n  background: rgba(0, 0, 0, 0.7);\r\n  border: none;\r\n  color: white;\r\n  cursor: pointer;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  font-size: 18px;\r\n}\r\n\r\n/* =================================\r\n   成功メッセージ\r\n   ================================= */\r\n\r\n.success-overlay {\r\n  position: absolute;\r\n  top: 0;\r\n  left: 0;\r\n  right: 0;\r\n  bottom: 0;\r\n  background: rgba(0, 0, 0, 0.8);\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  border-radius: 16px;\r\n  backdrop-filter: blur(4px);\r\n}\r\n\r\n.success-content {\r\n  text-align: center;\r\n  padding: var(--space-xl);\r\n  background: var(--bg-primary);\r\n  border-radius: 12px;\r\n  border: 2px solid rgba(34, 197, 94, 0.3);\r\n  max-width: 500px;\r\n}\r\n\r\n.success-icon {\r\n  font-size: 3rem;\r\n  margin-bottom: var(--space-md);\r\n}\r\n\r\n.success-title {\r\n  font-size: var(--text-xl);\r\n  font-weight: 700;\r\n  color: rgba(34, 197, 94, 1);\r\n  margin: 0 0 var(--space-lg) 0;\r\n}\r\n\r\n.success-details {\r\n  margin-bottom: var(--space-xl);\r\n}\r\n\r\n.report-id {\r\n  margin-bottom: var(--space-md);\r\n  color: rgba(255, 255, 255, 0.9);\r\n}\r\n\r\n.report-id code {\r\n  background: rgba(255, 255, 255, 0.1);\r\n  padding: var(--space-xs) var(--space-sm);\r\n  border-radius: 4px;\r\n  font-family: monospace;\r\n  color: rgba(129, 140, 248, 1);\r\n}\r\n\r\n.success-message {\r\n  color: rgba(255, 255, 255, 0.8);\r\n  line-height: 1.6;\r\n  margin: 0;\r\n}\r\n\r\n.success-actions {\r\n  display: flex;\r\n  gap: var(--space-md);\r\n  justify-content: center;\r\n}\r\n\r\n/* =================================\r\n   レスポンシブ\r\n   ================================= */\r\n\r\n@media (max-width: 768px) {\r\n  .bug-reporter-header {\r\n    flex-direction: column;\r\n    text-align: center;\r\n    gap: var(--space-md);\r\n  }\r\n\r\n  .category-btn {\r\n    flex: 1;\r\n  }\r\n\r\n  .screenshot-actions {\r\n    flex-direction: column;\r\n  }\r\n\r\n  .screenshots-preview {\r\n    grid-template-columns: 1fr;\r\n  }\r\n\r\n  .form-actions,\r\n  .success-actions {\r\n    flex-direction: column;\r\n  }\r\n\r\n  .contact-fields {\r\n    grid-template-columns: 1fr;\r\n  }\r\n}\r\n\r\n@media (max-width: 480px) {\r\n  .bug-report-form {\r\n    padding: var(--space-md);\r\n  }\r\n\r\n  .helper-tabs {\r\n    flex-direction: column;\r\n  }\r\n\r\n  .frequency-options {\r\n    gap: var(--space-xs);\r\n  }\r\n\r\n  .frequency-option {\r\n    flex-direction: column;\r\n    align-items: flex-start;\r\n    gap: var(--space-sm);\r\n  }\r\n}\r\n\r\n/* =================================\r\n   アクセシビリティ\r\n   ================================= */\r\n\r\n@media (prefers-reduced-motion: reduce) {\r\n  .category-btn,\r\n  .capture-btn,\r\n  .upload-btn,\r\n  .toggle-slider,\r\n  .btn-primary,\r\n  .btn-secondary {\r\n    transition: none;\r\n  }\r\n\r\n  .btn-primary:hover {\r\n    transform: none;\r\n  }\r\n}\r\n\r\n.bug-reporter:focus-within {\r\n  outline: 2px solid rgba(239, 68, 68, 0.8);\r\n  outline-offset: 2px;\r\n}\r\n\r\n.form-input:invalid,\r\n.form-textarea:invalid,\r\n.form-select:invalid {\r\n  border-color: #EF4444;\r\n}\r\n\r\n.form-input:invalid:focus,\r\n.form-textarea:invalid:focus,\r\n.form-select:invalid:focus {\r\n  border-color: #EF4444;\r\n  box-shadow: 0 0 0 3px rgba(239, 68, 68, 0.1);\r\n}\r\n</style>","<template>\r\n  <div class=\"feedback-button-container\">\r\n    <!-- フローティングアクションボタン -->\r\n    <button\r\n      v-if=\"!isExpanded\"\r\n      @click=\"expand\"\r\n      class=\"feedback-fab\"\r\n      :class=\"{ 'has-notifications': hasUnreadNotifications }\"\r\n      aria-label=\"フィードバックを送信\"\r\n      title=\"フィードバック・レビュー・バグ報告\"\r\n    >\r\n      <div class=\"fab-icon\">💬</div>\r\n      <div v-if=\"hasUnreadNotifications\" class=\"notification-badge\">\r\n        {{ unreadCount }}\r\n      </div>\r\n    </button>\r\n\r\n    <!-- 展開されたメニュー -->\r\n    <div v-else class=\"feedback-menu\" @click.stop>\r\n      <div class=\"menu-header\">\r\n        <h3 class=\"menu-title\">フィードバック</h3>\r\n        <button\r\n          @click=\"collapse\"\r\n          class=\"menu-close-btn\"\r\n          aria-label=\"メニューを閉じる\"\r\n        >\r\n          ×\r\n        </button>\r\n      </div>\r\n\r\n      <div class=\"menu-content\">\r\n        <!-- クイックアクション -->\r\n        <div class=\"quick-actions\">\r\n          <button\r\n            v-for=\"action in quickActions\"\r\n            :key=\"action.id\"\r\n            @click=\"handleQuickAction(action)\"\r\n            class=\"quick-action-btn\"\r\n            :class=\"{ 'high-priority': action.priority === 'high' }\"\r\n          >\r\n            <div class=\"action-icon\" :style=\"{ color: action.color }\">\r\n              {{ action.icon }}\r\n            </div>\r\n            <div class=\"action-content\">\r\n              <div class=\"action-title\">{{ action.title }}</div>\r\n              <div class=\"action-subtitle\">{{ action.subtitle }}</div>\r\n            </div>\r\n          </button>\r\n        </div>\r\n\r\n        <!-- コンテキスト情報 -->\r\n        <div v-if=\"gameContext\" class=\"context-info\">\r\n          <h4 class=\"context-title\">現在の状況</h4>\r\n          <div class=\"context-details\">\r\n            <div class=\"context-item\">\r\n              <span class=\"context-label\">ステージ:</span>\r\n              <span class=\"context-value\">{{ getStageLabel(gameContext.stage) }}</span>\r\n            </div>\r\n            <div class=\"context-item\">\r\n              <span class=\"context-label\">ターン:</span>\r\n              <span class=\"context-value\">{{ gameContext.turn }}</span>\r\n            </div>\r\n            <div class=\"context-item\">\r\n              <span class=\"context-label\">活力:</span>\r\n              <span class=\"context-value\">{{ gameContext.vitality }}</span>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <!-- 最近のフィードバック -->\r\n        <div v-if=\"recentFeedbacks.length > 0\" class=\"recent-feedback\">\r\n          <h4 class=\"recent-title\">最近の送信履歴</h4>\r\n          <div class=\"recent-list\">\r\n            <div\r\n              v-for=\"feedback in recentFeedbacks.slice(0, 3)\"\r\n              :key=\"feedback.id\"\r\n              class=\"recent-item\"\r\n            >\r\n              <div class=\"recent-icon\">{{ getCategoryIcon(feedback.category) }}</div>\r\n              <div class=\"recent-content\">\r\n                <div class=\"recent-title-text\">{{ feedback.title }}</div>\r\n                <div class=\"recent-meta\">\r\n                  {{ getRelativeTime(feedback.createdAt) }} • {{ getStatusLabel(feedback.status) }}\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <!-- 統計情報 -->\r\n        <div v-if=\"showStats && feedbackStats\" class=\"feedback-stats\">\r\n          <h4 class=\"stats-title\">フィードバック統計</h4>\r\n          <div class=\"stats-grid\">\r\n            <div class=\"stat-item\">\r\n              <div class=\"stat-value\">{{ feedbackStats.total }}</div>\r\n              <div class=\"stat-label\">総数</div>\r\n            </div>\r\n            <div class=\"stat-item\">\r\n              <div class=\"stat-value\">{{ feedbackStats.resolvedCount }}</div>\r\n              <div class=\"stat-label\">解決済み</div>\r\n            </div>\r\n            <div class=\"stat-item\">\r\n              <div class=\"stat-value\">{{ feedbackStats.averageSatisfactionRating?.toFixed(1) || 'N/A' }}</div>\r\n              <div class=\"stat-label\">満足度</div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- オーバーレイ -->\r\n    <div\r\n      v-if=\"isExpanded\"\r\n      class=\"feedback-overlay\"\r\n      @click=\"collapse\"\r\n    ></div>\r\n\r\n    <!-- モーダル -->\r\n    <FeedbackModal\r\n      :is-open=\"showFeedbackModal\"\r\n      :game-state=\"gameContext\"\r\n      @close=\"showFeedbackModal = false\"\r\n      @feedback-submitted=\"handleFeedbackSubmitted\"\r\n    />\r\n\r\n    <ReviewSystem\r\n      v-if=\"showReviewModal\"\r\n      :mode=\"reviewMode\"\r\n      :game-state=\"gameContext\"\r\n      @review-submitted=\"handleReviewSubmitted\"\r\n      @mode-changed=\"reviewMode = $event\"\r\n      class=\"review-modal\"\r\n    />\r\n\r\n    <div v-if=\"showBugReporter\" class=\"bug-reporter-modal\">\r\n      <div class=\"modal-overlay\" @click=\"showBugReporter = false\">\r\n        <div class=\"modal-content\" @click.stop>\r\n          <BugReporter\r\n            :game-state=\"gameContext\"\r\n            @bug-reported=\"handleBugReported\"\r\n            @close=\"showBugReporter = false\"\r\n          />\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- 通知トースト -->\r\n    <div v-if=\"showToast\" class=\"feedback-toast\" :class=\"`toast-${toastType}`\">\r\n      <div class=\"toast-icon\">{{ getToastIcon(toastType) }}</div>\r\n      <div class=\"toast-content\">\r\n        <div class=\"toast-title\">{{ toastTitle }}</div>\r\n        <div class=\"toast-message\">{{ toastMessage }}</div>\r\n      </div>\r\n      <button @click=\"hideToast\" class=\"toast-close\">×</button>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup lang=\"ts\">\r\nimport { ref, computed, onMounted, onUnmounted } from 'vue'\r\nimport FeedbackModal from './FeedbackModal.vue'\r\nimport ReviewSystem from './ReviewSystem.vue'\r\nimport BugReporter from './BugReporter.vue'\r\nimport { FeedbackManagementService, type FeedbackStatistics } from '../../domain/services/FeedbackManagementService'\r\nimport { FeedbackCategory, FeedbackStatus } from '../../domain/entities/Feedback'\r\n\r\n// Props\r\ninterface Props {\r\n  gameState?: {\r\n    stage: string\r\n    turn: number\r\n    vitality: number\r\n    phase: string\r\n  }\r\n  position?: 'bottom-right' | 'bottom-left' | 'top-right' | 'top-left'\r\n  showStats?: boolean\r\n  autoSurvey?: boolean\r\n}\r\n\r\nconst props = withDefaults(defineProps<Props>(), {\r\n  position: 'bottom-right',\r\n  showStats: false,\r\n  autoSurvey: true\r\n})\r\n\r\n// Emits\r\nconst emit = defineEmits<{\r\n  feedbackSubmitted: [feedbackId: string, type: string]\r\n}>()\r\n\r\n// Services\r\nconst feedbackService = new FeedbackManagementService()\r\n\r\n// State\r\nconst isExpanded = ref(false)\r\nconst showFeedbackModal = ref(false)\r\nconst showReviewModal = ref(false)\r\nconst showBugReporter = ref(false)\r\nconst reviewMode = ref<'quick' | 'detailed'>('quick')\r\nconst recentFeedbacks = ref<any[]>([])\r\nconst feedbackStats = ref<FeedbackStatistics | null>(null)\r\nconst gameContext = ref(props.gameState)\r\n\r\n// Toast notifications\r\nconst showToast = ref(false)\r\nconst toastType = ref<'success' | 'info' | 'warning' | 'error'>('success')\r\nconst toastTitle = ref('')\r\nconst toastMessage = ref('')\r\nlet toastTimeout: number | null = null\r\n\r\n// Quick Actions\r\nconst quickActions = [\r\n  {\r\n    id: 'review',\r\n    title: '評価・レビュー',\r\n    subtitle: 'ゲームの感想を教えてください',\r\n    icon: '⭐',\r\n    color: '#F59E0B',\r\n    priority: 'normal'\r\n  },\r\n  {\r\n    id: 'bug',\r\n    title: 'バグ報告',\r\n    subtitle: '問題や不具合を報告',\r\n    icon: '🐛',\r\n    color: '#EF4444',\r\n    priority: 'high'\r\n  },\r\n  {\r\n    id: 'feature',\r\n    title: '機能要望',\r\n    subtitle: '新機能のアイデアを提案',\r\n    icon: '💡',\r\n    color: '#3B82F6',\r\n    priority: 'normal'\r\n  },\r\n  {\r\n    id: 'general',\r\n    title: 'その他',\r\n    subtitle: 'ご質問・ご意見など',\r\n    icon: '💬',\r\n    color: '#8B5CF6',\r\n    priority: 'normal'\r\n  }\r\n]\r\n\r\n// Computed\r\nconst hasUnreadNotifications = computed(() => {\r\n  // 実際の実装では未読通知の状態を管理\r\n  return false\r\n})\r\n\r\nconst unreadCount = computed(() => {\r\n  // 実際の実装では未読通知数を計算\r\n  return 0\r\n})\r\n\r\n// Methods\r\nconst expand = () => {\r\n  isExpanded.value = true\r\n  loadRecentFeedbacks()\r\n  if (props.showStats) {\r\n    loadFeedbackStats()\r\n  }\r\n}\r\n\r\nconst collapse = () => {\r\n  isExpanded.value = false\r\n}\r\n\r\nconst handleQuickAction = (action: any) => {\r\n  collapse()\r\n  \r\n  switch (action.id) {\r\n    case 'review':\r\n      showReviewModal.value = true\r\n      break\r\n    case 'bug':\r\n      showBugReporter.value = true\r\n      break\r\n    default:\r\n      showFeedbackModal.value = true\r\n      break\r\n  }\r\n}\r\n\r\nconst handleFeedbackSubmitted = (feedbackId: string) => {\r\n  showFeedbackModal.value = false\r\n  showSuccessToast('フィードバックを送信しました', 'ご意見をありがとうございます')\r\n  emit('feedbackSubmitted', feedbackId, 'general')\r\n  loadRecentFeedbacks()\r\n}\r\n\r\nconst handleReviewSubmitted = (reviewId: string) => {\r\n  showReviewModal.value = false\r\n  showSuccessToast('レビューを送信しました', 'ご評価をありがとうございます')\r\n  emit('feedbackSubmitted', reviewId, 'review')\r\n  loadRecentFeedbacks()\r\n}\r\n\r\nconst handleBugReported = (reportId: string) => {\r\n  showBugReporter.value = false\r\n  showSuccessToast('バグレポートを送信しました', `レポートID: ${  reportId.substring(0, 8)}`)\r\n  emit('feedbackSubmitted', reportId, 'bug')\r\n  loadRecentFeedbacks()\r\n}\r\n\r\nconst loadRecentFeedbacks = () => {\r\n  try {\r\n    const feedbacks = feedbackService.searchFeedbacks({\r\n      dateRange: {\r\n        start: new Date(Date.now() - 7 * 24 * 60 * 60 * 1000), // 7日前から\r\n        end: new Date()\r\n      }\r\n    })\r\n    recentFeedbacks.value = feedbacks.slice(0, 5)\r\n  } catch (error) {\r\n    console.error('Failed to load recent feedbacks:', error)\r\n  }\r\n}\r\n\r\nconst loadFeedbackStats = () => {\r\n  try {\r\n    feedbackStats.value = feedbackService.getStatistics()\r\n  } catch (error) {\r\n    console.error('Failed to load feedback stats:', error)\r\n  }\r\n}\r\n\r\nconst getStageLabel = (stage: string): string => {\r\n  const labels: Record<string, string> = {\r\n    youth: '青年期',\r\n    middle: '中年期',\r\n    senior: '充実期'\r\n  }\r\n  return labels[stage] || stage\r\n}\r\n\r\nconst getCategoryIcon = (category: FeedbackCategory): string => {\r\n  const icons: Record<FeedbackCategory, string> = {\r\n    [FeedbackCategory.BUG_REPORT]: '🐛',\r\n    [FeedbackCategory.FEATURE_REQUEST]: '💡',\r\n    [FeedbackCategory.UI_UX]: '🎨',\r\n    [FeedbackCategory.GAMEPLAY]: '🎮',\r\n    [FeedbackCategory.PERFORMANCE]: '⚡',\r\n    [FeedbackCategory.ACCESSIBILITY]: '♿',\r\n    [FeedbackCategory.GENERAL]: '💬'\r\n  }\r\n  return icons[category] || '📝'\r\n}\r\n\r\nconst getStatusLabel = (status: FeedbackStatus): string => {\r\n  const labels: Record<FeedbackStatus, string> = {\r\n    [FeedbackStatus.SUBMITTED]: '提出済み',\r\n    [FeedbackStatus.UNDER_REVIEW]: '確認中',\r\n    [FeedbackStatus.IN_PROGRESS]: '対応中',\r\n    [FeedbackStatus.RESOLVED]: '解決済み',\r\n    [FeedbackStatus.CLOSED]: '完了'\r\n  }\r\n  return labels[status] || status\r\n}\r\n\r\nconst getRelativeTime = (date: Date): string => {\r\n  const now = new Date()\r\n  const diffMs = now.getTime() - date.getTime()\r\n  const diffMins = Math.floor(diffMs / (1000 * 60))\r\n  const diffHours = Math.floor(diffMs / (1000 * 60 * 60))\r\n  const diffDays = Math.floor(diffMs / (1000 * 60 * 60 * 24))\r\n\r\n  if (diffMins < 1) return 'たった今'\r\n  if (diffMins < 60) return `${diffMins}分前`\r\n  if (diffHours < 24) return `${diffHours}時間前`\r\n  if (diffDays < 7) return `${diffDays}日前`\r\n  return date.toLocaleDateString('ja-JP')\r\n}\r\n\r\nconst showSuccessToast = (title: string, message: string) => {\r\n  showToast.value = true\r\n  toastType.value = 'success'\r\n  toastTitle.value = title\r\n  toastMessage.value = message\r\n  \r\n  if (toastTimeout) {\r\n    clearTimeout(toastTimeout)\r\n  }\r\n  toastTimeout = window.setTimeout(() => {\r\n    hideToast()\r\n  }, 5000)\r\n}\r\n\r\nconst showErrorToast = (title: string, message: string) => {\r\n  showToast.value = true\r\n  toastType.value = 'error'\r\n  toastTitle.value = title\r\n  toastMessage.value = message\r\n  \r\n  if (toastTimeout) {\r\n    clearTimeout(toastTimeout)\r\n  }\r\n  toastTimeout = window.setTimeout(() => {\r\n    hideToast()\r\n  }, 7000)\r\n}\r\n\r\nconst hideToast = () => {\r\n  showToast.value = false\r\n  if (toastTimeout) {\r\n    clearTimeout(toastTimeout)\r\n    toastTimeout = null\r\n  }\r\n}\r\n\r\nconst getToastIcon = (type: string): string => {\r\n  const icons = {\r\n    success: '✅',\r\n    info: 'ℹ️',\r\n    warning: '⚠️',\r\n    error: '❌'\r\n  }\r\n  return icons[type as keyof typeof icons] || 'ℹ️'\r\n}\r\n\r\n// 自動満足度調査\r\nconst checkAutoSurvey = () => {\r\n  if (!props.autoSurvey || !gameContext.value) return\r\n\r\n  // 特定の条件で自動的に満足度調査を表示\r\n  // 例：ゲーム終了時、一定ターン経過時など\r\n  const shouldShowSurvey = \r\n    gameContext.value.turn > 10 && \r\n    gameContext.value.turn % 20 === 0 && // 20ターンごと\r\n    Math.random() < 0.3 // 30%の確率\r\n\r\n  if (shouldShowSurvey) {\r\n    setTimeout(() => {\r\n      reviewMode.value = 'quick'\r\n      showReviewModal.value = true\r\n    }, 2000) // 2秒後に表示\r\n  }\r\n}\r\n\r\n// Lifecycle\r\nonMounted(() => {\r\n  // ゲーム状態の変化を監視\r\n  if (props.gameState) {\r\n    gameContext.value = props.gameState\r\n  }\r\n\r\n  // 初回データ読み込み\r\n  loadRecentFeedbacks()\r\n\r\n  // 自動調査チェック\r\n  checkAutoSurvey()\r\n\r\n  // ESCキーでメニューを閉じる\r\n  const handleEscape = (event: KeyboardEvent) => {\r\n    if (event.key === 'Escape' && isExpanded.value) {\r\n      collapse()\r\n    }\r\n  }\r\n  document.addEventListener('keydown', handleEscape)\r\n\r\n  // クリーンアップ用に記録\r\n  onUnmounted(() => {\r\n    document.removeEventListener('keydown', handleEscape)\r\n    if (toastTimeout) {\r\n      clearTimeout(toastTimeout)\r\n    }\r\n  })\r\n})\r\n\r\n// ゲーム状態の更新を監視\r\nconst updateGameContext = (newState: any) => {\r\n  gameContext.value = newState\r\n  checkAutoSurvey()\r\n}\r\n\r\n// 外部から呼び出し可能な公開メソッド\r\ndefineExpose({\r\n  expand,\r\n  collapse,\r\n  showReview: () => { showReviewModal.value = true },\r\n  showBugReport: () => { showBugReporter.value = true },\r\n  showFeedback: () => { showFeedbackModal.value = true },\r\n  updateGameContext\r\n})\r\n</script>\r\n\r\n<style scoped>\r\n/* =================================\r\n   フィードバックボタンベース\r\n   ================================= */\r\n\r\n.feedback-button-container {\r\n  position: fixed;\r\n  z-index: 1000;\r\n}\r\n\r\n/* ポジション設定 */\r\n.feedback-button-container {\r\n  bottom: var(--space-lg);\r\n  right: var(--space-lg);\r\n}\r\n\r\n/* =================================\r\n   フローティングアクションボタン\r\n   ================================= */\r\n\r\n.feedback-fab {\r\n  position: relative;\r\n  width: 60px;\r\n  height: 60px;\r\n  border-radius: 50%;\r\n  background: var(--primary-gradient);\r\n  border: none;\r\n  cursor: pointer;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  box-shadow: 0 8px 25px rgba(129, 140, 248, 0.4);\r\n  transition: all var(--transition-normal);\r\n  backdrop-filter: blur(8px);\r\n}\r\n\r\n.feedback-fab:hover {\r\n  transform: translateY(-4px) scale(1.1);\r\n  box-shadow: 0 12px 40px rgba(129, 140, 248, 0.5);\r\n}\r\n\r\n.feedback-fab.has-notifications {\r\n  animation: pulse 2s infinite;\r\n}\r\n\r\n@keyframes pulse {\r\n  0%, 100% { transform: scale(1); }\r\n  50% { transform: scale(1.05); }\r\n}\r\n\r\n.fab-icon {\r\n  font-size: 1.5rem;\r\n  color: white;\r\n}\r\n\r\n.notification-badge {\r\n  position: absolute;\r\n  top: -4px;\r\n  right: -4px;\r\n  width: 20px;\r\n  height: 20px;\r\n  border-radius: 50%;\r\n  background: #EF4444;\r\n  color: white;\r\n  font-size: var(--text-xs);\r\n  font-weight: 700;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  border: 2px solid white;\r\n}\r\n\r\n/* =================================\r\n   展開メニュー\r\n   ================================= */\r\n\r\n.feedback-menu {\r\n  position: absolute;\r\n  bottom: 80px;\r\n  right: 0;\r\n  width: 320px;\r\n  max-height: 500px;\r\n  background: var(--bg-primary);\r\n  border-radius: 16px;\r\n  border: 1px solid rgba(129, 140, 248, 0.3);\r\n  box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);\r\n  backdrop-filter: blur(12px);\r\n  overflow: hidden;\r\n  animation: menuSlideIn 0.3s ease-out;\r\n}\r\n\r\n@keyframes menuSlideIn {\r\n  from {\r\n    opacity: 0;\r\n    transform: translateY(20px) scale(0.95);\r\n  }\r\n  to {\r\n    opacity: 1;\r\n    transform: translateY(0) scale(1);\r\n  }\r\n}\r\n\r\n.menu-header {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  padding: var(--space-md) var(--space-lg);\r\n  background: rgba(129, 140, 248, 0.1);\r\n  border-bottom: 1px solid rgba(129, 140, 248, 0.2);\r\n}\r\n\r\n.menu-title {\r\n  font-size: var(--text-lg);\r\n  font-weight: 700;\r\n  color: rgba(129, 140, 248, 1);\r\n  margin: 0;\r\n}\r\n\r\n.menu-close-btn {\r\n  width: 24px;\r\n  height: 24px;\r\n  border-radius: 50%;\r\n  background: none;\r\n  border: none;\r\n  color: rgba(255, 255, 255, 0.7);\r\n  cursor: pointer;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  font-size: var(--text-lg);\r\n  transition: all var(--transition-fast);\r\n}\r\n\r\n.menu-close-btn:hover {\r\n  background: rgba(255, 255, 255, 0.1);\r\n  color: rgba(255, 255, 255, 1);\r\n}\r\n\r\n.menu-content {\r\n  padding: var(--space-lg);\r\n  max-height: 400px;\r\n  overflow-y: auto;\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: var(--space-lg);\r\n}\r\n\r\n/* =================================\r\n   クイックアクション\r\n   ================================= */\r\n\r\n.quick-actions {\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: var(--space-sm);\r\n}\r\n\r\n.quick-action-btn {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: var(--space-md);\r\n  padding: var(--space-md);\r\n  background: rgba(255, 255, 255, 0.05);\r\n  border: 2px solid rgba(129, 140, 248, 0.2);\r\n  border-radius: 8px;\r\n  cursor: pointer;\r\n  transition: all var(--transition-fast);\r\n  text-align: left;\r\n  width: 100%;\r\n}\r\n\r\n.quick-action-btn:hover {\r\n  border-color: rgba(129, 140, 248, 0.5);\r\n  background: rgba(129, 140, 248, 0.1);\r\n  transform: translateY(-2px);\r\n}\r\n\r\n.quick-action-btn.high-priority {\r\n  border-color: rgba(239, 68, 68, 0.3);\r\n}\r\n\r\n.quick-action-btn.high-priority:hover {\r\n  border-color: rgba(239, 68, 68, 0.6);\r\n  background: rgba(239, 68, 68, 0.1);\r\n}\r\n\r\n.action-icon {\r\n  font-size: var(--text-xl);\r\n  width: 32px;\r\n  text-align: center;\r\n  flex-shrink: 0;\r\n}\r\n\r\n.action-content {\r\n  flex: 1;\r\n}\r\n\r\n.action-title {\r\n  font-weight: 600;\r\n  color: rgba(255, 255, 255, 0.95);\r\n  margin-bottom: var(--space-xs);\r\n}\r\n\r\n.action-subtitle {\r\n  font-size: var(--text-sm);\r\n  color: rgba(255, 255, 255, 0.7);\r\n}\r\n\r\n/* =================================\r\n   コンテキスト情報\r\n   ================================= */\r\n\r\n.context-info {\r\n  padding: var(--space-md);\r\n  background: rgba(255, 255, 255, 0.03);\r\n  border-radius: 8px;\r\n  border: 1px solid rgba(129, 140, 248, 0.1);\r\n}\r\n\r\n.context-title {\r\n  font-size: var(--text-sm);\r\n  font-weight: 600;\r\n  color: rgba(255, 255, 255, 0.8);\r\n  margin: 0 0 var(--space-sm) 0;\r\n}\r\n\r\n.context-details {\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: var(--space-xs);\r\n}\r\n\r\n.context-item {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  font-size: var(--text-sm);\r\n}\r\n\r\n.context-label {\r\n  color: rgba(255, 255, 255, 0.6);\r\n}\r\n\r\n.context-value {\r\n  color: rgba(255, 255, 255, 0.9);\r\n  font-weight: 600;\r\n}\r\n\r\n/* =================================\r\n   最近のフィードバック\r\n   ================================= */\r\n\r\n.recent-feedback {\r\n  border-top: 1px solid rgba(129, 140, 248, 0.1);\r\n  padding-top: var(--space-md);\r\n}\r\n\r\n.recent-title {\r\n  font-size: var(--text-sm);\r\n  font-weight: 600;\r\n  color: rgba(255, 255, 255, 0.8);\r\n  margin: 0 0 var(--space-sm) 0;\r\n}\r\n\r\n.recent-list {\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: var(--space-sm);\r\n}\r\n\r\n.recent-item {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: var(--space-sm);\r\n  padding: var(--space-sm);\r\n  background: rgba(255, 255, 255, 0.03);\r\n  border-radius: 6px;\r\n}\r\n\r\n.recent-icon {\r\n  font-size: var(--text-base);\r\n  width: 24px;\r\n  text-align: center;\r\n  flex-shrink: 0;\r\n}\r\n\r\n.recent-content {\r\n  flex: 1;\r\n  min-width: 0;\r\n}\r\n\r\n.recent-title-text {\r\n  font-size: var(--text-sm);\r\n  color: rgba(255, 255, 255, 0.9);\r\n  white-space: nowrap;\r\n  overflow: hidden;\r\n  text-overflow: ellipsis;\r\n  margin-bottom: 2px;\r\n}\r\n\r\n.recent-meta {\r\n  font-size: var(--text-xs);\r\n  color: rgba(255, 255, 255, 0.6);\r\n}\r\n\r\n/* =================================\r\n   統計情報\r\n   ================================= */\r\n\r\n.feedback-stats {\r\n  border-top: 1px solid rgba(129, 140, 248, 0.1);\r\n  padding-top: var(--space-md);\r\n}\r\n\r\n.stats-title {\r\n  font-size: var(--text-sm);\r\n  font-weight: 600;\r\n  color: rgba(255, 255, 255, 0.8);\r\n  margin: 0 0 var(--space-sm) 0;\r\n}\r\n\r\n.stats-grid {\r\n  display: grid;\r\n  grid-template-columns: repeat(3, 1fr);\r\n  gap: var(--space-sm);\r\n}\r\n\r\n.stat-item {\r\n  text-align: center;\r\n  padding: var(--space-sm);\r\n  background: rgba(255, 255, 255, 0.03);\r\n  border-radius: 6px;\r\n}\r\n\r\n.stat-value {\r\n  font-size: var(--text-lg);\r\n  font-weight: 700;\r\n  color: rgba(129, 140, 248, 1);\r\n  margin-bottom: 2px;\r\n}\r\n\r\n.stat-label {\r\n  font-size: var(--text-xs);\r\n  color: rgba(255, 255, 255, 0.6);\r\n}\r\n\r\n/* =================================\r\n   オーバーレイ\r\n   ================================= */\r\n\r\n.feedback-overlay {\r\n  position: fixed;\r\n  top: 0;\r\n  left: 0;\r\n  right: 0;\r\n  bottom: 0;\r\n  background: rgba(0, 0, 0, 0.3);\r\n  z-index: -1;\r\n}\r\n\r\n/* =================================\r\n   モーダル\r\n   ================================= */\r\n\r\n.review-modal {\r\n  position: fixed;\r\n  top: 50%;\r\n  left: 50%;\r\n  transform: translate(-50%, -50%);\r\n  z-index: 1100;\r\n  max-width: 90vw;\r\n  max-height: 90vh;\r\n  overflow-y: auto;\r\n}\r\n\r\n.bug-reporter-modal {\r\n  position: fixed;\r\n  top: 0;\r\n  left: 0;\r\n  right: 0;\r\n  bottom: 0;\r\n  z-index: 1100;\r\n}\r\n\r\n.modal-overlay {\r\n  position: absolute;\r\n  top: 0;\r\n  left: 0;\r\n  right: 0;\r\n  bottom: 0;\r\n  background: rgba(0, 0, 0, 0.8);\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  padding: var(--space-md);\r\n  backdrop-filter: blur(4px);\r\n}\r\n\r\n.modal-content {\r\n  width: 100%;\r\n  max-width: 800px;\r\n  max-height: 90vh;\r\n  overflow-y: auto;\r\n}\r\n\r\n/* =================================\r\n   トースト通知\r\n   ================================= */\r\n\r\n.feedback-toast {\r\n  position: fixed;\r\n  top: var(--space-lg);\r\n  right: var(--space-lg);\r\n  z-index: 1200;\r\n  display: flex;\r\n  align-items: center;\r\n  gap: var(--space-md);\r\n  padding: var(--space-md) var(--space-lg);\r\n  background: var(--bg-primary);\r\n  border-radius: 8px;\r\n  border-left: 4px solid;\r\n  box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);\r\n  max-width: 400px;\r\n  animation: toastSlideIn 0.3s ease-out;\r\n}\r\n\r\n@keyframes toastSlideIn {\r\n  from {\r\n    opacity: 0;\r\n    transform: translateX(100%);\r\n  }\r\n  to {\r\n    opacity: 1;\r\n    transform: translateX(0);\r\n  }\r\n}\r\n\r\n.toast-success {\r\n  border-left-color: #10B981;\r\n}\r\n\r\n.toast-error {\r\n  border-left-color: #EF4444;\r\n}\r\n\r\n.toast-warning {\r\n  border-left-color: #F59E0B;\r\n}\r\n\r\n.toast-info {\r\n  border-left-color: #3B82F6;\r\n}\r\n\r\n.toast-icon {\r\n  font-size: var(--text-xl);\r\n  flex-shrink: 0;\r\n}\r\n\r\n.toast-content {\r\n  flex: 1;\r\n  min-width: 0;\r\n}\r\n\r\n.toast-title {\r\n  font-weight: 600;\r\n  color: rgba(255, 255, 255, 0.95);\r\n  margin-bottom: var(--space-xs);\r\n}\r\n\r\n.toast-message {\r\n  font-size: var(--text-sm);\r\n  color: rgba(255, 255, 255, 0.8);\r\n}\r\n\r\n.toast-close {\r\n  background: none;\r\n  border: none;\r\n  color: rgba(255, 255, 255, 0.6);\r\n  cursor: pointer;\r\n  padding: var(--space-xs);\r\n  font-size: var(--text-lg);\r\n  line-height: 1;\r\n  flex-shrink: 0;\r\n}\r\n\r\n.toast-close:hover {\r\n  color: rgba(255, 255, 255, 0.9);\r\n}\r\n\r\n/* =================================\r\n   レスポンシブ\r\n   ================================= */\r\n\r\n@media (max-width: 768px) {\r\n  .feedback-button-container {\r\n    bottom: var(--space-md);\r\n    right: var(--space-md);\r\n  }\r\n\r\n  .feedback-menu {\r\n    width: 280px;\r\n    bottom: 70px;\r\n    right: -20px;\r\n  }\r\n\r\n  .feedback-toast {\r\n    top: var(--space-md);\r\n    right: var(--space-md);\r\n    left: var(--space-md);\r\n    max-width: none;\r\n  }\r\n\r\n  .stats-grid {\r\n    grid-template-columns: repeat(2, 1fr);\r\n  }\r\n}\r\n\r\n@media (max-width: 480px) {\r\n  .feedback-fab {\r\n    width: 56px;\r\n    height: 56px;\r\n  }\r\n\r\n  .feedback-menu {\r\n    width: calc(100vw - 2 * var(--space-md));\r\n    right: 0;\r\n    left: var(--space-md);\r\n    bottom: 70px;\r\n  }\r\n\r\n  .modal-content {\r\n    margin: var(--space-sm);\r\n  }\r\n}\r\n\r\n/* =================================\r\n   アクセシビリティ\r\n   ================================= */\r\n\r\n@media (prefers-reduced-motion: reduce) {\r\n  .feedback-fab,\r\n  .quick-action-btn,\r\n  .feedback-toast {\r\n    transition: none;\r\n    animation: none;\r\n  }\r\n\r\n  .feedback-fab:hover,\r\n  .quick-action-btn:hover {\r\n    transform: none;\r\n  }\r\n\r\n  .feedback-fab.has-notifications {\r\n    animation: none;\r\n  }\r\n}\r\n\r\n.feedback-fab:focus,\r\n.quick-action-btn:focus,\r\n.menu-close-btn:focus,\r\n.toast-close:focus {\r\n  outline: 2px solid rgba(129, 140, 248, 0.8);\r\n  outline-offset: 2px;\r\n}\r\n\r\n/* ハイコントラストモード */\r\n@media (prefers-contrast: high) {\r\n  .feedback-menu {\r\n    border: 2px solid white;\r\n    background: #000;\r\n  }\r\n\r\n  .quick-action-btn {\r\n    border: 2px solid white;\r\n  }\r\n\r\n  .feedback-toast {\r\n    border: 2px solid white;\r\n    background: #000;\r\n  }\r\n}\r\n</style>"],"names":["props","__props","emit","__emit","feedbackService","FeedbackManagementService","currentStep","ref","selectedType","isSubmitting","isAnonymous","includeScreenshot","formData","reactive","feedbackOptions","aspectRatings","isFormValid","computed","selectFeedbackType","type","goBack","close","resetForm","closeOnOverlay","event","setRating","rating","getStepTitle","option","opt","getDescriptionPlaceholder","getCategoryFromType","FeedbackCategory","submitFeedback","__async","screenshot","captureScreenshot","systemInfo","submitter","generateSessionId","createParams","step","calculatePlayTime","feedback","trackFeedbackSubmission","error","canvas","ctx","feedbackId","watch","isOpen","onMounted","_createElementBlock","_createElementVNode","_hoisted_1","_hoisted_2","_toDisplayString","_openBlock","_hoisted_3","_cache","_hoisted_4","_Fragment","_renderList","$event","_normalizeStyle","_hoisted_6","_hoisted_7","_hoisted_8","_hoisted_9","_hoisted_10","_hoisted_11","_hoisted_12","_hoisted_13","_hoisted_14","star","_normalizeClass","_hoisted_15","_hoisted_16","aspect","_hoisted_17","_hoisted_18","_hoisted_19","_hoisted_20","_hoisted_21","_hoisted_22","_vModelText","_hoisted_23","_hoisted_24","_hoisted_26","_hoisted_27","_hoisted_28","_hoisted_29","_hoisted_30","_hoisted_31","_hoisted_32","_hoisted_33","_hoisted_34","_hoisted_35","_hoisted_36","_hoisted_37","_hoisted_38","_hoisted_39","_hoisted_43","_hoisted_44","currentMode","selectedQuickRating","hoverOverallRating","overallRating","reviewComment","recommendationScore","selectedPlaytime","selectedTags","selectedPrompt","showSuccessMessage","aspectRatingsData","quickRatings","commentPrompts","availableTags","playtimeOptions","submitQuickRating","_a","r","expandToFullReview","key","switchToQuickMode","setOverallRating","setAspectRating","selectCommentPrompt","prompt","toggleTag","tagId","index","submitDetailedReview","getRatingDescription","getPlayTimeInMinutes","closeSuccessMessage","newMode","mode","_hoisted_5","_hoisted_25","n","tag","_hoisted_40","_hoisted_41","_hoisted_42","_hoisted_47","stepsInputMode","guidedSteps","screenshots","isCapturing","includeSystemInfo","provideContact","submittedReportId","previewImageUrl","selectedCategory","severityDescription","bugCategories","frequencyOptions","selectCategory","category","getTitlePlaceholder","updateSeverityDescription","descriptions","addStep","removeStep","updateStepsFromGuided","dataUrl","size","handleFileUpload","target","files","file","reader","e","result","removeScreenshot","previewImage","imageData","closeImagePreview","formatFileSize","bytes","k","sizes","i","getBrowserName","userAgent","getGameStateText","submitBugReport","bugReportData","tags","createAnotherReport","closeReporter","_vModelSelect","freq","_vModelRadio","$refs","_hoisted_45","_hoisted_46","_hoisted_48","_hoisted_49","_hoisted_50","_hoisted_51","_hoisted_52","_hoisted_53","_hoisted_54","_hoisted_55","_hoisted_56","_hoisted_57","_hoisted_58","_hoisted_59","_hoisted_60","_hoisted_61","_hoisted_62","_hoisted_63","_hoisted_64","_hoisted_65","_hoisted_70","_hoisted_71","_hoisted_72","_hoisted_73","_hoisted_74","isExpanded","showFeedbackModal","showReviewModal","showBugReporter","reviewMode","recentFeedbacks","feedbackStats","gameContext","showToast","toastType","toastTitle","toastMessage","toastTimeout","quickActions","hasUnreadNotifications","unreadCount","expand","loadRecentFeedbacks","loadFeedbackStats","collapse","handleQuickAction","action","handleFeedbackSubmitted","showSuccessToast","handleReviewSubmitted","reviewId","handleBugReported","reportId","feedbacks","getStageLabel","stage","getCategoryIcon","getStatusLabel","status","FeedbackStatus","getRelativeTime","date","diffMs","diffMins","diffHours","diffDays","title","message","hideToast","getToastIcon","checkAutoSurvey","handleEscape","onUnmounted","__expose","newState","showStats","_createVNode","FeedbackModal","_createBlock","ReviewSystem","BugReporter"],"mappings":"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"}