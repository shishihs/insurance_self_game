var ae=(z,W,x)=>new Promise((F,q)=>{var w=h=>{try{k(x.next(h))}catch($){q($)}},m=h=>{try{k(x.throw(h))}catch($){q($)}},k=h=>h.done?F(h.value):Promise.resolve(h.value).then(w,m);k((x=x.apply(z,W)).next())});import{d as pe,f,m as ge,g as ce,w as _e,h as he,c as i,b as C,o as l,a as e,t as d,F as U,r as A,e as ye,p as le,j as _,v as fe,q as ve,n as D,k as N,s as re,u as M,x as we,i as Re,l as $e,y as xe}from"./vue-vendor-Dh8Oc06C.js";import{F as me,a as L,b as ne}from"./game-logic-DYTtuDyT.js";import{_ as be}from"./analytics-ImNIcNXw.js";import"./vendor-CLepEF8l.js";import"./chart-vendor-Xt8I3p8E.js";const Se={class:"feedback-header"},Ce={id:"feedback-title",class:"feedback-title"},Be={key:0,class:"feedback-selection"},Te={class:"feedback-options"},Fe=["onClick","aria-describedby"],Ee={class:"option-content"},Me={class:"option-title"},Ue=["id"],Ae={key:0,class:"bug-report-fields"},Ie={class:"form-group"},Ve={class:"form-group"},De={key:1,class:"review-fields"},qe={class:"form-group"},Ne={class:"star-rating"},Le=["onClick","aria-label"],Oe={class:"aspect-ratings"},Pe={class:"form-label"},je={class:"star-rating"},Ge=["onClick","aria-label"],ze={class:"form-group"},We={class:"form-label"},He={class:"form-group"},Qe={class:"character-count"},Xe={class:"form-group"},Ye=["placeholder"],Je={class:"character-count"},Ke={key:2,class:"bug-specific-fields"},Ze={class:"form-group"},et={class:"form-group"},tt={class:"form-group"},st={class:"form-group"},ot={class:"form-label"},at={class:"submitter-section"},lt={class:"form-group"},it={class:"form-label"},nt={key:0,class:"contact-fields"},rt={class:"form-group"},ct={class:"form-group"},dt={class:"form-actions"},ut=["disabled"],vt={key:0},pt={key:1},mt={key:2,class:"success-message"},bt={class:"success-description"},ft=pe({__name:"FeedbackModal",props:{isOpen:{type:Boolean,default:!1},gameState:{}},emits:["close","feedbackSubmitted"],setup(z,{emit:W}){const x=z,F=W,q=new me,w=f("selection"),m=f(""),k=f(!1),h=f(!0),$=f(!1),a=ge({title:"",description:"",submitter:{name:"",email:""},bugReport:{severity:"",reproductionRate:"",stepsToReproduce:"",expectedBehavior:"",actualBehavior:""},review:{overallRating:0,aspects:{gameplay:0,ui:0,performance:0,accessibility:0},wouldRecommend:!1}}),B=[{type:"bug",title:"バグ報告",description:"動作不良や予期しない動作を報告",icon:"🐛",color:"#EF4444"},{type:"feature",title:"機能要望",description:"新しい機能やゲームプレイの改善案",icon:"💡",color:"#3B82F6"},{type:"ui",title:"UI/UX改善",description:"インターフェースの使いやすさ向上",icon:"🎨",color:"#8B5CF6"},{type:"review",title:"評価・レビュー",description:"ゲーム全体の評価とご感想",icon:"⭐",color:"#F59E0B"},{type:"accessibility",title:"アクセシビリティ",description:"バリアフリー・操作性の改善提案",icon:"♿",color:"#10B981"},{type:"general",title:"その他",description:"上記以外のご意見・ご質問",icon:"💬",color:"#6B7280"}],E=[{key:"gameplay",label:"ゲームプレイ"},{key:"ui",label:"UI・操作性"},{key:"performance",label:"パフォーマンス"},{key:"accessibility",label:"アクセシビリティ"}],R=ce(()=>!a.title.trim()||!a.description.trim()?!1:m.value==="bug"?a.bugReport.severity&&a.bugReport.reproductionRate&&a.bugReport.stepsToReproduce.trim():m.value==="review"?a.review.overallRating>0:!0),I=b=>{m.value=b,w.value="form"},T=()=>{w.value==="form"&&(w.value="selection")},S=()=>{Q(),F("close")},O=b=>{b.target===b.currentTarget&&S()},c=(b,s)=>{b==="overall"?a.review.overallRating=s:a.review.aspects[b]=s},ee=()=>{const b=B.find(s=>s.type===m.value);return b?b.title:"フィードバック"},Y=()=>{switch(m.value){case"bug":return"どのような問題が発生しましたか？できるだけ詳しく教えてください。";case"feature":return"どのような機能があると良いと思いますか？具体的なアイデアをお聞かせください。";case"ui":return"どの部分を改善すべきでしょうか？より使いやすくするための提案をお願いします。";case"review":return"ゲーム全体の感想や、特に良かった点・改善すべき点をお聞かせください。";case"accessibility":return"どのような機能や改善があると、より利用しやすくなりますか？";default:return"ご意見やご質問をお聞かせください。"}},J=b=>({bug:L.BUG_REPORT,feature:L.FEATURE_REQUEST,ui:L.UI_UX,review:L.GENERAL,accessibility:L.ACCESSIBILITY,general:L.GENERAL})[b]||L.GENERAL,H=()=>ae(null,null,function*(){if(!(!R.value||k.value)){k.value=!0;try{let b;m.value==="bug"&&$.value&&(b=yield P());const s={userAgent:navigator.userAgent,screenResolution:`${screen.width}x${screen.height}`,viewport:`${window.innerWidth}x${window.innerHeight}`,gameVersion:"0.2.7",timestamp:new Date,gameState:x.gameState},v={name:h.value?void 0:a.submitter.name||void 0,email:h.value?void 0:a.submitter.email||void 0,isAnonymous:h.value,userAgent:navigator.userAgent,sessionId:te()},V={category:J(m.value),title:a.title.trim(),description:a.description.trim(),submitter:v,systemInfo:s,tags:[m.value]};m.value==="bug"&&(V.bugReportData={stepsToReproduce:a.bugReport.stepsToReproduce.split(`
`).filter(K=>K.trim()),expectedBehavior:a.bugReport.expectedBehavior,actualBehavior:a.bugReport.actualBehavior,screenshot:b,severity:a.bugReport.severity,reproductionRate:a.bugReport.reproductionRate}),m.value==="review"&&(V.reviewData={overallRating:a.review.overallRating,aspects:{gameplay:a.review.aspects.gameplay,ui:a.review.aspects.ui,performance:a.review.aspects.performance,accessibility:a.review.aspects.accessibility},wouldRecommend:a.review.wouldRecommend,playTime:se()});const j=q.createFeedback(V);w.value="success",F("feedbackSubmitted",j.id),oe(m.value,j.id)}catch(b){console.error("Failed to submit feedback:",b),alert("フィードバックの送信に失敗しました。しばらく後にもう一度お試しください。")}finally{k.value=!1}}}),P=()=>ae(null,null,function*(){try{const b=document.createElement("canvas"),s=b.getContext("2d");return s?(b.width=window.innerWidth,b.height=window.innerHeight,s.fillStyle="#1a1a1a",s.fillRect(0,0,b.width,b.height),s.fillStyle="#ffffff",s.font="16px Arial",s.fillText(`Screenshot captured at ${new Date().toLocaleString()}`,10,30),b.toDataURL("image/png")):void 0}catch(b){console.error("Failed to capture screenshot:",b);return}}),te=()=>`session_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,se=()=>Math.floor(Math.random()*3600),oe=(b,s)=>{console.log(`Feedback submitted: ${b} (${s})`)},Q=()=>{w.value="selection",m.value="",k.value=!1,h.value=!0,$.value=!1,Object.assign(a,{title:"",description:"",submitter:{name:"",email:""},bugReport:{severity:"",reproductionRate:"",stepsToReproduce:"",expectedBehavior:"",actualBehavior:""},review:{overallRating:0,aspects:{gameplay:0,ui:0,performance:0,accessibility:0},wouldRecommend:!1}})};return _e(()=>x.isOpen,b=>{b?document.body.style.overflow="hidden":(document.body.style.overflow="",Q())}),he(()=>{q||console.warn("FeedbackManagementService is not available")}),(b,s)=>b.isOpen?(l(),i("div",{key:0,class:"feedback-modal-overlay",onClick:O},[e("div",{class:"feedback-modal",onClick:s[12]||(s[12]=le(()=>{},["stop"])),role:"dialog","aria-modal":"true","aria-labelledby":"feedback-title"},[e("header",Se,[e("h2",Ce,d(w.value==="selection"?"フィードバックを送信":ee()),1),e("button",{onClick:S,class:"close-button","aria-label":"フィードバックモーダルを閉じる",type:"button"},s[13]||(s[13]=[e("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[e("path",{d:"M18 6L6 18M6 6l12 12",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)]))]),w.value==="selection"?(l(),i("div",Be,[s[14]||(s[14]=e("p",{class:"selection-description"}," ご意見やご要望をお聞かせください。あなたのフィードバックがゲームをより良くします。 ",-1)),e("div",Te,[(l(),i(U,null,A(B,v=>e("button",{key:v.type,onClick:V=>I(v.type),class:"feedback-option-btn","aria-describedby":`option-${v.type}-desc`},[e("div",{class:"option-icon",style:ye({backgroundColor:v.color})},d(v.icon),5),e("div",Ee,[e("h3",Me,d(v.title),1),e("p",{class:"option-description",id:`option-${v.type}-desc`},d(v.description),9,Ue)])],8,Fe)),64))])])):(l(),i("form",{key:1,onSubmit:le(H,["prevent"]),class:"feedback-form"},[m.value==="bug"?(l(),i("div",Ae,[e("div",Ie,[s[16]||(s[16]=e("label",{for:"bug-severity",class:"form-label"},"重要度",-1)),_(e("select",{id:"bug-severity","onUpdate:modelValue":s[0]||(s[0]=v=>a.bugReport.severity=v),class:"form-select",required:""},s[15]||(s[15]=[ve('<option value="" data-v-59db660a>選択してください</option><option value="low" data-v-59db660a>軽微 - 操作に支障なし</option><option value="medium" data-v-59db660a>中程度 - 一部操作に影響</option><option value="high" data-v-59db660a>重大 - ゲーム進行に支障</option><option value="critical" data-v-59db660a>致命的 - ゲームが停止</option>',5)]),512),[[fe,a.bugReport.severity]])]),e("div",Ve,[s[18]||(s[18]=e("label",{for:"reproduction-rate",class:"form-label"},"再現頻度",-1)),_(e("select",{id:"reproduction-rate","onUpdate:modelValue":s[1]||(s[1]=v=>a.bugReport.reproductionRate=v),class:"form-select",required:""},s[17]||(s[17]=[ve('<option value="" data-v-59db660a>選択してください</option><option value="always" data-v-59db660a>毎回発生</option><option value="often" data-v-59db660a>頻繁に発生</option><option value="sometimes" data-v-59db660a>時々発生</option><option value="rarely" data-v-59db660a>稀に発生</option>',5)]),512),[[fe,a.bugReport.reproductionRate]])])])):C("",!0),m.value==="review"?(l(),i("div",De,[e("div",qe,[s[19]||(s[19]=e("label",{class:"form-label"},"総合評価",-1)),e("div",Ne,[(l(),i(U,null,A(5,v=>e("button",{key:v,type:"button",onClick:V=>c("overall",v),class:D(["star-button",{active:a.review.overallRating>=v}]),"aria-label":`総合評価 ${v} 星`}," ★ ",10,Le)),64))])]),e("div",Oe,[(l(),i(U,null,A(E,v=>e("div",{key:v.key,class:"aspect-rating"},[e("label",Pe,d(v.label),1),e("div",je,[(l(),i(U,null,A(5,V=>e("button",{key:V,type:"button",onClick:j=>c(v.key,V),class:D(["star-button",{active:a.review.aspects[v.key]>=V}]),"aria-label":`${v.label} ${V} 星`}," ★ ",10,Ge)),64))])])),64))]),e("div",ze,[e("label",We,[_(e("input",{type:"checkbox","onUpdate:modelValue":s[2]||(s[2]=v=>a.review.wouldRecommend=v),class:"form-checkbox"},null,512),[[re,a.review.wouldRecommend]]),s[20]||(s[20]=N(" このゲームを他の人におすすめしますか？ ",-1))])])])):C("",!0),e("div",He,[s[21]||(s[21]=e("label",{for:"feedback-title",class:"form-label"},[N(" タイトル "),e("span",{class:"required"},"*")],-1)),_(e("input",{id:"feedback-title","onUpdate:modelValue":s[3]||(s[3]=v=>a.title=v),type:"text",class:"form-input",placeholder:"簡潔にお聞かせください",required:"",maxlength:"100"},null,512),[[M,a.title]]),e("div",Qe,d(a.title.length)+"/100",1)]),e("div",Xe,[s[22]||(s[22]=e("label",{for:"feedback-description",class:"form-label"},[N(" 詳細 "),e("span",{class:"required"},"*")],-1)),_(e("textarea",{id:"feedback-description","onUpdate:modelValue":s[4]||(s[4]=v=>a.description=v),class:"form-textarea",placeholder:Y(),required:"",rows:"5",maxlength:"1000"},null,8,Ye),[[M,a.description]]),e("div",Je,d(a.description.length)+"/1000",1)]),m.value==="bug"?(l(),i("div",Ke,[e("div",Ze,[s[23]||(s[23]=e("label",{for:"steps-to-reproduce",class:"form-label"},[N(" 再現手順 "),e("span",{class:"required"},"*")],-1)),_(e("textarea",{id:"steps-to-reproduce","onUpdate:modelValue":s[5]||(s[5]=v=>a.bugReport.stepsToReproduce=v),class:"form-textarea",placeholder:`1. ○○をクリック
2. △△を選択
3. □□が発生`,required:"",rows:"4"},null,512),[[M,a.bugReport.stepsToReproduce]])]),e("div",et,[s[24]||(s[24]=e("label",{for:"expected-behavior",class:"form-label"},"期待される動作",-1)),_(e("textarea",{id:"expected-behavior","onUpdate:modelValue":s[6]||(s[6]=v=>a.bugReport.expectedBehavior=v),class:"form-textarea",placeholder:"本来はどのような動作を期待していましたか？",rows:"2"},null,512),[[M,a.bugReport.expectedBehavior]])]),e("div",tt,[s[25]||(s[25]=e("label",{for:"actual-behavior",class:"form-label"},"実際の動作",-1)),_(e("textarea",{id:"actual-behavior","onUpdate:modelValue":s[7]||(s[7]=v=>a.bugReport.actualBehavior=v),class:"form-textarea",placeholder:"実際にはどのような動作が発生しましたか？",rows:"2"},null,512),[[M,a.bugReport.actualBehavior]])]),e("div",st,[e("label",ot,[_(e("input",{type:"checkbox","onUpdate:modelValue":s[8]||(s[8]=v=>$.value=v),class:"form-checkbox"},null,512),[[re,$.value]]),s[26]||(s[26]=N(" スクリーンショットを含める（推奨） ",-1))]),s[27]||(s[27]=e("p",{class:"form-help"},"スクリーンショットは問題の特定に役立ちます",-1))])])):C("",!0),e("div",at,[s[33]||(s[33]=e("h3",{class:"section-title"},"送信者情報（任意）",-1)),e("div",lt,[e("label",it,[_(e("input",{type:"checkbox","onUpdate:modelValue":s[9]||(s[9]=v=>h.value=v),class:"form-checkbox"},null,512),[[re,h.value]]),s[28]||(s[28]=N(" 匿名で送信する ",-1))]),s[29]||(s[29]=e("p",{class:"form-help"}," 匿名の場合、返信はできませんが、フィードバックは大切に活用させていただきます ",-1))]),h.value?C("",!0):(l(),i("div",nt,[e("div",rt,[s[30]||(s[30]=e("label",{for:"submitter-name",class:"form-label"},"お名前",-1)),_(e("input",{id:"submitter-name","onUpdate:modelValue":s[10]||(s[10]=v=>a.submitter.name=v),type:"text",class:"form-input",placeholder:"田中太郎",maxlength:"50"},null,512),[[M,a.submitter.name]])]),e("div",ct,[s[31]||(s[31]=e("label",{for:"submitter-email",class:"form-label"},"メールアドレス",-1)),_(e("input",{id:"submitter-email","onUpdate:modelValue":s[11]||(s[11]=v=>a.submitter.email=v),type:"email",class:"form-input",placeholder:"example@example.com"},null,512),[[M,a.submitter.email]]),s[32]||(s[32]=e("p",{class:"form-help"},"返信が必要な場合のみご入力ください",-1))])]))]),e("div",dt,[e("button",{type:"button",onClick:T,class:"btn-secondary"}," 戻る "),e("button",{type:"submit",class:"btn-primary",disabled:!R.value||k.value},[k.value?(l(),i("span",vt,"送信中...")):(l(),i("span",pt,"送信する"))],8,ut)])],32)),w.value==="success"?(l(),i("div",mt,[s[34]||(s[34]=e("div",{class:"success-icon"},"✅",-1)),s[35]||(s[35]=e("h3",{class:"success-title"},"フィードバックを送信しました",-1)),e("p",bt," 貴重なご意見をありがとうございます。 "+d(h.value?"いただいたフィードバックは今後の改善に活用させていただきます。":"ご連絡先をいただいている場合は、必要に応じて返信いたします。"),1),e("button",{onClick:S,class:"btn-primary"},"閉じる")])):C("",!0)])])):C("",!0)}}),gt=be(ft,[["__scopeId","data-v-59db660a"]]),ht={class:"review-system"},yt={key:0,class:"quick-review"},kt={class:"quick-actions"},$t=["onClick","aria-label"],_t={class:"rating-emoji"},wt={class:"rating-label"},Rt=["disabled"],xt={key:1,class:"detailed-review"},St={class:"rating-section"},Ct={class:"star-rating-container"},Bt={class:"star-rating"},Tt=["onClick","onMouseover","aria-label"],Ft={class:"rating-description"},Et={class:"aspect-ratings-section"},Mt={class:"aspect-grid"},Ut={class:"aspect-header"},At={class:"aspect-icon"},It={class:"aspect-info"},Vt={class:"aspect-title"},Dt={class:"aspect-description"},qt={class:"aspect-rating"},Nt={class:"star-rating small"},Lt=["onClick","aria-label"],Ot={class:"comment-section"},Pt={class:"comment-prompts"},jt=["onClick"],Gt=["placeholder"],zt={class:"character-count"},Wt={class:"recommendation-section"},Ht={class:"recommendation-scale"},Qt={class:"scale-track"},Xt=["aria-label"],Yt={class:"scale-markers"},Jt={class:"scale-value"},Kt={class:"tags-section"},Zt={class:"tags-grid"},es=["onClick"],ts={class:"tag-icon"},ss={class:"tag-label"},os={class:"playtime-section"},as={class:"playtime-options"},ls=["onClick"],is={class:"form-actions"},ns=["disabled"],rs={key:0},cs={key:1},ds={key:2,class:"success-overlay"},us=pe({__name:"ReviewSystem",props:{mode:{default:"quick"},gameState:{}},emits:["reviewSubmitted","modeChanged"],setup(z,{emit:W}){const x=z,F=W,q=new me,w=f(x.mode),m=f(0),k=f(0),h=f(0),$=f(""),a=f(5),B=f(""),E=f([]),R=f(null),I=f(!1),T=f(!1),S=ge({gameplay:0,ui:0,performance:0,accessibility:0}),O=[{value:1,label:"いまいち",emoji:"😞",description:"期待に届かなかった"},{value:2,label:"まあまあ",emoji:"😐",description:"普通の出来"},{value:3,label:"よかった",emoji:"😊",description:"楽しめた"},{value:4,label:"とてもよかった",emoji:"😄",description:"大いに楽しめた"},{value:5,label:"最高だった",emoji:"🤩",description:"期待を大きく上回った"}],c=[{key:"gameplay",title:"ゲームプレイ",description:"面白さ・戦略性",icon:"🎮"},{key:"ui",title:"UI・操作性",description:"使いやすさ・直感性",icon:"🖱️"},{key:"performance",title:"パフォーマンス",description:"動作の軽さ・安定性",icon:"⚡"},{key:"accessibility",title:"アクセシビリティ",description:"利用しやすさ・配慮",icon:"♿"}],ee=[{id:"liked",text:"特に良かった点",placeholder:"どの部分が特に気に入りましたか？具体的にお聞かせください。"},{id:"improvement",text:"改善してほしい点",placeholder:"どの部分を改善すればより良くなると思いますか？"},{id:"feature",text:"追加してほしい機能",placeholder:"どのような機能があると更に楽しめると思いますか？"},{id:"general",text:"全体的な感想",placeholder:"ゲーム全体を通しての感想をお聞かせください。"}],Y=[{id:"addictive",label:"ハマる",icon:"🎯"},{id:"relaxing",label:"リラックス",icon:"😌"},{id:"challenging",label:"やりがい",icon:"💪"},{id:"educational",label:"学びになる",icon:"📚"},{id:"innovative",label:"斬新",icon:"💡"},{id:"beautiful",label:"美しい",icon:"🎨"},{id:"intuitive",label:"直感的",icon:"👆"},{id:"immersive",label:"没入感",icon:"🌟"}],J=[{value:"< 30min",label:"30分未満"},{value:"30min - 1h",label:"30分〜1時間"},{value:"1h - 2h",label:"1〜2時間"},{value:"2h - 5h",label:"2〜5時間"},{value:"5h+",label:"5時間以上"}],H=ce(()=>h.value>0&&$.value.trim().length>0),P=g=>ae(null,null,function*(){var u;m.value=g;try{const X=yield q.createReview({title:`クイック評価: ${(u=O.find(o=>o.value===g))==null?void 0:u.label}`,description:`ユーザーからの ${g} 星評価`,submitter:{isAnonymous:!0,userAgent:navigator.userAgent,sessionId:Z()},systemInfo:{userAgent:navigator.userAgent,screenResolution:`${screen.width}x${screen.height}`,viewport:`${window.innerWidth}x${window.innerHeight}`,gameVersion:"0.2.7",timestamp:new Date,gameState:x.gameState},reviewData:{overallRating:g,aspects:{gameplay:g,ui:g,performance:g,accessibility:g},wouldRecommend:g>=4}});T.value=!0,F("reviewSubmitted",X.id)}catch(X){console.error("Failed to submit quick rating:",X),alert("評価の送信に失敗しました。")}}),te=()=>{m.value>0&&(h.value=m.value,Object.keys(S).forEach(g=>{S[g]=m.value}),a.value=m.value>=4?8:4),w.value="detailed",F("modeChanged","detailed")},se=()=>{w.value="quick",F("modeChanged","quick")},oe=g=>{h.value=g},Q=(g,u)=>{S[g]=u},b=g=>{var u;R.value=((u=R.value)==null?void 0:u.id)===g.id?null:g},s=g=>{const u=E.value.indexOf(g);u>-1?E.value.splice(u,1):E.value.push(g)},v=()=>ae(null,null,function*(){if(!(!H.value||I.value)){I.value=!0;try{const g=yield q.createReview({title:`詳細レビュー: ${K(h.value)}`,description:$.value.trim(),submitter:{isAnonymous:!0,userAgent:navigator.userAgent,sessionId:Z()},systemInfo:{userAgent:navigator.userAgent,screenResolution:`${screen.width}x${screen.height}`,viewport:`${window.innerWidth}x${window.innerHeight}`,gameVersion:"0.2.7",timestamp:new Date,gameState:x.gameState},reviewData:{overallRating:h.value,aspects:{gameplay:S.gameplay,ui:S.ui,performance:S.performance,accessibility:S.accessibility},wouldRecommend:a.value>=6,playTime:ie()},tags:["detailed-review",...E.value,`recommendation-${a.value}`,B.value?`playtime-${B.value}`:""].filter(Boolean)});T.value=!0,F("reviewSubmitted",g.id)}catch(g){console.error("Failed to submit detailed review:",g),alert("レビューの送信に失敗しました。")}finally{I.value=!1}}}),V=()=>{T.value=!1,j()},j=()=>{m.value=0,h.value=0,$.value="",a.value=5,B.value="",E.value=[],R.value=null,Object.keys(S).forEach(g=>{S[g]=0})},K=g=>["","改善が必要","まあまあ","良い","とても良い","素晴らしい"][g]||"",Z=()=>`review_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,ie=()=>({"< 30min":15,"30min - 1h":45,"1h - 2h":90,"2h - 5h":210,"5h+":360})[B.value]||0;return _e(()=>x.mode,g=>{w.value=g}),(g,u)=>{var X;return l(),i("div",ht,[g.mode==="quick"?(l(),i("div",yt,[u[3]||(u[3]=e("div",{class:"quick-review-header"},[e("h3",{class:"quick-title"},"ゲームはいかがでしたか？"),e("p",{class:"quick-subtitle"},"簡単な評価をお聞かせください")],-1)),e("div",kt,[(l(),i(U,null,A(O,o=>e("button",{key:o.value,onClick:n=>P(o.value),class:D(["quick-rating-btn",{selected:m.value===o.value}]),"aria-label":`${o.label} - ${o.description}`},[e("div",_t,d(o.emoji),1),e("div",wt,d(o.label),1)],10,$t)),64))]),e("button",{onClick:te,class:"expand-btn",disabled:!m.value}," 詳細な評価を書く ",8,Rt)])):(l(),i("div",xt,[u[13]||(u[13]=e("div",{class:"review-header"},[e("h3",{class:"review-title"},"詳細レビュー"),e("p",{class:"review-subtitle"},"あなたの体験をお聞かせください")],-1)),e("form",{onSubmit:le(v,["prevent"]),class:"review-form"},[e("div",St,[u[4]||(u[4]=e("h4",{class:"section-title"},"総合評価",-1)),e("div",Ct,[e("div",Bt,[(l(),i(U,null,A(5,o=>e("button",{key:o,type:"button",onClick:n=>oe(o),onMouseover:n=>k.value=o,onMouseleave:u[0]||(u[0]=n=>k.value=0),class:D(["star-button",{active:h.value>=o,hover:k.value>=o&&k.value>h.value}]),"aria-label":`${o} 星評価`}," ★ ",42,Tt)),64))]),e("div",Ft,d(K(k.value||h.value)),1)])]),e("div",Et,[u[5]||(u[5]=e("h4",{class:"section-title"},"項目別評価",-1)),e("div",Mt,[(l(),i(U,null,A(c,o=>e("div",{key:o.key,class:"aspect-item"},[e("div",Ut,[e("div",At,d(o.icon),1),e("div",It,[e("h5",Vt,d(o.title),1),e("p",Dt,d(o.description),1)])]),e("div",qt,[e("div",Nt,[(l(),i(U,null,A(5,n=>e("button",{key:n,type:"button",onClick:p=>Q(o.key,n),class:D(["star-button",{active:S[o.key]>=n}]),"aria-label":`${o.title} ${n} 星評価`}," ★ ",10,Lt)),64))])])])),64))])]),e("div",Ot,[u[6]||(u[6]=e("h4",{class:"section-title"},"コメント",-1)),e("div",Pt,[(l(),i(U,null,A(ee,o=>{var n;return e("button",{key:o.id,type:"button",onClick:p=>b(o),class:D(["prompt-btn",{selected:((n=R.value)==null?void 0:n.id)===o.id}])},d(o.text),11,jt)}),64))]),_(e("textarea",{"onUpdate:modelValue":u[1]||(u[1]=o=>$.value=o),class:"comment-textarea",placeholder:((X=R.value)==null?void 0:X.placeholder)||"自由にご感想をお聞かせください...",rows:"4",maxlength:"500"},null,8,Gt),[[M,$.value]]),e("div",zt,d($.value.length)+"/500",1)]),e("div",Wt,[u[8]||(u[8]=e("h4",{class:"section-title"},"推奨度",-1)),u[9]||(u[9]=e("p",{class:"section-description"},"このゲームを友人におすすめしますか？",-1)),e("div",Ht,[u[7]||(u[7]=e("div",{class:"scale-labels"},[e("span",{class:"scale-label"},"おすすめしない"),e("span",{class:"scale-label"},"おすすめする")],-1)),e("div",Qt,[_(e("input",{type:"range","onUpdate:modelValue":u[2]||(u[2]=o=>a.value=o),min:"0",max:"10",step:"1",class:"scale-slider","aria-label":`推奨度 ${a.value} 点`},null,8,Xt),[[M,a.value]]),e("div",Yt,[(l(),i(U,null,A(11,o=>e("div",{key:o-1,class:D(["scale-marker",{active:a.value>=o-1}])},null,2)),64))])]),e("div",Jt,d(a.value)+"/10",1)])]),e("div",Kt,[u[10]||(u[10]=e("h4",{class:"section-title"},"印象的だった要素",-1)),u[11]||(u[11]=e("p",{class:"section-description"},"当てはまるものを選択してください（複数選択可）",-1)),e("div",Zt,[(l(),i(U,null,A(Y,o=>e("button",{key:o.id,type:"button",onClick:n=>s(o.id),class:D(["tag-button",{selected:E.value.includes(o.id)}])},[e("span",ts,d(o.icon),1),e("span",ss,d(o.label),1)],10,es)),64))])]),e("div",os,[u[12]||(u[12]=e("h4",{class:"section-title"},"プレイ時間",-1)),e("div",as,[(l(),i(U,null,A(J,o=>e("button",{key:o.value,type:"button",onClick:n=>B.value=o.value,class:D(["playtime-btn",{selected:B.value===o.value}])},d(o.label),11,ls)),64))])]),e("div",is,[e("button",{type:"button",onClick:se,class:"btn-secondary"}," 簡易モードに戻る "),e("button",{type:"submit",class:"btn-primary",disabled:!H.value||I.value},[I.value?(l(),i("span",rs,"送信中...")):(l(),i("span",cs,"レビューを送信"))],8,ns)])],32)])),T.value?(l(),i("div",ds,[e("div",{class:"success-content"},[u[14]||(u[14]=e("div",{class:"success-icon"},"🎉",-1)),u[15]||(u[15]=e("h3",{class:"success-title"},"レビューをありがとうございます！",-1)),u[16]||(u[16]=e("p",{class:"success-message"}," あなたの貴重な意見がゲームの改善に役立ちます。 ",-1)),e("button",{onClick:V,class:"btn-primary"}," 閉じる ")])])):C("",!0)])}}}),vs=be(us,[["__scopeId","data-v-92a0d05c"]]),ps={class:"bug-reporter"},ms={class:"form-section"},bs={class:"bug-categories"},fs=["onClick","aria-describedby"],gs={class:"category-content"},hs={class:"category-title"},ys=["id"],ks={class:"form-section"},$s={key:0,class:"severity-description"},_s={class:"form-section"},ws=["placeholder"],Rs={class:"character-count"},xs={class:"form-section"},Ss={class:"character-count"},Cs={class:"form-section"},Bs={class:"steps-helper"},Ts={class:"helper-tabs"},Fs={key:0,class:"manual-input"},Es={key:1,class:"guided-input"},Ms={class:"steps-list"},Us={class:"step-number"},As=["onUpdate:modelValue","placeholder"],Is=["onClick"],Vs=["disabled"],Ds={class:"form-section"},qs={class:"form-section"},Ns={class:"form-section"},Ls={class:"frequency-options"},Os=["value"],Ps={class:"frequency-content"},js={class:"frequency-label"},Gs={class:"frequency-description"},zs={class:"form-section"},Ws={class:"form-section"},Hs={class:"screenshot-section"},Qs={class:"screenshot-header"},Xs={class:"screenshot-actions"},Ys=["disabled"],Js={key:0},Ks={key:1},Zs={key:0,class:"screenshots-preview"},eo=["src","alt","onClick"],to={class:"screenshot-info"},so={class:"screenshot-name"},oo={class:"screenshot-size"},ao=["onClick"],lo={key:1,class:"no-screenshots"},io={class:"form-section"},no={class:"system-info-section"},ro={class:"system-info-toggle"},co={class:"toggle-label"},uo={key:0,class:"system-info-preview"},vo={class:"info-item"},po={class:"info-value"},mo={class:"info-item"},bo={class:"info-value"},fo={class:"info-item"},go={class:"info-value"},ho={class:"form-section"},yo={class:"contact-toggle"},ko={class:"toggle-label"},$o={key:0,class:"contact-fields"},_o={class:"contact-field"},wo={class:"contact-field"},Ro={class:"form-actions"},xo=["disabled"],So={key:0},Co={key:1},Bo=["src"],To={key:1,class:"success-overlay"},Fo={class:"success-content"},Eo={class:"success-details"},Mo={class:"report-id"},Uo={class:"success-message"},Ao=pe({__name:"BugReporter",props:{gameState:{}},emits:["bugReported","close"],setup(z,{emit:W}){const x=z,F=W,q=new me,w=f("manual"),m=f([""]),k=f([]),h=f(!1),$=f(!0),a=f(!1),B=f(!1),E=f(!1),R=f(""),I=f(""),T=f(null),S=f(""),O=f(null),c=ge({severity:"",title:"",description:"",stepsToReproduce:"",expectedBehavior:"",actualBehavior:"",reproductionRate:"",errorMessage:"",contactEmail:"",contactName:""}),ee=[{id:"ui",title:"UI・表示の問題",description:"ボタンが押せない、表示が崩れるなど",icon:"🎨",color:"#8B5CF6"},{id:"gameplay",title:"ゲームプレイの問題",description:"カードが選択できない、ゲームが進まないなど",icon:"🎮",color:"#3B82F6"},{id:"performance",title:"パフォーマンスの問題",description:"動作が重い、フリーズするなど",icon:"⚡",color:"#F59E0B"},{id:"audio",title:"音声の問題",description:"音が出ない、音量調整ができないなど",icon:"🔊",color:"#10B981"},{id:"save",title:"セーブ・ロードの問題",description:"進行状況が保存されない、読み込めないなど",icon:"💾",color:"#EF4444"},{id:"other",title:"その他",description:"上記に当てはまらない問題",icon:"❓",color:"#6B7280"}],Y=[{value:"always",label:"毎回発生",description:"同じ操作をすると必ず発生する"},{value:"often",label:"頻繁に発生",description:"半分以上の確率で発生する"},{value:"sometimes",label:"時々発生",description:"たまに発生する"},{value:"rarely",label:"稀に発生",description:"一度だけ、または非常に稀に発生"}],J=ce(()=>c.severity&&c.title.trim()&&c.description.trim()&&c.stepsToReproduce.trim()&&c.reproductionRate),H=p=>{var t;T.value=((t=T.value)==null?void 0:t.id)===p.id?null:p,T.value&&c.title},P=()=>T.value&&{ui:"例: ○○ボタンが押せない",gameplay:"例: カード選択後にゲームが進まない",performance:"例: ゲーム開始時に長時間フリーズする",audio:"例: 効果音が再生されない",save:"例: ゲーム終了後にスコアが保存されない",other:"例: 具体的な問題を簡潔に"}[T.value.id]||"問題を簡潔に説明してください",te=()=>{const p={low:"機能は使えるが、改善の余地がある軽微な問題",medium:"いくつかの機能に影響するが、回避方法がある問題",high:"ゲームの主要機能に大きく影響する問題",critical:"ゲームが全く使用できない、またはデータ損失の可能性がある問題"};S.value=p[c.severity]||""},se=()=>{m.value.length<10&&m.value.push("")},oe=p=>{m.value.length>1&&(m.value.splice(p,1),Q())},Q=()=>{c.stepsToReproduce=m.value.filter(p=>p.trim()).map((p,t)=>`${t+1}. ${p}`).join(`
`)},b=()=>ae(null,null,function*(){h.value=!0;try{const p=document.createElement("canvas"),t=p.getContext("2d");if(!t)throw new Error("Canvas context not available");p.width=window.innerWidth,p.height=window.innerHeight,t.fillStyle="#1a1a1a",t.fillRect(0,0,p.width,p.height),t.fillStyle="#ffffff",t.font="16px Arial",t.fillText(`Screenshot captured at ${new Date().toLocaleString()}`,10,30),t.fillText(`Browser: ${navigator.userAgent.split(" ").slice(-1)[0]}`,10,60),t.fillText(`Screen: ${p.width}x${p.height}`,10,90),x.gameState&&(t.fillText(`Game Stage: ${x.gameState.stage}`,10,120),t.fillText(`Turn: ${x.gameState.turn}`,10,150),t.fillText(`Vitality: ${x.gameState.vitality}`,10,180));const r=p.toDataURL("image/png"),y=Math.round(r.length*3/4);k.value.push({name:`screenshot_${Date.now()}.png`,data:r,size:y})}catch(p){console.error("Failed to capture screenshot:",p),alert("スクリーンショットの撮影に失敗しました。")}finally{h.value=!1}}),s=p=>{const t=p.target,r=t.files;r&&(Array.from(r).forEach(y=>{if(y.type.startsWith("image/")){const G=new FileReader;G.onload=de=>{var ke;const ue=(ke=de.target)==null?void 0:ke.result;ue&&k.value.push({name:y.name,data:ue,size:y.size})},G.readAsDataURL(y)}}),t.value="")},v=p=>{k.value.splice(p,1)},V=p=>{I.value=p},j=()=>{I.value=""},K=p=>{if(p===0)return"0 Bytes";const t=1024,r=["Bytes","KB","MB","GB"],y=Math.floor(Math.log(p)/Math.log(t));return`${parseFloat((p/Math.pow(t,y)).toFixed(2))} ${r[y]}`},Z=()=>{const p=navigator.userAgent;return p.includes("Chrome")?"Chrome":p.includes("Firefox")?"Firefox":p.includes("Safari")?"Safari":p.includes("Edge")?"Edge":"Unknown"},ie=()=>x.gameState?`${x.gameState.stage} - Turn ${x.gameState.turn}`:"Unknown",g=()=>ae(null,null,function*(){var p;if(!(!J.value||B.value)){B.value=!0;try{const t={userAgent:navigator.userAgent,screenResolution:`${screen.width}x${screen.height}`,viewport:`${window.innerWidth}x${window.innerHeight}`,gameVersion:"0.2.7",timestamp:new Date,gameState:x.gameState},r={name:a.value&&c.contactName||void 0,email:a.value&&c.contactEmail||void 0,isAnonymous:!a.value,userAgent:navigator.userAgent,sessionId:n()},y={stepsToReproduce:c.stepsToReproduce.split(`
`).filter(ue=>ue.trim()),expectedBehavior:c.expectedBehavior,actualBehavior:c.actualBehavior,errorMessage:c.errorMessage||void 0,severity:c.severity,reproductionRate:c.reproductionRate,screenshot:k.value.length>0?k.value[0].data:void 0},G=["bug-report",((p=T.value)==null?void 0:p.id)||"uncategorized",`severity-${c.severity}`,`frequency-${c.reproductionRate}`,k.value.length>0?"with-screenshot":"no-screenshot"],de=q.createBugReport({title:c.title.trim(),description:c.description.trim(),submitter:r,systemInfo:$.value?t:{userAgent:"Not provided",screenResolution:"Not provided",viewport:"Not provided",gameVersion:"0.2.7",timestamp:new Date},bugReportData:y,tags:G});R.value=de.id,E.value=!0,F("bugReported",de.id)}catch(t){console.error("Failed to submit bug report:",t),alert("バグレポートの送信に失敗しました。しばらく後にもう一度お試しください。")}finally{B.value=!1}}}),u=()=>{Object.assign(c,{severity:"",title:"",description:"",stepsToReproduce:"",expectedBehavior:"",actualBehavior:"",reproductionRate:"",errorMessage:"",contactEmail:"",contactName:""}),T.value=null,S.value="",k.value=[],m.value=[""],w.value="manual",$.value=!0,a.value=!1},X=()=>{E.value=!1,u()},o=()=>{F("close")},n=()=>`bugreport_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;return he(()=>{O.value={userAgent:navigator.userAgent,screenResolution:`${screen.width}x${screen.height}`,viewport:`${window.innerWidth}x${window.innerHeight}`,timestamp:new Date}}),(p,t)=>(l(),i("div",ps,[t[44]||(t[44]=ve('<div class="bug-reporter-header" data-v-1157bb65><div class="header-icon" data-v-1157bb65>🐛</div><div class="header-content" data-v-1157bb65><h3 class="header-title" data-v-1157bb65>バグレポート</h3><p class="header-subtitle" data-v-1157bb65> 問題の詳細を教えてください。スクリーンショットや詳細な手順があると解決が早くなります。 </p></div></div>',1)),e("form",{onSubmit:le(g,["prevent"]),class:"bug-report-form"},[e("div",ms,[t[16]||(t[16]=e("h4",{class:"section-title"},"問題の種類",-1)),e("div",bs,[(l(),i(U,null,A(ee,r=>{var y;return e("button",{key:r.id,type:"button",onClick:G=>H(r),class:D(["category-btn",{selected:((y=T.value)==null?void 0:y.id)===r.id}]),"aria-describedby":`category-${r.id}-desc`},[e("div",{class:"category-icon",style:ye({backgroundColor:r.color})},d(r.icon),5),e("div",gs,[e("div",hs,d(r.title),1),e("div",{class:"category-description",id:`category-${r.id}-desc`},d(r.description),9,ys)])],10,fs)}),64))])]),e("div",ks,[t[18]||(t[18]=e("label",{for:"severity",class:"form-label"},[N(" 重要度 "),e("span",{class:"required"},"*")],-1)),_(e("select",{id:"severity","onUpdate:modelValue":t[0]||(t[0]=r=>c.severity=r),class:"form-select",required:"",onChange:te},t[17]||(t[17]=[ve('<option value="" data-v-1157bb65>選択してください</option><option value="low" data-v-1157bb65>軽微 - 操作に支障なし</option><option value="medium" data-v-1157bb65>中程度 - 一部操作に影響</option><option value="high" data-v-1157bb65>重大 - ゲーム進行に支障</option><option value="critical" data-v-1157bb65>致命的 - ゲームが停止</option>',5)]),544),[[fe,c.severity]]),S.value?(l(),i("div",$s,d(S.value),1)):C("",!0)]),e("div",_s,[t[19]||(t[19]=e("label",{for:"bug-title",class:"form-label"},[N(" 問題のタイトル "),e("span",{class:"required"},"*")],-1)),_(e("input",{id:"bug-title","onUpdate:modelValue":t[1]||(t[1]=r=>c.title=r),type:"text",class:"form-input",placeholder:P(),required:"",maxlength:"100"},null,8,ws),[[M,c.title]]),e("div",Rs,d(c.title.length)+"/100",1)]),e("div",xs,[t[20]||(t[20]=e("label",{for:"bug-description",class:"form-label"},[N(" 問題の詳細 "),e("span",{class:"required"},"*")],-1)),_(e("textarea",{id:"bug-description","onUpdate:modelValue":t[2]||(t[2]=r=>c.description=r),class:"form-textarea",placeholder:"どのような問題が発生しましたか？できるだけ詳しく説明してください。",required:"",rows:"4",maxlength:"1000"},null,512),[[M,c.description]]),e("div",Ss,d(c.description.length)+"/1000",1)]),e("div",Cs,[t[21]||(t[21]=e("label",{for:"reproduction-steps",class:"form-label"},[N(" 再現手順 "),e("span",{class:"required"},"*")],-1)),e("div",Bs,[e("div",Ts,[e("button",{type:"button",onClick:t[3]||(t[3]=r=>w.value="manual"),class:D(["helper-tab",{active:w.value==="manual"}])}," 手動入力 ",2),e("button",{type:"button",onClick:t[4]||(t[4]=r=>w.value="guided"),class:D(["helper-tab",{active:w.value==="guided"}])}," ステップ形式 ",2)]),w.value==="manual"?(l(),i("div",Fs,[_(e("textarea",{id:"reproduction-steps","onUpdate:modelValue":t[5]||(t[5]=r=>c.stepsToReproduce=r),class:"form-textarea",placeholder:`1. ○○をクリック
2. △△を選択
3. □□が発生`,required:"",rows:"5"},null,512),[[M,c.stepsToReproduce]])])):(l(),i("div",Es,[e("div",Ms,[(l(!0),i(U,null,A(m.value,(r,y)=>(l(),i("div",{key:y,class:"step-item"},[e("div",Us,d(y+1),1),_(e("input",{"onUpdate:modelValue":G=>m.value[y]=G,type:"text",class:"step-input",placeholder:`ステップ ${y+1} の操作内容`,onInput:Q},null,40,As),[[M,m.value[y]]]),m.value.length>1?(l(),i("button",{key:0,type:"button",onClick:G=>oe(y),class:"remove-step-btn","aria-label":"このステップを削除"}," × ",8,Is)):C("",!0)]))),128))]),e("button",{type:"button",onClick:se,class:"add-step-btn",disabled:m.value.length>=10}," + ステップを追加 ",8,Vs)]))])]),e("div",Ds,[t[22]||(t[22]=e("label",{for:"expected-behavior",class:"form-label"},"期待される動作",-1)),_(e("textarea",{id:"expected-behavior","onUpdate:modelValue":t[6]||(t[6]=r=>c.expectedBehavior=r),class:"form-textarea",placeholder:"本来はどのような動作を期待していましたか？",rows:"3"},null,512),[[M,c.expectedBehavior]])]),e("div",qs,[t[23]||(t[23]=e("label",{for:"actual-behavior",class:"form-label"},"実際の動作",-1)),_(e("textarea",{id:"actual-behavior","onUpdate:modelValue":t[7]||(t[7]=r=>c.actualBehavior=r),class:"form-textarea",placeholder:"実際にはどのような動作が発生しましたか？",rows:"3"},null,512),[[M,c.actualBehavior]])]),e("div",Ns,[t[24]||(t[24]=e("label",{for:"reproduction-rate",class:"form-label"},[N(" 再現頻度 "),e("span",{class:"required"},"*")],-1)),e("div",Ls,[(l(),i(U,null,A(Y,r=>e("label",{key:r.value,class:"frequency-option"},[_(e("input",{type:"radio","onUpdate:modelValue":t[8]||(t[8]=y=>c.reproductionRate=y),value:r.value,class:"frequency-radio",required:""},null,8,Os),[[we,c.reproductionRate]]),e("div",Ps,[e("div",js,d(r.label),1),e("div",Gs,d(r.description),1)])])),64))])]),e("div",zs,[t[25]||(t[25]=e("label",{for:"error-message",class:"form-label"},"エラーメッセージ（もしあれば）",-1)),_(e("textarea",{id:"error-message","onUpdate:modelValue":t[9]||(t[9]=r=>c.errorMessage=r),class:"form-textarea mono-font",placeholder:"表示されたエラーメッセージをそのままコピー&ペーストしてください",rows:"3"},null,512),[[M,c.errorMessage]])]),e("div",Ws,[e("div",Hs,[e("div",Qs,[t[26]||(t[26]=e("label",{class:"form-label"},"スクリーンショット",-1)),e("div",Xs,[e("button",{type:"button",onClick:b,class:"capture-btn",disabled:h.value},[h.value?(l(),i("span",Js,"撮影中...")):(l(),i("span",Ks,"📸 画面を撮影"))],8,Ys),e("input",{ref:"fileInput",type:"file",accept:"image/*",onChange:s,class:"file-input",style:{display:"none"}},null,544),e("button",{type:"button",onClick:t[10]||(t[10]=r=>{var y;return(y=p.$refs.fileInput)==null?void 0:y.click()}),class:"upload-btn"}," 📁 ファイルを選択 ")])]),k.value.length>0?(l(),i("div",Zs,[(l(!0),i(U,null,A(k.value,(r,y)=>(l(),i("div",{key:y,class:"screenshot-item"},[e("img",{src:r.data,alt:`スクリーンショット ${y+1}`,class:"screenshot-image",onClick:G=>V(r.data)},null,8,eo),e("div",to,[e("div",so,d(r.name),1),e("div",oo,d(K(r.size)),1)]),e("button",{type:"button",onClick:G=>v(y),class:"remove-screenshot-btn","aria-label":"スクリーンショットを削除"}," × ",8,ao)]))),128))])):(l(),i("div",lo,t[27]||(t[27]=[e("div",{class:"no-screenshots-icon"},"📷",-1),e("p",{class:"no-screenshots-text"}," スクリーンショットがあると問題の特定が早くなります ",-1)])))])]),e("div",io,[e("div",no,[t[34]||(t[34]=e("h4",{class:"section-title"},"システム情報",-1)),e("div",ro,[e("label",co,[_(e("input",{type:"checkbox","onUpdate:modelValue":t[11]||(t[11]=r=>$.value=r),class:"toggle-checkbox"},null,512),[[re,$.value]]),t[28]||(t[28]=e("span",{class:"toggle-slider"},null,-1)),t[29]||(t[29]=N(" システム情報を含める（推奨） ",-1))]),t[30]||(t[30]=e("p",{class:"toggle-description"}," ブラウザ情報、画面サイズ、ゲーム状態などを自動で収集します ",-1))]),$.value&&O.value?(l(),i("div",uo,[e("div",vo,[t[31]||(t[31]=e("span",{class:"info-label"},"ブラウザ:",-1)),e("span",po,d(Z()),1)]),e("div",mo,[t[32]||(t[32]=e("span",{class:"info-label"},"画面サイズ:",-1)),e("span",bo,d(O.value.screenResolution),1)]),e("div",fo,[t[33]||(t[33]=e("span",{class:"info-label"},"ゲーム状態:",-1)),e("span",go,d(ie()),1)])])):C("",!0)])]),e("div",ho,[t[40]||(t[40]=e("h4",{class:"section-title"},"連絡先（任意）",-1)),e("div",yo,[e("label",ko,[_(e("input",{type:"checkbox","onUpdate:modelValue":t[12]||(t[12]=r=>a.value=r),class:"toggle-checkbox"},null,512),[[re,a.value]]),t[35]||(t[35]=e("span",{class:"toggle-slider"},null,-1)),t[36]||(t[36]=N(" 連絡先を提供する ",-1))]),t[37]||(t[37]=e("p",{class:"toggle-description"}," 進捗の通知や追加情報の確認が必要な場合にご連絡します ",-1))]),a.value?(l(),i("div",$o,[e("div",_o,[t[38]||(t[38]=e("label",{for:"contact-email",class:"form-label"},"メールアドレス",-1)),_(e("input",{id:"contact-email","onUpdate:modelValue":t[13]||(t[13]=r=>c.contactEmail=r),type:"email",class:"form-input",placeholder:"example@example.com"},null,512),[[M,c.contactEmail]])]),e("div",wo,[t[39]||(t[39]=e("label",{for:"contact-name",class:"form-label"},"お名前",-1)),_(e("input",{id:"contact-name","onUpdate:modelValue":t[14]||(t[14]=r=>c.contactName=r),type:"text",class:"form-input",placeholder:"田中太郎",maxlength:"50"},null,512),[[M,c.contactName]])])])):C("",!0)]),e("div",Ro,[e("button",{type:"button",onClick:u,class:"btn-secondary"}," リセット "),e("button",{type:"submit",class:"btn-primary",disabled:!J.value||B.value},[B.value?(l(),i("span",So,"送信中...")):(l(),i("span",Co,"バグレポートを送信"))],8,xo)])],32),I.value?(l(),i("div",{key:0,class:"image-preview-modal",onClick:j},[e("div",{class:"preview-content",onClick:t[15]||(t[15]=le(()=>{},["stop"]))},[e("img",{src:I.value,alt:"プレビュー画像",class:"preview-image"},null,8,Bo),e("button",{onClick:j,class:"close-preview-btn"},"×")])])):C("",!0),E.value?(l(),i("div",To,[e("div",Fo,[t[42]||(t[42]=e("div",{class:"success-icon"},"✅",-1)),t[43]||(t[43]=e("h3",{class:"success-title"},"バグレポートを送信しました",-1)),e("div",Eo,[e("p",Mo,[t[41]||(t[41]=N("レポートID: ",-1)),e("code",null,d(R.value),1)]),e("p",Uo,d(a.value?"ご連絡先をいただいているため、進捗があればお知らせします。":"バグの修正状況は今後のアップデート情報でご確認ください。"),1)]),e("div",{class:"success-actions"},[e("button",{onClick:X,class:"btn-secondary"}," 別のバグを報告 "),e("button",{onClick:o,class:"btn-primary"}," 閉じる ")])])])):C("",!0)]))}}),Io=be(Ao,[["__scopeId","data-v-1157bb65"]]),Vo={class:"feedback-button-container"},Do={key:0,class:"notification-badge"},qo={class:"menu-content"},No={class:"quick-actions"},Lo=["onClick"],Oo={class:"action-content"},Po={class:"action-title"},jo={class:"action-subtitle"},Go={key:0,class:"context-info"},zo={class:"context-details"},Wo={class:"context-item"},Ho={class:"context-value"},Qo={class:"context-item"},Xo={class:"context-value"},Yo={class:"context-item"},Jo={class:"context-value"},Ko={key:1,class:"recent-feedback"},Zo={class:"recent-list"},ea={class:"recent-icon"},ta={class:"recent-content"},sa={class:"recent-title-text"},oa={class:"recent-meta"},aa={key:2,class:"feedback-stats"},la={class:"stats-grid"},ia={class:"stat-item"},na={class:"stat-value"},ra={class:"stat-item"},ca={class:"stat-value"},da={class:"stat-item"},ua={class:"stat-value"},va={key:4,class:"bug-reporter-modal"},pa={class:"toast-icon"},ma={class:"toast-content"},ba={class:"toast-title"},fa={class:"toast-message"},ga=pe({__name:"FeedbackButton",props:{gameState:{},position:{default:"bottom-right"},showStats:{type:Boolean,default:!1},autoSurvey:{type:Boolean,default:!0}},emits:["feedbackSubmitted"],setup(z,{expose:W,emit:x}){const F=z,q=x,w=new me,m=f(!1),k=f(!1),h=f(!1),$=f(!1),a=f("quick"),B=f([]),E=f(null),R=f(F.gameState),I=f(!1),T=f("success"),S=f(""),O=f("");let c=null;const ee=[{id:"review",title:"評価・レビュー",subtitle:"ゲームの感想を教えてください",icon:"⭐",color:"#F59E0B",priority:"normal"},{id:"bug",title:"バグ報告",subtitle:"問題や不具合を報告",icon:"🐛",color:"#EF4444",priority:"high"},{id:"feature",title:"機能要望",subtitle:"新機能のアイデアを提案",icon:"💡",color:"#3B82F6",priority:"normal"},{id:"general",title:"その他",subtitle:"ご質問・ご意見など",icon:"💬",color:"#8B5CF6",priority:"normal"}],Y=ce(()=>!1),J=ce(()=>0),H=()=>{m.value=!0,b(),F.showStats&&s()},P=()=>{m.value=!1},te=o=>{switch(P(),o.id){case"review":h.value=!0;break;case"bug":$.value=!0;break;default:k.value=!0;break}},se=o=>{k.value=!1,Z("フィードバックを送信しました","ご意見をありがとうございます"),q("feedbackSubmitted",o,"general"),b()},oe=o=>{h.value=!1,Z("レビューを送信しました","ご評価をありがとうございます"),q("feedbackSubmitted",o,"review"),b()},Q=o=>{$.value=!1,Z("バグレポートを送信しました",`レポートID: ${o.substring(0,8)}`),q("feedbackSubmitted",o,"bug"),b()},b=()=>{try{const o=w.searchFeedbacks({dateRange:{start:new Date(Date.now()-6048e5),end:new Date}});B.value=o.slice(0,5)}catch(o){console.error("Failed to load recent feedbacks:",o)}},s=()=>{try{E.value=w.getStatistics()}catch(o){console.error("Failed to load feedback stats:",o)}},v=o=>({youth:"青年期",middle:"中年期",senior:"充実期"})[o]||o,V=o=>({[L.BUG_REPORT]:"🐛",[L.FEATURE_REQUEST]:"💡",[L.UI_UX]:"🎨",[L.GAMEPLAY]:"🎮",[L.PERFORMANCE]:"⚡",[L.ACCESSIBILITY]:"♿",[L.GENERAL]:"💬"})[o]||"📝",j=o=>({[ne.SUBMITTED]:"提出済み",[ne.UNDER_REVIEW]:"確認中",[ne.IN_PROGRESS]:"対応中",[ne.RESOLVED]:"解決済み",[ne.CLOSED]:"完了"})[o]||o,K=o=>{const p=new Date().getTime()-o.getTime(),t=Math.floor(p/(1e3*60)),r=Math.floor(p/(1e3*60*60)),y=Math.floor(p/(1e3*60*60*24));return t<1?"たった今":t<60?`${t}分前`:r<24?`${r}時間前`:y<7?`${y}日前`:o.toLocaleDateString("ja-JP")},Z=(o,n)=>{I.value=!0,T.value="success",S.value=o,O.value=n,c&&clearTimeout(c),c=window.setTimeout(()=>{ie()},5e3)},ie=()=>{I.value=!1,c&&(clearTimeout(c),c=null)},g=o=>({success:"✅",info:"ℹ️",warning:"⚠️",error:"❌"})[o]||"ℹ️",u=()=>{if(!F.autoSurvey||!R.value)return;R.value.turn>10&&R.value.turn%20===0&&Math.random()<.3&&setTimeout(()=>{a.value="quick",h.value=!0},2e3)};return he(()=>{F.gameState&&(R.value=F.gameState),b(),u();const o=n=>{n.key==="Escape"&&m.value&&P()};document.addEventListener("keydown",o),Re(()=>{document.removeEventListener("keydown",o),c&&clearTimeout(c)})}),W({expand:H,collapse:P,showReview:()=>{h.value=!0},showBugReport:()=>{$.value=!0},showFeedback:()=>{k.value=!0},updateGameContext:o=>{R.value=o,u()}}),(o,n)=>{var p;return l(),i("div",Vo,[m.value?(l(),i("div",{key:1,class:"feedback-menu",onClick:n[0]||(n[0]=le(()=>{},["stop"]))},[e("div",{class:"menu-header"},[n[7]||(n[7]=e("h3",{class:"menu-title"},"フィードバック",-1)),e("button",{onClick:P,class:"menu-close-btn","aria-label":"メニューを閉じる"}," × ")]),e("div",qo,[e("div",No,[(l(),i(U,null,A(ee,t=>e("button",{key:t.id,onClick:r=>te(t),class:D(["quick-action-btn",{"high-priority":t.priority==="high"}])},[e("div",{class:"action-icon",style:ye({color:t.color})},d(t.icon),5),e("div",Oo,[e("div",Po,d(t.title),1),e("div",jo,d(t.subtitle),1)])],10,Lo)),64))]),R.value?(l(),i("div",Go,[n[11]||(n[11]=e("h4",{class:"context-title"},"現在の状況",-1)),e("div",zo,[e("div",Wo,[n[8]||(n[8]=e("span",{class:"context-label"},"ステージ:",-1)),e("span",Ho,d(v(R.value.stage)),1)]),e("div",Qo,[n[9]||(n[9]=e("span",{class:"context-label"},"ターン:",-1)),e("span",Xo,d(R.value.turn),1)]),e("div",Yo,[n[10]||(n[10]=e("span",{class:"context-label"},"活力:",-1)),e("span",Jo,d(R.value.vitality),1)])])])):C("",!0),B.value.length>0?(l(),i("div",Ko,[n[12]||(n[12]=e("h4",{class:"recent-title"},"最近の送信履歴",-1)),e("div",Zo,[(l(!0),i(U,null,A(B.value.slice(0,3),t=>(l(),i("div",{key:t.id,class:"recent-item"},[e("div",ea,d(V(t.category)),1),e("div",ta,[e("div",sa,d(t.title),1),e("div",oa,d(K(t.createdAt))+" • "+d(j(t.status)),1)])]))),128))])])):C("",!0),o.showStats&&E.value?(l(),i("div",aa,[n[16]||(n[16]=e("h4",{class:"stats-title"},"フィードバック統計",-1)),e("div",la,[e("div",ia,[e("div",na,d(E.value.total),1),n[13]||(n[13]=e("div",{class:"stat-label"},"総数",-1))]),e("div",ra,[e("div",ca,d(E.value.resolvedCount),1),n[14]||(n[14]=e("div",{class:"stat-label"},"解決済み",-1))]),e("div",da,[e("div",ua,d(((p=E.value.averageSatisfactionRating)==null?void 0:p.toFixed(1))||"N/A"),1),n[15]||(n[15]=e("div",{class:"stat-label"},"満足度",-1))])])])):C("",!0)])])):(l(),i("button",{key:0,onClick:H,class:D(["feedback-fab",{"has-notifications":Y.value}]),"aria-label":"フィードバックを送信",title:"フィードバック・レビュー・バグ報告"},[n[6]||(n[6]=e("div",{class:"fab-icon"},"💬",-1)),Y.value?(l(),i("div",Do,d(J.value),1)):C("",!0)],2)),m.value?(l(),i("div",{key:2,class:"feedback-overlay",onClick:P})):C("",!0),$e(gt,{"is-open":k.value,"game-state":R.value,onClose:n[1]||(n[1]=t=>k.value=!1),onFeedbackSubmitted:se},null,8,["is-open","game-state"]),h.value?(l(),xe(vs,{key:3,mode:a.value,"game-state":R.value,onReviewSubmitted:oe,onModeChanged:n[2]||(n[2]=t=>a.value=t),class:"review-modal"},null,8,["mode","game-state"])):C("",!0),$.value?(l(),i("div",va,[e("div",{class:"modal-overlay",onClick:n[5]||(n[5]=t=>$.value=!1)},[e("div",{class:"modal-content",onClick:n[4]||(n[4]=le(()=>{},["stop"]))},[$e(Io,{"game-state":R.value,onBugReported:Q,onClose:n[3]||(n[3]=t=>$.value=!1)},null,8,["game-state"])])])])):C("",!0),I.value?(l(),i("div",{key:5,class:D(["feedback-toast",`toast-${T.value}`])},[e("div",pa,d(g(T.value)),1),e("div",ma,[e("div",ba,d(S.value),1),e("div",fa,d(O.value),1)]),e("button",{onClick:ie,class:"toast-close"},"×")],2)):C("",!0)])}}}),Ra=be(ga,[["__scopeId","data-v-b42d3dff"]]);export{Ra as default};
//# sourceMappingURL=feedback-Bk8qjEas.js.map
