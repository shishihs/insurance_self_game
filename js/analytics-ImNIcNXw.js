var St=Object.defineProperty,Dt=Object.defineProperties;var Rt=Object.getOwnPropertyDescriptors;var pt=Object.getOwnPropertySymbols;var Tt=Object.prototype.hasOwnProperty,It=Object.prototype.propertyIsEnumerable;var bt=($,e,d)=>e in $?St($,e,{enumerable:!0,configurable:!0,writable:!0,value:d}):$[e]=d,nt=($,e)=>{for(var d in e||(e={}))Tt.call(e,d)&&bt($,d,e[d]);if(pt)for(var d of pt(e))It.call(e,d)&&bt($,d,e[d]);return $},lt=($,e)=>Dt($,Rt(e));var ht=($,e,d)=>new Promise((s,u)=>{var _=C=>{try{b(d.next(C))}catch(R){u(R)}},S=C=>{try{b(d.throw(C))}catch(R){u(R)}},b=C=>C.done?s(C.value):Promise.resolve(C.value).then(_,S);b((d=d.apply($,e)).next())});import{d as U,c as x,o as w,a as t,t as y,F as et,r as at,b as V,n as X,e as ft,f as A,g as k,h as E,i as W,w as L,j as K,v as tt,k as Y,l as P}from"./vue-vendor-Dh8Oc06C.js";import{S as At}from"./game-logic-DYTtuDyT.js";import{C as B,a as z,L as N,P as st,b as rt,p as Z,c as q,d as H,i as ot,B as dt,A as mt}from"./chart-vendor-Xt8I3p8E.js";const j=($,e)=>{const d=$.__vccOpts||$;for(const[s,u]of e)d[s]=u;return d},Mt={class:"stats-summary-card"},Ot={class:"card-header"},Bt={class:"card-icon"},Lt={class:"card-title"},Pt={class:"stats-list"},Ft={class:"stat-info"},Ut={class:"stat-label"},jt={class:"stat-value-row"},Vt={class:"stat-value"},Et={key:0,class:"stat-progress"},Wt=U({__name:"StatsSummaryCard",props:{title:{},icon:{},stats:{}},setup($){const e=d=>d.includes("↗")||d==="+"?"trend-up":d.includes("↘")||d==="-"?"trend-down":"trend-neutral";return(d,s)=>(w(),x("div",Mt,[t("div",Ot,[t("div",Bt,y(d.icon),1),t("h3",Lt,y(d.title),1)]),t("div",Pt,[(w(!0),x(et,null,at(d.stats,u=>(w(),x("div",{key:u.label,class:"stat-item"},[t("div",Ft,[t("span",Ut,y(u.label),1),t("div",jt,[t("span",Vt,y(u.value),1),u.trend?(w(),x("span",{key:0,class:X(["stat-trend",e(u.trend)])},y(u.trend),3)):V("",!0)])]),u.percentage!==void 0?(w(),x("div",Et,[t("div",{class:"progress-bar",style:ft({width:`${u.percentage}%`})},null,4)])):V("",!0)]))),128))])]))}}),it=j(Wt,[["__scopeId","data-v-185eae17"]]),Gt={class:"chart-wrapper"},qt={class:"chart-controls"},Ht={class:"chart-container"},zt={class:"chart-stats"},Nt={class:"stat-item"},Zt={class:"value"},Jt={class:"stat-item"},Qt={class:"value"},Yt={class:"stat-item"},Xt={class:"value"},Kt=U({__name:"GameProgressChart",props:{data:{}},setup($){B.register(z,N,st,rt,Z,q,H,ot);const e=$,d=A(),s=A(null),u=A("month"),_=k(()=>{if(!e.data||e.data.length===0)return[];const l=new Date;let a=new Date;switch(u.value){case"week":a.setDate(l.getDate()-7);break;case"month":a.setMonth(l.getMonth()-1);break;case"quarter":a.setMonth(l.getMonth()-3);break;case"all":default:a=new Date(0);break}return e.data.filter(c=>new Date(c.date)>=a)}),S=k(()=>_.value.reduce((l,a)=>l+a.gamesPlayed,0)),b=k(()=>_.value.length===0?0:_.value.reduce((a,c)=>a+c.averageScore*c.gamesPlayed,0)/S.value),C=k(()=>_.value.length===0?0:Math.max(..._.value.map(l=>l.averageScore))),R=()=>{if(!d.value)return;const l=d.value.getContext("2d");l&&(s.value=new B(l,{type:"line",data:{labels:[],datasets:[{label:"プレイ回数",data:[],borderColor:"rgb(99, 102, 241)",backgroundColor:"rgba(99, 102, 241, 0.1)",yAxisID:"y",fill:!0,tension:.4},{label:"平均スコア",data:[],borderColor:"rgb(34, 197, 94)",backgroundColor:"rgba(34, 197, 94, 0.1)",yAxisID:"y1",fill:!1,tension:.4}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{title:{display:!1},legend:{display:!0,position:"top",labels:{color:"white",usePointStyle:!0}},tooltip:{mode:"index",intersect:!1,backgroundColor:"rgba(17, 24, 39, 0.9)",titleColor:"white",bodyColor:"white",borderColor:"rgba(75, 85, 99, 0.5)",borderWidth:1,callbacks:{afterLabel:a=>{const c=a.dataIndex,o=_.value[c];return o?`プレイ時間: ${g(o.totalPlayTime)}`:""}}}},scales:{x:{display:!0,grid:{color:"rgba(75, 85, 99, 0.3)"},ticks:{color:"rgba(209, 213, 219, 0.8)"}},y:{type:"linear",display:!0,position:"left",grid:{color:"rgba(75, 85, 99, 0.3)"},ticks:{color:"rgba(209, 213, 219, 0.8)"},title:{display:!0,text:"プレイ回数",color:"rgb(99, 102, 241)"}},y1:{type:"linear",display:!0,position:"right",grid:{drawOnChartArea:!1},ticks:{color:"rgba(209, 213, 219, 0.8)"},title:{display:!0,text:"平均スコア",color:"rgb(34, 197, 94)"}}},interaction:{mode:"nearest",axis:"x",intersect:!1},elements:{point:{radius:4,hoverRadius:6}}}}))},D=()=>{if(!s.value)return;const l=_.value.map(o=>new Date(o.date).toLocaleDateString("ja-JP",{month:"short",day:"numeric"})),a=_.value.map(o=>o.gamesPlayed),c=_.value.map(o=>o.averageScore);s.value.data.labels=l,s.value.data.datasets[0].data=a,s.value.data.datasets[1].data=c,s.value.update("active")},g=l=>{const a=Math.floor(l/1e3),c=Math.floor(a/60),o=Math.floor(c/60);return o>0?`${o}時間${c%60}分`:c>0?`${c}分`:`${a}秒`},v=()=>{s.value&&(s.value.destroy(),s.value=null)};return E(()=>{R(),D()}),W(()=>{v()}),L(()=>e.data,()=>{D()},{deep:!0}),L(()=>u.value,()=>{D()}),(l,a)=>(w(),x("div",Gt,[a[5]||(a[5]=t("h3",{class:"chart-title"},"🎮 ゲーム進行履歴",-1)),t("div",qt,[K(t("select",{"onUpdate:modelValue":a[0]||(a[0]=c=>u.value=c),onChange:D,class:"period-selector"},a[1]||(a[1]=[t("option",{value:"week"},"過去1週間",-1),t("option",{value:"month"},"過去1ヶ月",-1),t("option",{value:"quarter"},"過去3ヶ月",-1),t("option",{value:"all"},"全期間",-1)]),544),[[tt,u.value]])]),t("div",Ht,[t("canvas",{ref_key:"chartCanvas",ref:d},null,512)]),t("div",zt,[t("div",Nt,[a[2]||(a[2]=t("span",{class:"label"},"総ゲーム数:",-1)),t("span",Zt,y(S.value),1)]),t("div",Jt,[a[3]||(a[3]=t("span",{class:"label"},"平均スコア:",-1)),t("span",Qt,y(b.value.toFixed(1)),1)]),t("div",Yt,[a[4]||(a[4]=t("span",{class:"label"},"最高スコア:",-1)),t("span",Xt,y(C.value),1)])])]))}}),te=j(Kt,[["__scopeId","data-v-e4b0e9e4"]]),ee={class:"chart-wrapper"},ae={class:"chart-container"},se={class:"chart-legend"},re={class:"legend-label"},oe={class:"legend-value"},ne=U({__name:"SuccessRateChart",props:{data:{}},setup($){B.register(z,N,dt,Z,q,H);const e=$,d=A(),s=A(null),u={youth:"rgb(34, 197, 94)",middle:"rgb(251, 191, 36)",fulfillment:"rgb(168, 85, 247)"},_={youth:"青年期",middle:"中年期",fulfillment:"充実期"},S=g=>u[g]||"rgb(107, 114, 128)",b=g=>_[g]||g,C=()=>{if(!d.value||!e.data)return;const g=d.value.getContext("2d");if(!g)return;const v=Object.keys(e.data),l=Object.values(e.data).map(o=>o*100),a=v.map(o=>S(o)),c=v.map(o=>b(o));s.value=new B(g,{type:"bar",data:{labels:c,datasets:[{label:"成功率 (%)",data:l,backgroundColor:a.map(o=>o.replace("rgb","rgba").replace(")",", 0.6)")),borderColor:a,borderWidth:2,borderRadius:4,borderSkipped:!1}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{title:{display:!1},legend:{display:!1},tooltip:{backgroundColor:"rgba(17, 24, 39, 0.9)",titleColor:"white",bodyColor:"white",borderColor:"rgba(75, 85, 99, 0.5)",borderWidth:1,callbacks:{label:o=>{const n=o.parsed.y;return`${o.label}: ${n.toFixed(1)}%`},afterLabel:o=>{const n=o.parsed.y/100;let r="";return n>=.8?r="優秀":n>=.6?r="良好":n>=.4?r="普通":r="要改善",`パフォーマンス: ${r}`}}}},scales:{x:{grid:{display:!1},ticks:{color:"rgba(209, 213, 219, 0.8)",font:{size:12}}},y:{beginAtZero:!0,max:100,grid:{color:"rgba(75, 85, 99, 0.3)"},ticks:{color:"rgba(209, 213, 219, 0.8)",callback:o=>`${o}%`},title:{display:!0,text:"成功率 (%)",color:"rgba(209, 213, 219, 0.8)"}}},elements:{bar:{borderWidth:2}},interaction:{mode:"index",intersect:!1}}})},R=()=>{if(!s.value||!e.data)return;const g=Object.keys(e.data),v=Object.values(e.data).map(c=>c*100),l=g.map(c=>S(c)),a=g.map(c=>b(c));s.value.data.labels=a,s.value.data.datasets[0].data=v,s.value.data.datasets[0].backgroundColor=l.map(c=>c.replace("rgb","rgba").replace(")",", 0.6)")),s.value.data.datasets[0].borderColor=l,s.value.update("active")},D=()=>{s.value&&(s.value.destroy(),s.value=null)};return E(()=>{C()}),W(()=>{D()}),L(()=>e.data,()=>{R()},{deep:!0}),(g,v)=>(w(),x("div",ee,[v[0]||(v[0]=t("h3",{class:"chart-title"},"📊 ステージ別成功率",-1)),t("div",ae,[t("canvas",{ref_key:"chartCanvas",ref:d},null,512)]),t("div",se,[(w(!0),x(et,null,at(g.data,(l,a)=>(w(),x("div",{class:"legend-item",key:a},[t("div",{class:"legend-color",style:ft({backgroundColor:S(a)})},null,4),t("span",re,y(b(a)),1),t("span",oe,y((l*100).toFixed(1))+"%",1)]))),128))])]))}}),le=j(ne,[["__scopeId","data-v-27aae357"]]),ie={class:"chart-wrapper"},de={class:"chart-info"},ce={class:"info-item"},ue={class:"info-item"},ve={class:"info-item"},ge={class:"chart-container"},pe=U({__name:"VitalityTrendChart",props:{data:{}},setup($){B.register(z,N,st,rt,Z,q,H,ot);const e=$,d=A(),s=A(null),u=k(()=>!e.data||e.data.length===0?0:e.data[e.data.length-1].vitality),_=k(()=>!e.data||e.data.length===0?0:Math.max(...e.data.map(D=>D.vitality))),S=k(()=>!e.data||e.data.length===0?0:Math.min(...e.data.map(D=>D.vitality))),b=()=>{if(!d.value)return;const D=d.value.getContext("2d");D&&(s.value=new B(D,{type:"line",data:{labels:[],datasets:[{label:"活力",data:[],borderColor:"rgb(239, 68, 68)",backgroundColor:"rgba(239, 68, 68, 0.1)",fill:!0,tension:.4,pointBackgroundColor:"rgb(239, 68, 68)",pointBorderColor:"white",pointBorderWidth:2,pointRadius:4,pointHoverRadius:6},{label:"危険ライン",data:[],borderColor:"rgb(245, 101, 101)",backgroundColor:"transparent",borderDash:[5,5],fill:!1,pointRadius:0,tension:0}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{title:{display:!1},legend:{display:!0,position:"top",labels:{color:"white",usePointStyle:!0,filter:g=>g.text!=="危険ライン"||e.data.some(v=>v.vitality<=20)}},tooltip:{mode:"index",intersect:!1,backgroundColor:"rgba(17, 24, 39, 0.9)",titleColor:"white",bodyColor:"white",borderColor:"rgba(75, 85, 99, 0.5)",borderWidth:1,callbacks:{title:g=>`ターン ${g[0].label}`,label:g=>{if(g.datasetIndex===0){const v=g.parsed.y;let l="";return v>=80?l="絶好調":v>=60?l="好調":v>=40?l="普通":v>=20?l="要注意":l="危険",`活力: ${v} (${l})`}return""}}}},scales:{x:{display:!0,grid:{color:"rgba(75, 85, 99, 0.3)"},ticks:{color:"rgba(209, 213, 219, 0.8)"},title:{display:!0,text:"ターン",color:"rgba(209, 213, 219, 0.8)"}},y:{beginAtZero:!0,max:100,grid:{color:"rgba(75, 85, 99, 0.3)"},ticks:{color:"rgba(209, 213, 219, 0.8)",stepSize:20},title:{display:!0,text:"活力",color:"rgba(209, 213, 219, 0.8)"}}},interaction:{mode:"nearest",axis:"x",intersect:!1},elements:{line:{tension:.4}}}}))},C=()=>{if(!s.value||!e.data)return;const D=e.data.map(a=>a.turn.toString()),g=e.data.map(a=>a.vitality),v=e.data.map(()=>20);g.map(a=>a>=80?"rgb(34, 197, 94)":a>=60?"rgb(59, 130, 246)":a>=40?"rgb(251, 191, 36)":a>=20?"rgb(245, 101, 101)":"rgb(239, 68, 68)"),g.map(a=>a>=80?"rgba(34, 197, 94, 0.1)":a>=60?"rgba(59, 130, 246, 0.1)":a>=40?"rgba(251, 191, 36, 0.1)":a>=20?"rgba(245, 101, 101, 0.1)":"rgba(239, 68, 68, 0.1)"),s.value.data.labels=D,s.value.data.datasets[0].data=g,s.value.data.datasets[1].data=v;const l=g[g.length-1]||0;l>=80?(s.value.data.datasets[0].borderColor="rgb(34, 197, 94)",s.value.data.datasets[0].backgroundColor="rgba(34, 197, 94, 0.1)"):l>=60?(s.value.data.datasets[0].borderColor="rgb(59, 130, 246)",s.value.data.datasets[0].backgroundColor="rgba(59, 130, 246, 0.1)"):l>=40?(s.value.data.datasets[0].borderColor="rgb(251, 191, 36)",s.value.data.datasets[0].backgroundColor="rgba(251, 191, 36, 0.1)"):l>=20?(s.value.data.datasets[0].borderColor="rgb(245, 101, 101)",s.value.data.datasets[0].backgroundColor="rgba(245, 101, 101, 0.1)"):(s.value.data.datasets[0].borderColor="rgb(239, 68, 68)",s.value.data.datasets[0].backgroundColor="rgba(239, 68, 68, 0.1)"),s.value.update("active")},R=()=>{s.value&&(s.value.destroy(),s.value=null)};return E(()=>{b(),C()}),W(()=>{R()}),L(()=>e.data,()=>{C()},{deep:!0}),(D,g)=>(w(),x("div",ie,[g[0]||(g[0]=t("h3",{class:"chart-title"},"💗 活力変動トレンド",-1)),t("div",de,[t("div",ce,[t("span",null,"現在: "+y(u.value),1)]),t("div",ue,[t("span",null,"最高: "+y(_.value),1)]),t("div",ve,[t("span",null,"最低: "+y(S.value),1)])]),t("div",ge,[t("canvas",{ref_key:"chartCanvas",ref:d},null,512)])]))}}),be=j(pe,[["__scopeId","data-v-363e59d5"]]),he={class:"chart-wrapper"},fe={class:"chart-container"},me={class:"analysis-summary"},ye={class:"stage-icon"},_e={class:"stage-info"},Ce={class:"stage-name"},$e={class:"stage-count"},ke={class:"stage-percentage"},xe=U({__name:"StageAnalysisChart",props:{data:{}},setup($){B.register(mt,q,H);const e=$,d=A(),s=A(null),u={youth:"rgb(34, 197, 94)",middle:"rgb(251, 191, 36)",fulfillment:"rgb(168, 85, 247)"},_={youth:"青年期",middle:"中年期",fulfillment:"充実期"},S={youth:"🌱",middle:"🌳",fulfillment:"🌸"},b=k(()=>Object.values(e.data||{}).reduce((o,n)=>o+n,0)),C=o=>_[o]||o,R=o=>S[o]||"⭐",D=o=>b.value===0?"0":(o/b.value*100).toFixed(1),g=()=>{if(!d.value||!e.data)return;const o=d.value.getContext("2d");if(!o)return;const n=Object.keys(e.data),r=Object.values(e.data),i=n.map(m=>u[m]||"rgb(107, 114, 128)"),f=n.map(m=>C(m));s.value=new B(o,{type:"doughnut",data:{labels:f,datasets:[{data:r,backgroundColor:i.map(m=>m.replace("rgb","rgba").replace(")",", 0.8)")),borderColor:i,borderWidth:2,hoverOffset:4}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{title:{display:!1},legend:{display:!1},tooltip:{backgroundColor:"rgba(17, 24, 39, 0.9)",titleColor:"white",bodyColor:"white",borderColor:"rgba(75, 85, 99, 0.5)",borderWidth:1,callbacks:{label:m=>{const T=m.label,M=m.parsed,O=(M/b.value*100).toFixed(1);return`${T}: ${M}回 (${O}%)`},afterLabel:m=>{const T=Object.keys(e.data)[m.dataIndex];return`難易度: ${l(T)}`}}}},cutout:"60%",elements:{arc:{borderWidth:2}}}}),v()},v=()=>{if(!s.value)return;s.value.ctx,B.register({id:"centerText",beforeDraw:n=>{const{width:r,height:i,ctx:f}=n;f.restore();const m=(i/180).toFixed(2);f.font=`bold ${m}em Arial`,f.textBaseline="middle",f.fillStyle="white";const T=`総計
${b.value}回`,M=Math.round(r/2),O=i/2,G=T.split(`
`);G.forEach((J,Q)=>{const ct=parseInt(m)*20,ut=O+(Q-(G.length-1)/2)*ct;f.fillText(J,M,ut)}),f.save()}})},l=o=>({youth:"易",middle:"中",fulfillment:"難"})[o]||"不明",a=()=>{if(!s.value||!e.data)return;const o=Object.keys(e.data),n=Object.values(e.data),r=o.map(f=>u[f]||"rgb(107, 114, 128)"),i=o.map(f=>C(f));s.value.data.labels=i,s.value.data.datasets[0].data=n,s.value.data.datasets[0].backgroundColor=r.map(f=>f.replace("rgb","rgba").replace(")",", 0.8)")),s.value.data.datasets[0].borderColor=r,s.value.update("active")},c=()=>{s.value&&(s.value.destroy(),s.value=null)};return E(()=>{g()}),W(()=>{c()}),L(()=>e.data,()=>{a()},{deep:!0}),(o,n)=>(w(),x("div",he,[n[0]||(n[0]=t("h3",{class:"chart-title"},"🎯 ステージ別到達分析",-1)),t("div",fe,[t("canvas",{ref_key:"chartCanvas",ref:d},null,512)]),t("div",me,[(w(!0),x(et,null,at(o.data,(r,i)=>(w(),x("div",{class:"summary-item",key:i},[t("div",ye,y(R(i)),1),t("div",_e,[t("div",Ce,y(C(i)),1),t("div",$e,y(r)+"回到達",1),t("div",ke,y(D(r))+"%",1)])]))),128))])]))}}),we=j(xe,[["__scopeId","data-v-c065dc64"]]),Se={class:"chart-wrapper"},De={class:"chart-controls"},Re={class:"chart-container"},Te={class:"usage-details"},Ie={class:"detail-list"},Ae={class:"card-type"},Me={class:"type-icon"},Oe={class:"type-name"},Be={class:"usage-stats"},Le={class:"usage-count"},Pe={class:"usage-percentage"},Fe=U({__name:"CardUsageChart",props:{data:{}},setup($){B.register(z,N,dt,mt,Z,q,H);const e=$,d=A(),s=A(null),u=A("type"),_={life:{name:"ライフカード",icon:"💫",color:"rgb(34, 197, 94)"},challenge:{name:"チャレンジカード",icon:"⚔️",color:"rgb(239, 68, 68)"},insurance:{name:"保険カード",icon:"🛡️",color:"rgb(59, 130, 246)"},dream:{name:"夢カード",icon:"✨",color:"rgb(168, 85, 247)"},action:{name:"アクションカード",icon:"🎯",color:"rgb(251, 191, 36)"},event:{name:"イベントカード",icon:"🎪",color:"rgb(236, 72, 153)"}},S=k(()=>Object.values(e.data||{}).reduce((n,r)=>n+r,0)),b=k(()=>{if(!e.data)return{};const n=Object.entries(e.data);switch(u.value){case"frequency":return Object.fromEntries(n.sort(([,r],[,i])=>i-r));case"effectiveness":return Object.fromEntries(n.sort(([r,i],[f,m])=>{const T=v(r,i);return v(f,m)-T}));case"type":default:return e.data}}),C=n=>{var r;return((r=_[n])==null?void 0:r.name)||n},R=n=>{var r;return((r=_[n])==null?void 0:r.icon)||"🎴"},D=n=>{var r;return((r=_[n])==null?void 0:r.color)||"rgb(107, 114, 128)"},g=n=>S.value===0?"0":(n/S.value*100).toFixed(1),v=(n,r)=>{const f={life:1.2,insurance:1.1,dream:1.3,action:1,challenge:.8,event:.9}[n]||1;return r*f},l=()=>{if(!d.value||!e.data)return;const n=d.value.getContext("2d");if(!n)return;const r=u.value==="type"?"doughnut":"bar";s.value=new B(n,{type:r,data:{labels:[],datasets:[{label:"カード使用回数",data:[],backgroundColor:[],borderColor:[],borderWidth:2}]},options:a()}),c()},a=()=>{const n={responsive:!0,maintainAspectRatio:!1,plugins:{title:{display:!1},legend:{display:u.value==="type",position:"bottom",labels:{color:"white",usePointStyle:!0,padding:20}},tooltip:{backgroundColor:"rgba(17, 24, 39, 0.9)",titleColor:"white",bodyColor:"white",borderColor:"rgba(75, 85, 99, 0.5)",borderWidth:1,callbacks:{label:r=>{const i=Object.keys(b.value)[r.dataIndex],f=r.parsed||r.parsed.y,m=g(f),T=v(i,f);return[`${C(i)}: ${f}回`,`使用率: ${m}%`,`効果度: ${T.toFixed(1)}`]}}}}};return u.value==="type"?lt(nt({},n),{cutout:"50%",elements:{arc:{borderWidth:2}}}):lt(nt({},n),{scales:{x:{grid:{display:!1},ticks:{color:"rgba(209, 213, 219, 0.8)",maxRotation:45}},y:{beginAtZero:!0,grid:{color:"rgba(75, 85, 99, 0.3)"},ticks:{color:"rgba(209, 213, 219, 0.8)"},title:{display:!0,text:u.value==="frequency"?"使用回数":"効果度",color:"rgba(209, 213, 219, 0.8)"}}},elements:{bar:{borderRadius:4}}})},c=()=>{if(!s.value||!e.data)return;const n=Object.keys(b.value),r=Object.values(b.value),i=n.map(M=>D(M)),f=n.map(M=>C(M));let m=r;u.value==="effectiveness"&&(m=n.map((M,O)=>v(M,r[O]))),s.value.data.labels=f,s.value.data.datasets[0].data=m,s.value.data.datasets[0].backgroundColor=i.map(M=>M.replace("rgb","rgba").replace(")",", 0.7)")),s.value.data.datasets[0].borderColor=i;const T=u.value==="type"?"doughnut":"bar";if(s.value.config.type!==T){s.value.destroy(),l();return}s.value.options=a(),s.value.update("active")},o=()=>{s.value&&(s.value.destroy(),s.value=null)};return E(()=>{l()}),W(()=>{o()}),L(()=>e.data,()=>{c()},{deep:!0}),L(()=>u.value,()=>{c()}),(n,r)=>(w(),x("div",Se,[r[3]||(r[3]=t("h3",{class:"chart-title"},"🃏 カード使用統計",-1)),t("div",De,[K(t("select",{"onUpdate:modelValue":r[0]||(r[0]=i=>u.value=i),onChange:c,class:"mode-selector"},r[1]||(r[1]=[t("option",{value:"type"},"カード種別",-1),t("option",{value:"frequency"},"使用頻度",-1),t("option",{value:"effectiveness"},"効果別",-1)]),544),[[tt,u.value]])]),t("div",Re,[t("canvas",{ref_key:"chartCanvas",ref:d},null,512)]),t("div",Te,[r[2]||(r[2]=t("div",{class:"detail-header"},[t("span",null,"詳細分析")],-1)),t("div",Ie,[(w(!0),x(et,null,at(b.value,(i,f)=>(w(),x("div",{key:f,class:"detail-item"},[t("div",Ae,[t("span",Me,y(R(f)),1),t("span",Oe,y(C(f)),1)]),t("div",Be,[t("span",Le,y(i)+"回",1),t("span",Pe,y(g(i))+"%",1)])]))),128))])])]))}}),Ue=j(Fe,[["__scopeId","data-v-51603027"]]),je={class:"chart-wrapper"},Ve={class:"chart-container"},Ee={class:"patterns-analysis"},We={class:"pattern-list"},Ge={class:"pattern-header"},qe={class:"pattern-situation"},He={class:"pattern-choice"},ze={class:"pattern-stats"},Ne={class:"stat"},Ze={class:"value"},Je={class:"stat"},Qe={class:"value"},Ye={class:"pattern-recommendation"},Xe=U({__name:"StrategyPatternsChart",props:{data:{}},setup($){B.register(z,N,st,rt,Z,q,H);const e=$,d=A(),s=A(null),u=k(()=>[...e.data||[]].sort((v,l)=>l.successRate!==v.successRate?l.successRate-v.successRate:l.frequency-v.frequency)),_=v=>({youth_high_vitality:"青年期・高活力",youth_low_vitality:"青年期・低活力",middle_high_vitality:"中年期・高活力",middle_low_vitality:"中年期・低活力",fulfillment_high_vitality:"充実期・高活力",fulfillment_low_vitality:"充実期・低活力"})[v]||v,S=v=>({with_insurance:"保険あり",no_insurance:"保険なし",aggressive:"積極的",conservative:"保守的",balanced:"バランス型"})[v]||v,b=v=>v.successRate>=.8?"👍 優秀な戦略です":v.successRate>=.6?"😊 良好な戦略です":v.successRate>=.4?"😐 改善の余地があります":"🤔 戦略の見直しを検討",C=()=>{if(!d.value||!e.data||e.data.length===0)return;const v=d.value.getContext("2d");if(!v)return;const l=R();s.value=new B(v,{type:"scatter",data:{datasets:l},options:{responsive:!0,maintainAspectRatio:!1,plugins:{title:{display:!1},legend:{display:!0,position:"top",labels:{color:"white",usePointStyle:!0}},tooltip:{backgroundColor:"rgba(17, 24, 39, 0.9)",titleColor:"white",bodyColor:"white",borderColor:"rgba(75, 85, 99, 0.5)",borderWidth:1,callbacks:{title:()=>"",label:a=>{const c=e.data[a.dataIndex];return[`状況: ${_(c.situation)}`,`選択: ${S(c.choice)}`,`頻度: ${c.frequency}回`,`成功率: ${(c.successRate*100).toFixed(1)}%`]}}}},scales:{x:{display:!0,grid:{color:"rgba(75, 85, 99, 0.3)"},ticks:{color:"rgba(209, 213, 219, 0.8)"},title:{display:!0,text:"使用頻度",color:"rgba(209, 213, 219, 0.8)"}},y:{beginAtZero:!0,max:1,grid:{color:"rgba(75, 85, 99, 0.3)"},ticks:{color:"rgba(209, 213, 219, 0.8)",callback:a=>`${(Number(a)*100).toFixed(0)}%`},title:{display:!0,text:"成功率",color:"rgba(209, 213, 219, 0.8)"}}},elements:{point:{radius:8,hoverRadius:10}}}})},R=()=>{if(!e.data)return[];const v={};e.data.forEach(a=>{const c=a.situation.split("_")[0];v[c]||(v[c]=[]),v[c].push(a)});const l={youth:"rgb(34, 197, 94)",middle:"rgb(251, 191, 36)",fulfillment:"rgb(168, 85, 247)"};return Object.entries(v).map(([a,c])=>({label:_(`${a}_high_vitality`).split("・")[0],data:c.map(o=>({x:o.frequency,y:o.successRate})),backgroundColor:l[a]||"rgb(107, 114, 128)",borderColor:l[a]||"rgb(107, 114, 128)",pointRadius:c.map(o=>Math.max(6,o.frequency/2)),pointHoverRadius:c.map(o=>Math.max(8,o.frequency/2+2))}))},D=()=>{if(!s.value||!e.data)return;const v=R();s.value.data.datasets=v,s.value.update("active")},g=()=>{s.value&&(s.value.destroy(),s.value=null)};return E(()=>{C()}),W(()=>{g()}),L(()=>e.data,()=>{D()},{deep:!0}),(v,l)=>(w(),x("div",je,[l[2]||(l[2]=t("h3",{class:"chart-title"},"🧭 戦略パターン分析",-1)),t("div",Ve,[t("canvas",{ref_key:"chartCanvas",ref:d},null,512)]),t("div",Ee,[t("div",We,[(w(!0),x(et,null,at(u.value,a=>(w(),x("div",{key:`${a.situation}_${a.choice}`,class:X(["pattern-item",{"high-success":a.successRate>=.7,"low-success":a.successRate<.4}])},[t("div",Ge,[t("div",qe,y(_(a.situation)),1),t("div",He,y(S(a.choice)),1)]),t("div",ze,[t("div",Ne,[l[0]||(l[0]=t("span",{class:"label"},"頻度:",-1)),t("span",Ze,y(a.frequency)+"回",1)]),t("div",Je,[l[1]||(l[1]=t("span",{class:"label"},"成功率:",-1)),t("span",Qe,y((a.successRate*100).toFixed(1))+"%",1)]),t("div",Ye,y(b(a)),1)])],2))),128))])])]))}}),Ke=j(Xe,[["__scopeId","data-v-daf6d8cf"]]),ta={class:"chart-wrapper"},ea={class:"chart-controls"},aa={class:"chart-container"},sa={class:"decision-insights"},ra={class:"insight-grid"},oa={class:"insight-item"},na={class:"insight-content"},la={class:"insight-value"},ia={class:"insight-item"},da={class:"insight-content"},ca={class:"insight-value"},ua={class:"insight-item"},va={class:"insight-content"},ga={class:"insight-value"},pa={class:"insight-item"},ba={class:"insight-content"},ha={class:"insight-value"},fa={class:"analysis-summary"},ma={class:"summary-content"},ya=U({__name:"DecisionAnalysisChart",props:{data:{}},setup($){B.register(z,N,st,rt,dt,Z,q,H,ot);const e=$,d=A(),s=A(null),u=A("timeline"),_=k(()=>!e.data||e.data.length===0?0:e.data.reduce((i,f)=>i+f.decisionTime,0)/e.data.length),S=k(()=>!e.data||e.data.length===0?0:Math.min(...e.data.map(r=>r.decisionTime))),b=k(()=>!e.data||e.data.length===0?0:Math.max(...e.data.map(r=>r.decisionTime))),C=k(()=>{if(!e.data||e.data.length<2)return"不明";const r=e.data.slice(0,Math.floor(e.data.length/2)),i=e.data.slice(Math.floor(e.data.length/2)),f=r.reduce((M,O)=>M+O.decisionTime,0)/r.length,T=i.reduce((M,O)=>M+O.decisionTime,0)/i.length-f;return Math.abs(T)<.5?"安定":T>0?"慎重化":"迅速化"}),R=k(()=>{if(!e.data||e.data.length===0)return"データが不足しています";const r=_.value;return r<3?"非常に迅速な決定を行っています。直感的なプレイスタイルです。":r<8?"バランスの取れた決定時間です。適度に考えてプレイしています。":r<15?"慎重に考えてからプレイしています。戦略的なアプローチです。":"非常に慎重なプレイスタイルです。より素早い決定も検討してみてください。"}),D=k(()=>{if(!e.data||e.data.length===0)return[];const r=[0,2,5,10,15,20,30,1/0],i=["0-2秒","2-5秒","5-10秒","10-15秒","15-20秒","20-30秒","30秒以上"];return r.slice(0,-1).map((m,T)=>{const M=r[T+1],O=e.data.filter(G=>G.decisionTime>=m&&G.decisionTime<M).length;return{label:i[T],count:O}})}),g=k(()=>{if(!e.data||e.data.length<3)return[];const r=3,i=[];for(let f=r-1;f<e.data.length;f++){const T=e.data.slice(f-r+1,f+1).reduce((M,O)=>M+O.decisionTime,0)/r;i.push({turn:e.data[f].turn,average:T})}return i}),v=()=>{if(!d.value||!e.data||e.data.length===0)return;const r=d.value.getContext("2d");r&&(s.value=new B(r,{type:l(),data:a(),options:c()}))},l=()=>{switch(u.value){case"distribution":return"bar";case"average":case"timeline":default:return"line"}},a=()=>{switch(u.value){case"distribution":return{labels:D.value.map(r=>r.label),datasets:[{label:"決定回数",data:D.value.map(r=>r.count),backgroundColor:"rgba(59, 130, 246, 0.6)",borderColor:"rgb(59, 130, 246)",borderWidth:2,borderRadius:4}]};case"average":return{labels:g.value.map(r=>`ターン${r.turn}`),datasets:[{label:"移動平均（3ターン）",data:g.value.map(r=>r.average),borderColor:"rgb(34, 197, 94)",backgroundColor:"rgba(34, 197, 94, 0.1)",fill:!0,tension:.4,pointBackgroundColor:"rgb(34, 197, 94)",pointBorderColor:"white",pointBorderWidth:2}]};case"timeline":default:return{labels:e.data.map(r=>`ターン${r.turn}`),datasets:[{label:"決定時間",data:e.data.map(r=>r.decisionTime),borderColor:"rgb(168, 85, 247)",backgroundColor:"rgba(168, 85, 247, 0.1)",fill:!0,tension:.4,pointBackgroundColor:"rgb(168, 85, 247)",pointBorderColor:"white",pointBorderWidth:2},{label:"平均ライン",data:e.data.map(()=>_.value),borderColor:"rgb(251, 191, 36)",backgroundColor:"transparent",borderDash:[5,5],pointRadius:0,tension:0}]}}},c=()=>{const r={responsive:!0,maintainAspectRatio:!1,plugins:{title:{display:!1},legend:{display:!0,position:"top",labels:{color:"white",usePointStyle:!0}},tooltip:{backgroundColor:"rgba(17, 24, 39, 0.9)",titleColor:"white",bodyColor:"white",borderColor:"rgba(75, 85, 99, 0.5)",borderWidth:1}},scales:{x:{grid:{color:"rgba(75, 85, 99, 0.3)"},ticks:{color:"rgba(209, 213, 219, 0.8)"}},y:{beginAtZero:!0,grid:{color:"rgba(75, 85, 99, 0.3)"},ticks:{color:"rgba(209, 213, 219, 0.8)",callback:i=>u.value==="distribution"?`${i}回`:`${i}秒`},title:{display:!0,text:u.value==="distribution"?"決定回数":"時間（秒）",color:"rgba(209, 213, 219, 0.8)"}}}};return u.value!=="distribution"?lt(nt({},r),{elements:{point:{radius:4,hoverRadius:6}}}):r},o=()=>{if(!s.value){v();return}const r=l();if(s.value.config.type!==r){s.value.destroy(),v();return}s.value.data=a(),s.value.options=c(),s.value.update("active")},n=()=>{s.value&&(s.value.destroy(),s.value=null)};return E(()=>{v()}),W(()=>{n()}),L(()=>e.data,()=>{o()},{deep:!0}),L(()=>u.value,()=>{o()}),(r,i)=>(w(),x("div",ta,[i[11]||(i[11]=t("h3",{class:"chart-title"},"⏱️ 決定時間分析",-1)),t("div",ea,[K(t("select",{"onUpdate:modelValue":i[0]||(i[0]=f=>u.value=f),onChange:o,class:"mode-selector"},i[1]||(i[1]=[t("option",{value:"timeline"},"時系列変化",-1),t("option",{value:"distribution"},"分布分析",-1),t("option",{value:"average"},"平均推移",-1)]),544),[[tt,u.value]])]),t("div",aa,[t("canvas",{ref_key:"chartCanvas",ref:d},null,512)]),t("div",sa,[t("div",ra,[t("div",oa,[i[3]||(i[3]=t("div",{class:"insight-icon"},"🎯",-1)),t("div",na,[i[2]||(i[2]=t("div",{class:"insight-label"},"平均決定時間",-1)),t("div",la,y(_.value.toFixed(1))+"秒",1)])]),t("div",ia,[i[5]||(i[5]=t("div",{class:"insight-icon"},"⚡",-1)),t("div",da,[i[4]||(i[4]=t("div",{class:"insight-label"},"最速決定",-1)),t("div",ca,y(S.value.toFixed(1))+"秒",1)])]),t("div",ua,[i[7]||(i[7]=t("div",{class:"insight-icon"},"🤔",-1)),t("div",va,[i[6]||(i[6]=t("div",{class:"insight-label"},"最長思考",-1)),t("div",ga,y(b.value.toFixed(1))+"秒",1)])]),t("div",pa,[i[9]||(i[9]=t("div",{class:"insight-icon"},"📈",-1)),t("div",ba,[i[8]||(i[8]=t("div",{class:"insight-label"},"決定トレンド",-1)),t("div",ha,y(C.value),1)])])]),t("div",fa,[i[10]||(i[10]=t("div",{class:"summary-title"},"パフォーマンス分析",-1)),t("div",ma,y(R.value),1)])])]))}}),_a=j(ya,[["__scopeId","data-v-a95308c1"]]),Ca={class:"chart-wrapper"},$a={class:"chart-container"},ka={class:"live-stats"},xa={class:"stat-item"},wa={class:"stat-item"},Sa={class:"stat-item"},Da=U({__name:"LiveVitalityChart",props:{data:{},autoUpdate:{type:Boolean,default:!0},updateInterval:{default:1e3}},setup($){B.register(z,N,st,rt,Z,q,H,ot);const e=$,d=A(),s=A(null);let u=null;const _=k(()=>!e.data||e.data.length===0?0:e.data[e.data.length-1].vitality),S=k(()=>{if(!e.data||e.data.length<2)return 0;const o=e.data[e.data.length-1].vitality,n=e.data[e.data.length-2].vitality;return o-n}),b=k(()=>{const o=_.value;return o>=80?"安全":o>=60?"注意":o>=40?"警戒":o>=20?"危険":"極危険"}),C=o=>o>=80?"text-green-400":o>=60?"text-blue-400":o>=40?"text-yellow-400":o>=20?"text-orange-400":"text-red-400",R=o=>o>0?"text-green-400":o<0?"text-red-400":"text-gray-400",D=o=>({安全:"text-green-400",注意:"text-blue-400",警戒:"text-yellow-400",危険:"text-orange-400",極危険:"text-red-400 animate-pulse"})[o]||"text-gray-400",g=()=>{if(!d.value)return;const o=d.value.getContext("2d");o&&(s.value=new B(o,{type:"line",data:{labels:[],datasets:[{label:"活力",data:[],borderColor:"rgb(239, 68, 68)",backgroundColor:"rgba(239, 68, 68, 0.1)",fill:!0,tension:.4,pointBackgroundColor:"rgb(239, 68, 68)",pointBorderColor:"white",pointBorderWidth:2,pointRadius:5,pointHoverRadius:7},{label:"危険ライン",data:[],borderColor:"rgb(245, 101, 101)",backgroundColor:"transparent",borderDash:[10,5],fill:!1,pointRadius:0,tension:0},{label:"警戒ライン",data:[],borderColor:"rgb(251, 191, 36)",backgroundColor:"transparent",borderDash:[5,10],fill:!1,pointRadius:0,tension:0}]},options:{responsive:!0,maintainAspectRatio:!1,animation:{duration:750,easing:"easeInOutQuart"},plugins:{title:{display:!1},legend:{display:!0,position:"top",labels:{color:"white",usePointStyle:!0,filter:n=>n.text==="活力"}},tooltip:{mode:"index",intersect:!1,backgroundColor:"rgba(17, 24, 39, 0.9)",titleColor:"white",bodyColor:"white",borderColor:"rgba(75, 85, 99, 0.5)",borderWidth:1,callbacks:{title:n=>`ターン ${n[0].label}`,label:n=>{if(n.datasetIndex===0){const r=n.parsed.y;let i="";return r>=80?i="絶好調":r>=60?i="好調":r>=40?i="普通":r>=20?i="要注意":i="危険",`活力: ${r} (${i})`}return""},afterBody:n=>{if(n.length>0&&n[0].dataIndex>0){const r=n[0].dataIndex,i=e.data[r].vitality,f=e.data[r-1].vitality,m=i-f;return`変化: ${m>0?"+":""}${m}`}return""}}}},scales:{x:{display:!0,grid:{color:"rgba(75, 85, 99, 0.3)"},ticks:{color:"rgba(209, 213, 219, 0.8)",maxTicksLimit:10},title:{display:!0,text:"ターン",color:"rgba(209, 213, 219, 0.8)"}},y:{beginAtZero:!0,max:100,grid:{color:"rgba(75, 85, 99, 0.3)"},ticks:{color:"rgba(209, 213, 219, 0.8)",stepSize:20},title:{display:!0,text:"活力",color:"rgba(209, 213, 219, 0.8)"}}},interaction:{mode:"nearest",axis:"x",intersect:!1},elements:{line:{tension:.4}}}}))},v=()=>{if(!s.value||!e.data||e.data.length===0)return;const o=e.data.map(O=>O.turn.toString()),n=e.data.map(O=>O.vitality),r=e.data.map(()=>20),i=e.data.map(()=>40),f=_.value;let m="rgb(239, 68, 68)",T="rgba(239, 68, 68, 0.1)";f>=80?(m="rgb(34, 197, 94)",T="rgba(34, 197, 94, 0.1)"):f>=60?(m="rgb(59, 130, 246)",T="rgba(59, 130, 246, 0.1)"):f>=40?(m="rgb(251, 191, 36)",T="rgba(251, 191, 36, 0.1)"):f>=20&&(m="rgb(245, 101, 101)",T="rgba(245, 101, 101, 0.1)"),s.value.data.labels=o,s.value.data.datasets[0].data=n,s.value.data.datasets[0].borderColor=m,s.value.data.datasets[0].backgroundColor=T,s.value.data.datasets[0].pointBackgroundColor=m,s.value.data.datasets[1].data=r,s.value.data.datasets[2].data=i;const M=n.map((O,G)=>G===n.length-1?8:4);s.value.data.datasets[0].pointRadius=M,s.value.update("active")},l=()=>{e.autoUpdate&&!u&&(u=window.setInterval(()=>{v()},e.updateInterval))},a=()=>{u&&(clearInterval(u),u=null)},c=()=>{a(),s.value&&(s.value.destroy(),s.value=null)};return E(()=>{g(),v(),l()}),W(()=>{c()}),L(()=>e.data,()=>{v()},{deep:!0}),L(()=>e.autoUpdate,o=>{o?l():a()}),(o,n)=>(w(),x("div",Ca,[n[3]||(n[3]=t("h3",{class:"chart-title"},[Y(" 💗 リアルタイム活力変動 "),t("span",{class:"live-indicator"},"🔴 LIVE")],-1)),t("div",$a,[t("canvas",{ref_key:"chartCanvas",ref:d},null,512)]),t("div",ka,[t("div",xa,[n[0]||(n[0]=t("span",{class:"label"},"現在活力:",-1)),t("span",{class:X(["value",C(_.value)])},y(_.value),3)]),t("div",wa,[n[1]||(n[1]=t("span",{class:"label"},"変化量:",-1)),t("span",{class:X(["value",R(S.value)])},y(S.value>0?"+":"")+y(S.value),3)]),t("div",Sa,[n[2]||(n[2]=t("span",{class:"label"},"危険度:",-1)),t("span",{class:X(["value",D(b.value)])},y(b.value),3)])])]))}}),Ra=j(Da,[["__scopeId","data-v-9af1c219"]]),Ta={class:"chart-wrapper"},Ia={class:"chart-container"},Aa={class:"time-metrics"},Ma={class:"metric-item"},Oa={class:"metric-content"},Ba={class:"metric-value"},La={class:"metric-item"},Pa={class:"metric-content"},Fa={class:"metric-value"},Ua={class:"metric-item"},ja={class:"metric-content"},Va={class:"metric-value"},Ea=U({__name:"DecisionTimeChart",props:{data:{},autoUpdate:{type:Boolean,default:!0},updateInterval:{default:1e3}},setup($){B.register(z,N,st,rt,dt,Z,q,H,ot);const e=$,d=A(),s=A(null);let u=null;const _=k(()=>!e.data||e.data.length===0?0:e.data[e.data.length-1].decisionTime),S=k(()=>!e.data||e.data.length===0?0:e.data.reduce((a,c)=>a+c.decisionTime,0)/e.data.length),b=k(()=>{if(!e.data||e.data.length<3)return"分析中";const a=e.data.slice(-3).reduce((o,n)=>o+n.decisionTime,0)/3,c=S.value;return a<c*.8?"迅速化":a>c*1.2?"慎重化":"安定"}),C=()=>{if(!d.value)return;const l=d.value.getContext("2d");l&&(s.value=new B(l,{type:"line",data:{labels:[],datasets:[{label:"決定時間",data:[],borderColor:"rgb(168, 85, 247)",backgroundColor:"rgba(168, 85, 247, 0.1)",fill:!0,tension:.4,pointBackgroundColor:"rgb(168, 85, 247)",pointBorderColor:"white",pointBorderWidth:2,pointRadius:5,pointHoverRadius:7},{label:"目標時間（5秒）",data:[],borderColor:"rgb(34, 197, 94)",backgroundColor:"transparent",borderDash:[5,5],fill:!1,pointRadius:0,tension:0}]},options:{responsive:!0,maintainAspectRatio:!1,animation:{duration:500,easing:"easeInOutQuart"},plugins:{title:{display:!1},legend:{display:!0,position:"top",labels:{color:"white",usePointStyle:!0,filter:a=>a.text==="決定時間"}},tooltip:{mode:"index",intersect:!1,backgroundColor:"rgba(17, 24, 39, 0.9)",titleColor:"white",bodyColor:"white",borderColor:"rgba(75, 85, 99, 0.5)",borderWidth:1,callbacks:{title:a=>`ターン ${a[0].label}`,label:a=>{if(a.datasetIndex===0){const c=a.parsed.y;let o="";return c<=3?o="超高速":c<=5?o="高速":c<=10?o="普通":c<=15?o="慎重":o="超慎重",`決定時間: ${c.toFixed(1)}秒 (${o})`}return""},afterBody:a=>{if(a.length>0){const n=a[0].parsed.y-5;return Math.abs(n)<1?"🎯 理想的な決定時間です":n>0?`⏳ 目標より${n.toFixed(1)}秒長いです`:`⚡ 目標より${Math.abs(n).toFixed(1)}秒速いです`}return""}}}},scales:{x:{display:!0,grid:{color:"rgba(75, 85, 99, 0.3)"},ticks:{color:"rgba(209, 213, 219, 0.8)",maxTicksLimit:8},title:{display:!0,text:"ターン",color:"rgba(209, 213, 219, 0.8)"}},y:{beginAtZero:!0,grid:{color:"rgba(75, 85, 99, 0.3)"},ticks:{color:"rgba(209, 213, 219, 0.8)",callback:a=>`${a}秒`},title:{display:!0,text:"時間（秒）",color:"rgba(209, 213, 219, 0.8)"}}},interaction:{mode:"nearest",axis:"x",intersect:!1},elements:{line:{tension:.4}}}}))},R=()=>{if(!s.value||!e.data||e.data.length===0)return;const l=e.data.map(m=>m.turn.toString()),a=e.data.map(m=>m.decisionTime),c=e.data.map(()=>5),o=_.value;let n="rgb(168, 85, 247)",r="rgba(168, 85, 247, 0.1)";o<=3?(n="rgb(34, 197, 94)",r="rgba(34, 197, 94, 0.1)"):o<=5?(n="rgb(59, 130, 246)",r="rgba(59, 130, 246, 0.1)"):o<=10?(n="rgb(251, 191, 36)",r="rgba(251, 191, 36, 0.1)"):o<=15?(n="rgb(245, 101, 101)",r="rgba(245, 101, 101, 0.1)"):(n="rgb(239, 68, 68)",r="rgba(239, 68, 68, 0.1)"),s.value.data.labels=l,s.value.data.datasets[0].data=a,s.value.data.datasets[0].borderColor=n,s.value.data.datasets[0].backgroundColor=r,s.value.data.datasets[0].pointBackgroundColor=n,s.value.data.datasets[1].data=c;const i=a.map((m,T)=>T===a.length-1?8:4),f=a.map((m,T)=>T===a.length-1?m<=3?"rgb(34, 197, 94)":m<=5?"rgb(59, 130, 246)":m<=10?"rgb(251, 191, 36)":m<=15?"rgb(245, 101, 101)":"rgb(239, 68, 68)":n);s.value.data.datasets[0].pointRadius=i,s.value.data.datasets[0].pointBackgroundColor=f,s.value.update("active")},D=()=>{e.autoUpdate&&!u&&(u=window.setInterval(()=>{R()},e.updateInterval))},g=()=>{u&&(clearInterval(u),u=null)},v=()=>{g(),s.value&&(s.value.destroy(),s.value=null)};return E(()=>{C(),R(),D()}),W(()=>{v()}),L(()=>e.data,()=>{R()},{deep:!0}),L(()=>e.autoUpdate,l=>{l?D():g()}),(l,a)=>(w(),x("div",Ta,[a[6]||(a[6]=t("h3",{class:"chart-title"},[Y(" ⏱️ リアルタイム決定時間 "),t("span",{class:"live-indicator"},"🔴 LIVE")],-1)),t("div",Ia,[t("canvas",{ref_key:"chartCanvas",ref:d},null,512)]),t("div",Aa,[t("div",Ma,[a[1]||(a[1]=t("div",{class:"metric-icon"},"⚡",-1)),t("div",Oa,[a[0]||(a[0]=t("div",{class:"metric-label"},"最新決定",-1)),t("div",Ba,y(_.value.toFixed(1))+"秒",1)])]),t("div",La,[a[3]||(a[3]=t("div",{class:"metric-icon"},"📊",-1)),t("div",Pa,[a[2]||(a[2]=t("div",{class:"metric-label"},"平均時間",-1)),t("div",Fa,y(S.value.toFixed(1))+"秒",1)])]),t("div",Ua,[a[5]||(a[5]=t("div",{class:"metric-icon"},"🎯",-1)),t("div",ja,[a[4]||(a[4]=t("div",{class:"metric-label"},"決定パターン",-1)),t("div",Va,y(b.value),1)])])])]))}}),Wa=j(Ea,[["__scopeId","data-v-cc8586ca"]]),Ga={class:"statistics-dashboard"},qa={class:"dashboard-header"},Ha={class:"header-controls"},za=["disabled"],Na={key:0,class:"filter-section"},Za={class:"filter-row"},Ja={class:"filter-group"},Qa={class:"filter-group"},Ya={class:"filter-group"},Xa={class:"tab-navigation"},Ka=["onClick"],ts={class:"icon"},es={key:1,class:"dashboard-content"},as={key:0,class:"tab-content"},ss={class:"stats-grid"},rs={class:"main-charts"},os={class:"chart-container"},ns={class:"chart-container"},ls={key:1,class:"tab-content"},is={class:"detailed-charts"},ds={class:"chart-row"},cs={class:"chart-container half"},us={class:"chart-container half"},vs={class:"chart-row"},gs={class:"chart-container full"},ps={key:2,class:"tab-content"},bs={class:"patterns-section"},hs={key:3,class:"tab-content"},fs={key:0,class:"realtime-section"},ms={class:"realtime-header"},ys={class:"session-info"},_s={class:"realtime-charts"},Cs={key:1,class:"no-session"},$s={key:2,class:"loading-overlay"},ks={key:3,class:"error-message"},xs=U({__name:"StatisticsDashboard",props:{autoRefresh:{type:Boolean,default:!0},refreshInterval:{default:3e4}},emits:["close","dataUpdated"],setup($,{emit:e}){const d=$,s=e,u=At.getInstance(),_=A(!1),S=A(""),b=A(null),C=A(null),R=A("overview"),D=A(!1),g=A({dateRange:"all",gameStatus:"all",stage:"all"}),v=[{key:"overview",label:"概要",icon:"📊"},{key:"detailed",label:"詳細分析",icon:"🔍"},{key:"patterns",label:"戦略パターン",icon:"🧭"},{key:"realtime",label:"リアルタイム",icon:"📈"}];let l=null,a=null;const c=k(()=>{if(!b.value)return[];const p=b.value;return[{label:"総ゲーム数",value:p.totalGames.toString(),trend:"+"},{label:"完了ゲーム数",value:p.completedGames.toString(),trend:"+"},{label:"勝利ゲーム数",value:p.victoryGames.toString(),trend:"+"},{label:"勝利率",value:`${(p.victoryGames/Math.max(p.completedGames,1)*100).toFixed(1)}%`,trend:"="}]}),o=k(()=>{if(!b.value)return[];const p=b.value;return[{label:"チャレンジ成功率",value:`${p.challengeSuccessRate.toFixed(1)}%`,trend:p.recentTrends.performanceImprovement>0?"↗":"↘"},{label:"平均活力",value:p.averageVitality.toFixed(1),trend:"="},{label:"最高活力",value:p.highestVitality.toString(),trend:"+"},{label:"平均ターン数",value:p.averageTurnsPerGame.toFixed(1),trend:"="}]}),n=k(()=>{if(!b.value)return[];const p=b.value;return[{label:"総プレイ時間",value:vt(p.totalPlayTime),trend:"+"},{label:"平均ゲーム時間",value:vt(p.averageGameDuration),trend:p.recentTrends.playTimeIncrease>0?"↗":"↘"},{label:"今日のプレイ",value:Ct(),trend:"="},{label:"連続プレイ記録",value:$t(),trend:"+"}]}),r=k(()=>{if(!b.value)return[];const p=b.value;return[{label:"保険購入回数",value:p.totalInsurancePurchases.toString(),trend:"+"},{label:"平均保険負担",value:p.averageInsuranceBurden.toFixed(1),trend:"="},{label:"保険効果",value:`${p.insuranceEffectiveness.toFixed(1)}%`,trend:p.insuranceEffectiveness>0?"↗":"↘"},{label:"人気保険",value:kt(),trend:"="}]}),i=k(()=>{var p;return((p=b.value)==null?void 0:p.gameHistoryByDate)||[]}),f=k(()=>b.value?b.value.stageSuccessRates:{}),m=k(()=>{var p;return((p=C.value)==null?void 0:p.live.vitalityOverTime)||[]}),T=k(()=>b.value?b.value.stageReachCounts:{}),M=k(()=>b.value?b.value.cardTypeUsage:{}),O=k(()=>{var p;return((p=b.value)==null?void 0:p.decisionPatterns)||[]}),G=k(()=>{var p;return((p=C.value)==null?void 0:p.live.decisionTimes)||[]}),J=()=>ht(null,null,function*(){_.value=!0,S.value="";try{const p=yt();b.value=u.generateStatistics(p),C.value=u.getRealtimeStatistics(),s("dataUpdated",b.value)}catch(p){S.value=`データの読み込みに失敗しました: ${p}`}finally{_.value=!1}}),Q=()=>{J()},ct=()=>{try{const p=u.exportData("json"),h=new Blob([p],{type:"application/json"}),I=URL.createObjectURL(h),F=document.createElement("a");F.href=I,F.download=`game-statistics-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(F),F.click(),document.body.removeChild(F),URL.revokeObjectURL(I)}catch(p){S.value=`エクスポートに失敗しました: ${p}`}},ut=()=>{J()},yt=()=>{const p={};if(g.value.dateRange!=="all"){const h=new Date,I=new Date;switch(g.value.dateRange){case"week":I.setDate(h.getDate()-7);break;case"month":I.setMonth(h.getMonth()-1);break;case"quarter":I.setMonth(h.getMonth()-3);break}p.dateRange={start:I,end:h}}return g.value.gameStatus!=="all"&&(p.gameStatus=[g.value.gameStatus]),g.value.stage!=="all"&&(p.stages=[g.value.stage]),p},vt=p=>{const h=Math.floor(p/1e3),I=Math.floor(h/60),F=Math.floor(I/60);return F>0?`${F}時間${I%60}分`:I>0?`${I}分${h%60}秒`:`${h}秒`},_t=p=>p.toLocaleTimeString("ja-JP"),Ct=()=>{if(!b.value)return"0分";const p=new Date().toISOString().split("T")[0],h=b.value.gameHistoryByDate.find(I=>I.date===p);return h?vt(h.totalPlayTime):"0分"},$t=()=>C.value?`${C.value.currentSession.currentStreak}勝`:"0勝",kt=()=>{if(!b.value)return"-";const p=b.value.insuranceTypeUsage,h=Object.entries(p);return h.length===0?"-":h.reduce((F,gt)=>F[1]>gt[1]?F:gt)[0]},xt=()=>{d.autoRefresh&&!l&&(l=window.setInterval(J,d.refreshInterval))},wt=()=>{l&&(clearInterval(l),l=null)};return E(()=>{J(),xt(),a=u.subscribe(p=>{b.value=p,s("dataUpdated",p)})}),W(()=>{wt(),a&&a()}),L(()=>g.value,()=>{Q()},{deep:!0}),(p,h)=>(w(),x("div",Ga,[t("div",qa,[h[7]||(h[7]=t("h2",{class:"dashboard-title"},[t("span",{class:"icon"},"📊"),Y(" プレイヤー統計ダッシュボード ")],-1)),t("div",Ha,[t("button",{onClick:J,class:"refresh-btn",disabled:_.value},[h[4]||(h[4]=t("span",{class:"icon"},"🔄",-1)),Y(" "+y(_.value?"更新中...":"更新"),1)],8,za),t("button",{onClick:ct,class:"export-btn"},h[5]||(h[5]=[t("span",{class:"icon"},"💾",-1),Y(" エクスポート ",-1)])),t("button",{onClick:h[0]||(h[0]=I=>p.$emit("close")),class:"close-btn"},h[6]||(h[6]=[t("span",{class:"icon"},"✕",-1)]))])]),D.value?(w(),x("div",Na,[t("div",Za,[t("div",Ja,[h[9]||(h[9]=t("label",null,"期間",-1)),K(t("select",{"onUpdate:modelValue":h[1]||(h[1]=I=>g.value.dateRange=I),onChange:Q},h[8]||(h[8]=[t("option",{value:"all"},"全期間",-1),t("option",{value:"week"},"過去1週間",-1),t("option",{value:"month"},"過去1ヶ月",-1),t("option",{value:"quarter"},"過去3ヶ月",-1)]),544),[[tt,g.value.dateRange]])]),t("div",Qa,[h[11]||(h[11]=t("label",null,"ゲームステータス",-1)),K(t("select",{"onUpdate:modelValue":h[2]||(h[2]=I=>g.value.gameStatus=I),onChange:Q},h[10]||(h[10]=[t("option",{value:"all"},"すべて",-1),t("option",{value:"victory"},"勝利",-1),t("option",{value:"game_over"},"ゲームオーバー",-1),t("option",{value:"in_progress"},"進行中",-1)]),544),[[tt,g.value.gameStatus]])]),t("div",Ya,[h[13]||(h[13]=t("label",null,"ステージ",-1)),K(t("select",{"onUpdate:modelValue":h[3]||(h[3]=I=>g.value.stage=I),onChange:Q},h[12]||(h[12]=[t("option",{value:"all"},"すべて",-1),t("option",{value:"youth"},"青年期",-1),t("option",{value:"middle"},"中年期",-1),t("option",{value:"fulfillment"},"充実期",-1)]),544),[[tt,g.value.stage]])])])])):V("",!0),t("div",Xa,[(w(),x(et,null,at(v,I=>t("button",{key:I.key,onClick:F=>R.value=I.key,class:X(["tab-button",{active:R.value===I.key}])},[t("span",ts,y(I.icon),1),Y(" "+y(I.label),1)],10,Ka)),64))]),_.value?V("",!0):(w(),x("div",es,[R.value==="overview"?(w(),x("div",as,[t("div",ss,[P(it,{title:"基本統計",stats:c.value,icon:"🎮"},null,8,["stats"]),P(it,{title:"パフォーマンス",stats:o.value,icon:"⚡"},null,8,["stats"]),P(it,{title:"プレイ時間",stats:n.value,icon:"⏱️"},null,8,["stats"]),P(it,{title:"保険統計",stats:r.value,icon:"🛡️"},null,8,["stats"])]),t("div",rs,[t("div",os,[P(te,{data:i.value},null,8,["data"])]),t("div",ns,[P(le,{data:f.value},null,8,["data"])])])])):V("",!0),R.value==="detailed"?(w(),x("div",ls,[t("div",is,[t("div",ds,[t("div",cs,[P(be,{data:m.value},null,8,["data"])]),t("div",us,[P(we,{data:T.value},null,8,["data"])])]),t("div",vs,[t("div",gs,[P(Ue,{data:M.value},null,8,["data"])])])])])):V("",!0),R.value==="patterns"?(w(),x("div",ps,[t("div",bs,[P(Ke,{data:O.value},null,8,["data"]),P(_a,{data:G.value},null,8,["data"])])])):V("",!0),R.value==="realtime"?(w(),x("div",hs,[C.value?(w(),x("div",fs,[t("div",ms,[h[14]||(h[14]=t("h3",null,"現在のセッション",-1)),t("div",ys,[t("span",null,"開始時刻: "+y(_t(C.value.currentSession.startTime)),1),t("span",null,"プレイ済みゲーム: "+y(C.value.currentSession.gamesPlayed),1),t("span",null,"連続記録: "+y(C.value.currentSession.currentStreak),1)])]),t("div",_s,[P(Ra,{data:C.value.live.vitalityOverTime},null,8,["data"]),P(Wa,{data:C.value.live.decisionTimes},null,8,["data"])])])):(w(),x("div",Cs,h[15]||(h[15]=[t("p",null,"現在アクティブなゲームセッションがありません",-1)])))])):V("",!0)])),_.value?(w(),x("div",$s,h[16]||(h[16]=[t("div",{class:"loading-spinner"},[t("span",{class:"icon"},"⏳"),t("p",null,"統計データを読み込み中...")],-1)]))):V("",!0),S.value?(w(),x("div",ks,[h[17]||(h[17]=t("span",{class:"icon"},"⚠️",-1)),t("p",null,y(S.value),1),t("button",{onClick:ut},"再試行")])):V("",!0)]))}}),ws=j(xs,[["__scopeId","data-v-3ab0c0bd"]]),Is=Object.freeze(Object.defineProperty({__proto__:null,default:ws},Symbol.toStringTag,{value:"Module"}));export{Is as S,j as _};
//# sourceMappingURL=analytics-ImNIcNXw.js.map
